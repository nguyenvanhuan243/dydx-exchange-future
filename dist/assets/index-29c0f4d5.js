import{fI as st,fJ as R,fK as ed,fL as G,fM as td,fN as rd,fO as nd,dG as Nc,fP as Er,fQ as tn,fR as yi,fS as Ln,fT as id,fU as ad,fV as sd,fW as go,fX as od,fY as ud,fZ as cd,f_ as Pc,f$ as ld,g0 as fd,g1 as dd,g2 as hd,g3 as gi,g4 as pd,g5 as yd}from"./index-12ab17f1.js";typeof st<"u"?st.Buffer=st.Buffer||R.Buffer:typeof window<"u"?(window.Buffer=window.Buffer||R.Buffer,window.global=window.global||window):(self.Buffer=self.Buffer||R.Buffer,self.global=self.global||self);var $e;(function(e){e.DEV="DEV",e.SANDBOX="SANDBOX",e.BETA="BETA",e.PROD="PROD",e.DEVELOPMENT="BETA",e.PRODUCTION="PROD"})($e||($e={}));var fu;(function(e){e.GOOGLE="GOOGLE",e.TWITTER="TWITTER",e.APPLE="APPLE",e.DISCORD="DISCORD",e.FACEBOOK="FACEBOOK"})(fu||(fu={}));function gd(e){switch(e){case $e.DEV:return"localhost";case $e.SANDBOX:return"app.sandbox.usecapsule.com";case $e.BETA:return"app.beta.usecapsule.com";case $e.PROD:return"app.usecapsule.com";default:throw new Error(`env: ${e} not supported`)}}function Sr({env:e},t){const n=gd(e);return e===$e.DEV?t?"http://127.0.0.1:3003":`http://${n}:3003`:`https://${n}`}function Lc(e,t){return function(){return e.apply(t,arguments)}}const{toString:vd}=Object.prototype,{getPrototypeOf:vo}=Object,wa=(e=>t=>{const n=vd.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),nr=e=>(e=e.toLowerCase(),t=>wa(t)===e),Ta=e=>t=>typeof t===e,{isArray:Un}=Array,vi=Ta("undefined");function md(e){return e!==null&&!vi(e)&&e.constructor!==null&&!vi(e.constructor)&&Pt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Uc=nr("ArrayBuffer");function bd(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Uc(e.buffer),t}const Sd=Ta("string"),Pt=Ta("function"),Oc=Ta("number"),xa=e=>e!==null&&typeof e=="object",Ed=e=>e===!0||e===!1,Wi=e=>{if(wa(e)!=="object")return!1;const t=vo(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Cd=nr("Date"),wd=nr("File"),Td=nr("Blob"),xd=nr("FileList"),Ad=e=>xa(e)&&Pt(e.pipe),Id=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Pt(e.append)&&((t=wa(e))==="formdata"||t==="object"&&Pt(e.toString)&&e.toString()==="[object FormData]"))},Bd=nr("URLSearchParams"),_d=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xi(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),Un(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const a=n?Object.getOwnPropertyNames(e):Object.keys(e),s=a.length;let o;for(r=0;r<s;r++)o=a[r],t.call(null,e[o],o,e)}}function Dc(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const Kc=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:st)(),Fc=e=>!vi(e)&&e!==Kc;function xs(){const{caseless:e}=Fc(this)&&this||{},t={},n=(r,i)=>{const a=e&&Dc(t,i)||i;Wi(t[a])&&Wi(r)?t[a]=xs(t[a],r):Wi(r)?t[a]=xs({},r):Un(r)?t[a]=r.slice():t[a]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&xi(arguments[r],n);return t}const kd=(e,t,n,{allOwnKeys:r}={})=>(xi(t,(i,a)=>{n&&Pt(i)?e[a]=Lc(i,n):e[a]=i},{allOwnKeys:r}),e),Rd=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Nd=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Pd=(e,t,n,r)=>{let i,a,s;const o={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)s=i[a],(!r||r(s,e,t))&&!o[s]&&(t[s]=e[s],o[s]=!0);e=n!==!1&&vo(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Ld=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},Ud=e=>{if(!e)return null;if(Un(e))return e;let t=e.length;if(!Oc(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Od=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&vo(Uint8Array)),Dd=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const a=i.value;t.call(e,a[0],a[1])}},Kd=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Fd=nr("HTMLFormElement"),Md=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),du=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Vd=nr("RegExp"),Mc=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};xi(n,(i,a)=>{let s;(s=t(i,a,e))!==!1&&(r[a]=s||i)}),Object.defineProperties(e,r)},$d=e=>{Mc(e,(t,n)=>{if(Pt(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Pt(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Hd=(e,t)=>{const n={},r=i=>{i.forEach(a=>{n[a]=!0})};return Un(e)?r(e):r(String(e).split(t)),n},jd=()=>{},qd=(e,t)=>(e=+e,Number.isFinite(e)?e:t),es="abcdefghijklmnopqrstuvwxyz",hu="0123456789",Vc={DIGIT:hu,ALPHA:es,ALPHA_DIGIT:es+es.toUpperCase()+hu},Gd=(e=16,t=Vc.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n};function Wd(e){return!!(e&&Pt(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const zd=e=>{const t=new Array(10),n=(r,i)=>{if(xa(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const a=Un(r)?[]:{};return xi(r,(s,o)=>{const u=n(s,i+1);!vi(u)&&(a[o]=u)}),t[i]=void 0,a}}return r};return n(e,0)},Qd=nr("AsyncFunction"),Yd=e=>e&&(xa(e)||Pt(e))&&Pt(e.then)&&Pt(e.catch),N={isArray:Un,isArrayBuffer:Uc,isBuffer:md,isFormData:Id,isArrayBufferView:bd,isString:Sd,isNumber:Oc,isBoolean:Ed,isObject:xa,isPlainObject:Wi,isUndefined:vi,isDate:Cd,isFile:wd,isBlob:Td,isRegExp:Vd,isFunction:Pt,isStream:Ad,isURLSearchParams:Bd,isTypedArray:Od,isFileList:xd,forEach:xi,merge:xs,extend:kd,trim:_d,stripBOM:Rd,inherits:Nd,toFlatObject:Pd,kindOf:wa,kindOfTest:nr,endsWith:Ld,toArray:Ud,forEachEntry:Dd,matchAll:Kd,isHTMLForm:Fd,hasOwnProperty:du,hasOwnProp:du,reduceDescriptors:Mc,freezeMethods:$d,toObjectSet:Hd,toCamelCase:Md,noop:jd,toFiniteNumber:qd,findKey:Dc,global:Kc,isContextDefined:Fc,ALPHABET:Vc,generateString:Gd,isSpecCompliantForm:Wd,toJSONObject:zd,isAsyncFn:Qd,isThenable:Yd};function he(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}N.inherits(he,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:N.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const $c=he.prototype,Hc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Hc[e]={value:e}});Object.defineProperties(he,Hc);Object.defineProperty($c,"isAxiosError",{value:!0});he.from=(e,t,n,r,i,a)=>{const s=Object.create($c);return N.toFlatObject(e,s,function(u){return u!==Error.prototype},o=>o!=="isAxiosError"),he.call(s,e.message,t,n,r,i),s.cause=e,s.name=e.name,a&&Object.assign(s,a),s};const Xd=null;function As(e){return N.isPlainObject(e)||N.isArray(e)}function jc(e){return N.endsWith(e,"[]")?e.slice(0,-2):e}function pu(e,t,n){return e?e.concat(t).map(function(i,a){return i=jc(i),!n&&a?"["+i+"]":i}).join(n?".":""):t}function Jd(e){return N.isArray(e)&&!e.some(As)}const Zd=N.toFlatObject(N,{},null,function(t){return/^is[A-Z]/.test(t)});function Aa(e,t,n){if(!N.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=N.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,b){return!N.isUndefined(b[m])});const r=n.metaTokens,i=n.visitor||l,a=n.dots,s=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&N.isSpecCompliantForm(t);if(!N.isFunction(i))throw new TypeError("visitor must be a function");function c(h){if(h===null)return"";if(N.isDate(h))return h.toISOString();if(!u&&N.isBlob(h))throw new he("Blob is not supported. Use a Buffer instead.");return N.isArrayBuffer(h)||N.isTypedArray(h)?u&&typeof Blob=="function"?new Blob([h]):R.Buffer.from(h):h}function l(h,m,b){let E=h;if(h&&!b&&typeof h=="object"){if(N.endsWith(m,"{}"))m=r?m:m.slice(0,-2),h=JSON.stringify(h);else if(N.isArray(h)&&Jd(h)||(N.isFileList(h)||N.endsWith(m,"[]"))&&(E=N.toArray(h)))return m=jc(m),E.forEach(function(A,B){!(N.isUndefined(A)||A===null)&&t.append(s===!0?pu([m],B,a):s===null?m:m+"[]",c(A))}),!1}return As(h)?!0:(t.append(pu(b,m,a),c(h)),!1)}const f=[],d=Object.assign(Zd,{defaultVisitor:l,convertValue:c,isVisitable:As});function v(h,m){if(!N.isUndefined(h)){if(f.indexOf(h)!==-1)throw Error("Circular reference detected in "+m.join("."));f.push(h),N.forEach(h,function(E,x){(!(N.isUndefined(E)||E===null)&&i.call(t,E,N.isString(x)?x.trim():x,m,d))===!0&&v(E,m?m.concat(x):[x])}),f.pop()}}if(!N.isObject(e))throw new TypeError("data must be an object");return v(e),t}function yu(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function mo(e,t){this._pairs=[],e&&Aa(e,this,t)}const qc=mo.prototype;qc.append=function(t,n){this._pairs.push([t,n])};qc.toString=function(t){const n=t?function(r){return t.call(this,r,yu)}:yu;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function e0(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gc(e,t,n){if(!t)return e;const r=n&&n.encode||e0,i=n&&n.serialize;let a;if(i?a=i(t,n):a=N.isURLSearchParams(t)?t.toString():new mo(t,n).toString(r),a){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class t0{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){N.forEach(this.handlers,function(r){r!==null&&t(r)})}}const gu=t0,Wc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},r0=typeof URLSearchParams<"u"?URLSearchParams:mo,n0=typeof FormData<"u"?FormData:null,i0=typeof Blob<"u"?Blob:null,a0={isBrowser:!0,classes:{URLSearchParams:r0,FormData:n0,Blob:i0},protocols:["http","https","file","blob","url","data"]},zc=typeof window<"u"&&typeof document<"u",s0=(e=>zc&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),o0=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),u0=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:zc,hasStandardBrowserEnv:s0,hasStandardBrowserWebWorkerEnv:o0},Symbol.toStringTag,{value:"Module"})),Xt={...u0,...a0};function c0(e,t){return Aa(e,new Xt.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,a){return Xt.isNode&&N.isBuffer(n)?(this.append(r,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function l0(e){return N.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function f0(e){const t={},n=Object.keys(e);let r;const i=n.length;let a;for(r=0;r<i;r++)a=n[r],t[a]=e[a];return t}function Qc(e){function t(n,r,i,a){let s=n[a++];if(s==="__proto__")return!0;const o=Number.isFinite(+s),u=a>=n.length;return s=!s&&N.isArray(i)?i.length:s,u?(N.hasOwnProp(i,s)?i[s]=[i[s],r]:i[s]=r,!o):((!i[s]||!N.isObject(i[s]))&&(i[s]=[]),t(n,r,i[s],a)&&N.isArray(i[s])&&(i[s]=f0(i[s])),!o)}if(N.isFormData(e)&&N.isFunction(e.entries)){const n={};return N.forEachEntry(e,(r,i)=>{t(l0(r),i,n,0)}),n}return null}function d0(e,t,n){if(N.isString(e))try{return(t||JSON.parse)(e),N.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const bo={transitional:Wc,adapter:["xhr","http"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,a=N.isObject(t);if(a&&N.isHTMLForm(t)&&(t=new FormData(t)),N.isFormData(t))return i?JSON.stringify(Qc(t)):t;if(N.isArrayBuffer(t)||N.isBuffer(t)||N.isStream(t)||N.isFile(t)||N.isBlob(t))return t;if(N.isArrayBufferView(t))return t.buffer;if(N.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return c0(t,this.formSerializer).toString();if((o=N.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Aa(o?{"files[]":t}:t,u&&new u,this.formSerializer)}}return a||i?(n.setContentType("application/json",!1),d0(t)):t}],transformResponse:[function(t){const n=this.transitional||bo.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(t&&N.isString(t)&&(r&&!this.responseType||i)){const s=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(o){if(s)throw o.name==="SyntaxError"?he.from(o,he.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Xt.classes.FormData,Blob:Xt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};N.forEach(["delete","get","head","post","put","patch"],e=>{bo.headers[e]={}});const So=bo,h0=N.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),p0=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(s){i=s.indexOf(":"),n=s.substring(0,i).trim().toLowerCase(),r=s.substring(i+1).trim(),!(!n||t[n]&&h0[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},vu=Symbol("internals");function zn(e){return e&&String(e).trim().toLowerCase()}function zi(e){return e===!1||e==null?e:N.isArray(e)?e.map(zi):String(e)}function y0(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const g0=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ts(e,t,n,r,i){if(N.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!N.isString(t)){if(N.isString(r))return t.indexOf(r)!==-1;if(N.isRegExp(r))return r.test(t)}}function v0(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function m0(e,t){const n=N.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,a,s){return this[r].call(this,t,i,a,s)},configurable:!0})})}class Ia{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function a(o,u,c){const l=zn(u);if(!l)throw new Error("header name must be a non-empty string");const f=N.findKey(i,l);(!f||i[f]===void 0||c===!0||c===void 0&&i[f]!==!1)&&(i[f||u]=zi(o))}const s=(o,u)=>N.forEach(o,(c,l)=>a(c,l,u));return N.isPlainObject(t)||t instanceof this.constructor?s(t,n):N.isString(t)&&(t=t.trim())&&!g0(t)?s(p0(t),n):t!=null&&a(n,t,r),this}get(t,n){if(t=zn(t),t){const r=N.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return y0(i);if(N.isFunction(n))return n.call(this,i,r);if(N.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=zn(t),t){const r=N.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||ts(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function a(s){if(s=zn(s),s){const o=N.findKey(r,s);o&&(!n||ts(r,r[o],o,n))&&(delete r[o],i=!0)}}return N.isArray(t)?t.forEach(a):a(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const a=n[r];(!t||ts(this,this[a],a,t,!0))&&(delete this[a],i=!0)}return i}normalize(t){const n=this,r={};return N.forEach(this,(i,a)=>{const s=N.findKey(r,a);if(s){n[s]=zi(i),delete n[a];return}const o=t?v0(a):String(a).trim();o!==a&&delete n[a],n[o]=zi(i),r[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return N.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&N.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[vu]=this[vu]={accessors:{}}).accessors,i=this.prototype;function a(s){const o=zn(s);r[o]||(m0(i,s),r[o]=!0)}return N.isArray(t)?t.forEach(a):a(t),this}}Ia.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);N.reduceDescriptors(Ia.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});N.freezeMethods(Ia);const fr=Ia;function rs(e,t){const n=this||So,r=t||n,i=fr.from(r.headers);let a=r.data;return N.forEach(e,function(o){a=o.call(n,a,i.normalize(),t?t.status:void 0)}),i.normalize(),a}function Yc(e){return!!(e&&e.__CANCEL__)}function Ai(e,t,n){he.call(this,e??"canceled",he.ERR_CANCELED,t,n),this.name="CanceledError"}N.inherits(Ai,he,{__CANCEL__:!0});function b0(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new he("Request failed with status code "+n.status,[he.ERR_BAD_REQUEST,he.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const S0=Xt.hasStandardBrowserEnv?{write(e,t,n,r,i,a){const s=[e+"="+encodeURIComponent(t)];N.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),N.isString(r)&&s.push("path="+r),N.isString(i)&&s.push("domain="+i),a===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function E0(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function C0(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Xc(e,t){return e&&!E0(t)?C0(e,t):t}const w0=Xt.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function i(a){let s=a;return t&&(n.setAttribute("href",s),s=n.href),n.setAttribute("href",s),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=i(window.location.href),function(s){const o=N.isString(s)?i(s):s;return o.protocol===r.protocol&&o.host===r.host}}():function(){return function(){return!0}}();function T0(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function x0(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,a=0,s;return t=t!==void 0?t:1e3,function(u){const c=Date.now(),l=r[a];s||(s=c),n[i]=u,r[i]=c;let f=a,d=0;for(;f!==i;)d+=n[f++],f=f%e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),c-s<t)return;const v=l&&c-l;return v?Math.round(d*1e3/v):void 0}}function mu(e,t){let n=0;const r=x0(50,250);return i=>{const a=i.loaded,s=i.lengthComputable?i.total:void 0,o=a-n,u=r(o),c=a<=s;n=a;const l={loaded:a,total:s,progress:s?a/s:void 0,bytes:o,rate:u||void 0,estimated:u&&s&&c?(s-a)/u:void 0,event:i};l[t?"download":"upload"]=!0,e(l)}}const A0=typeof XMLHttpRequest<"u",I0=A0&&function(e){return new Promise(function(n,r){let i=e.data;const a=fr.from(e.headers).normalize();let{responseType:s,withXSRFToken:o}=e,u;function c(){e.cancelToken&&e.cancelToken.unsubscribe(u),e.signal&&e.signal.removeEventListener("abort",u)}let l;if(N.isFormData(i)){if(Xt.hasStandardBrowserEnv||Xt.hasStandardBrowserWebWorkerEnv)a.setContentType(!1);else if((l=a.getContentType())!==!1){const[m,...b]=l?l.split(";").map(E=>E.trim()).filter(Boolean):[];a.setContentType([m||"multipart/form-data",...b].join("; "))}}let f=new XMLHttpRequest;if(e.auth){const m=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";a.set("Authorization","Basic "+btoa(m+":"+b))}const d=Xc(e.baseURL,e.url);f.open(e.method.toUpperCase(),Gc(d,e.params,e.paramsSerializer),!0),f.timeout=e.timeout;function v(){if(!f)return;const m=fr.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),E={data:!s||s==="text"||s==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:m,config:e,request:f};b0(function(A){n(A),c()},function(A){r(A),c()},E),f=null}if("onloadend"in f?f.onloadend=v:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(v)},f.onabort=function(){f&&(r(new he("Request aborted",he.ECONNABORTED,e,f)),f=null)},f.onerror=function(){r(new he("Network Error",he.ERR_NETWORK,e,f)),f=null},f.ontimeout=function(){let b=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const E=e.transitional||Wc;e.timeoutErrorMessage&&(b=e.timeoutErrorMessage),r(new he(b,E.clarifyTimeoutError?he.ETIMEDOUT:he.ECONNABORTED,e,f)),f=null},Xt.hasStandardBrowserEnv&&(o&&N.isFunction(o)&&(o=o(e)),o||o!==!1&&w0(d))){const m=e.xsrfHeaderName&&e.xsrfCookieName&&S0.read(e.xsrfCookieName);m&&a.set(e.xsrfHeaderName,m)}i===void 0&&a.setContentType(null),"setRequestHeader"in f&&N.forEach(a.toJSON(),function(b,E){f.setRequestHeader(E,b)}),N.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),s&&s!=="json"&&(f.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&f.addEventListener("progress",mu(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&f.upload&&f.upload.addEventListener("progress",mu(e.onUploadProgress)),(e.cancelToken||e.signal)&&(u=m=>{f&&(r(!m||m.type?new Ai(null,e,f):m),f.abort(),f=null)},e.cancelToken&&e.cancelToken.subscribe(u),e.signal&&(e.signal.aborted?u():e.signal.addEventListener("abort",u)));const h=T0(d);if(h&&Xt.protocols.indexOf(h)===-1){r(new he("Unsupported protocol "+h+":",he.ERR_BAD_REQUEST,e));return}f.send(i||null)})},Is={http:Xd,xhr:I0};N.forEach(Is,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const bu=e=>`- ${e}`,B0=e=>N.isFunction(e)||e===null||e===!1,Jc={getAdapter:e=>{e=N.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let a=0;a<t;a++){n=e[a];let s;if(r=n,!B0(n)&&(r=Is[(s=String(n)).toLowerCase()],r===void 0))throw new he(`Unknown adapter '${s}'`);if(r)break;i[s||"#"+a]=r}if(!r){const a=Object.entries(i).map(([o,u])=>`adapter ${o} `+(u===!1?"is not supported by the environment":"is not available in the build"));let s=t?a.length>1?`since :
`+a.map(bu).join(`
`):" "+bu(a[0]):"as no adapter specified";throw new he("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return r},adapters:Is};function ns(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ai(null,e)}function Su(e){return ns(e),e.headers=fr.from(e.headers),e.data=rs.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Jc.getAdapter(e.adapter||So.adapter)(e).then(function(r){return ns(e),r.data=rs.call(e,e.transformResponse,r),r.headers=fr.from(r.headers),r},function(r){return Yc(r)||(ns(e),r&&r.response&&(r.response.data=rs.call(e,e.transformResponse,r.response),r.response.headers=fr.from(r.response.headers))),Promise.reject(r)})}const Eu=e=>e instanceof fr?e.toJSON():e;function vn(e,t){t=t||{};const n={};function r(c,l,f){return N.isPlainObject(c)&&N.isPlainObject(l)?N.merge.call({caseless:f},c,l):N.isPlainObject(l)?N.merge({},l):N.isArray(l)?l.slice():l}function i(c,l,f){if(N.isUndefined(l)){if(!N.isUndefined(c))return r(void 0,c,f)}else return r(c,l,f)}function a(c,l){if(!N.isUndefined(l))return r(void 0,l)}function s(c,l){if(N.isUndefined(l)){if(!N.isUndefined(c))return r(void 0,c)}else return r(void 0,l)}function o(c,l,f){if(f in t)return r(c,l);if(f in e)return r(void 0,c)}const u={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:o,headers:(c,l)=>i(Eu(c),Eu(l),!0)};return N.forEach(Object.keys(Object.assign({},e,t)),function(l){const f=u[l]||i,d=f(e[l],t[l],l);N.isUndefined(d)&&f!==o||(n[l]=d)}),n}const Zc="1.6.7",Eo={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Eo[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Cu={};Eo.transitional=function(t,n,r){function i(a,s){return"[Axios v"+Zc+"] Transitional option '"+a+"'"+s+(r?". "+r:"")}return(a,s,o)=>{if(t===!1)throw new he(i(s," has been removed"+(n?" in "+n:"")),he.ERR_DEPRECATED);return n&&!Cu[s]&&(Cu[s]=!0,console.warn(i(s," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,s,o):!0}};function _0(e,t,n){if(typeof e!="object")throw new he("options must be an object",he.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const a=r[i],s=t[a];if(s){const o=e[a],u=o===void 0||s(o,a,e);if(u!==!0)throw new he("option "+a+" must be "+u,he.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new he("Unknown option "+a,he.ERR_BAD_OPTION)}}const Bs={assertOptions:_0,validators:Eo},yr=Bs.validators;class na{constructor(t){this.defaults=t,this.interceptors={request:new gu,response:new gu}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const a=i.stack?i.stack.replace(/^.+\n/,""):"";r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=vn(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:a}=n;r!==void 0&&Bs.assertOptions(r,{silentJSONParsing:yr.transitional(yr.boolean),forcedJSONParsing:yr.transitional(yr.boolean),clarifyTimeoutError:yr.transitional(yr.boolean)},!1),i!=null&&(N.isFunction(i)?n.paramsSerializer={serialize:i}:Bs.assertOptions(i,{encode:yr.function,serialize:yr.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let s=a&&N.merge(a.common,a[n.method]);a&&N.forEach(["delete","get","head","post","put","patch","common"],h=>{delete a[h]}),n.headers=fr.concat(s,a);const o=[];let u=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(u=u&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let l,f=0,d;if(!u){const h=[Su.bind(this),void 0];for(h.unshift.apply(h,o),h.push.apply(h,c),d=h.length,l=Promise.resolve(n);f<d;)l=l.then(h[f++],h[f++]);return l}d=o.length;let v=n;for(f=0;f<d;){const h=o[f++],m=o[f++];try{v=h(v)}catch(b){m.call(this,b);break}}try{l=Su.call(this,v)}catch(h){return Promise.reject(h)}for(f=0,d=c.length;f<d;)l=l.then(c[f++],c[f++]);return l}getUri(t){t=vn(this.defaults,t);const n=Xc(t.baseURL,t.url);return Gc(n,t.params,t.paramsSerializer)}}N.forEach(["delete","get","head","options"],function(t){na.prototype[t]=function(n,r){return this.request(vn(r||{},{method:t,url:n,data:(r||{}).data}))}});N.forEach(["post","put","patch"],function(t){function n(r){return function(a,s,o){return this.request(vn(o||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:s}))}}na.prototype[t]=n(),na.prototype[t+"Form"]=n(!0)});const Qi=na;class Co{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const r=this;this.promise.then(i=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](i);r._listeners=null}),this.promise.then=i=>{let a;const s=new Promise(o=>{r.subscribe(o),a=o}).then(i);return s.cancel=function(){r.unsubscribe(a)},s},t(function(a,s,o){r.reason||(r.reason=new Ai(a,s,o),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new Co(function(i){t=i}),cancel:t}}}const k0=Co;function R0(e){return function(n){return e.apply(null,n)}}function N0(e){return N.isObject(e)&&e.isAxiosError===!0}const _s={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_s).forEach(([e,t])=>{_s[t]=e});const P0=_s;function el(e){const t=new Qi(e),n=Lc(Qi.prototype.request,t);return N.extend(n,Qi.prototype,t,{allOwnKeys:!0}),N.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return el(vn(e,i))},n}const Pe=el(So);Pe.Axios=Qi;Pe.CanceledError=Ai;Pe.CancelToken=k0;Pe.isCancel=Yc;Pe.VERSION=Zc;Pe.toFormData=Aa;Pe.AxiosError=he;Pe.Cancel=Pe.CanceledError;Pe.all=function(t){return Promise.all(t)};Pe.spread=R0;Pe.isAxiosError=N0;Pe.mergeConfig=vn;Pe.AxiosHeaders=fr;Pe.formToJSON=e=>Qc(N.isHTMLForm(e)?new FormData(e):e);Pe.getAdapter=Jc.getAdapter;Pe.HttpStatusCode=P0;Pe.default=Pe;const or=Pe,L0={},U0=Object.freeze(Object.defineProperty({__proto__:null,default:L0},Symbol.toStringTag,{value:"Module"})),O0=ed(U0);var wo=typeof Map=="function"&&Map.prototype,is=Object.getOwnPropertyDescriptor&&wo?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ia=wo&&is&&typeof is.get=="function"?is.get:null,wu=wo&&Map.prototype.forEach,To=typeof Set=="function"&&Set.prototype,as=Object.getOwnPropertyDescriptor&&To?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,aa=To&&as&&typeof as.get=="function"?as.get:null,Tu=To&&Set.prototype.forEach,D0=typeof WeakMap=="function"&&WeakMap.prototype,oi=D0?WeakMap.prototype.has:null,K0=typeof WeakSet=="function"&&WeakSet.prototype,ui=K0?WeakSet.prototype.has:null,F0=typeof WeakRef=="function"&&WeakRef.prototype,xu=F0?WeakRef.prototype.deref:null,M0=Boolean.prototype.valueOf,V0=Object.prototype.toString,$0=Function.prototype.toString,H0=String.prototype.match,xo=String.prototype.slice,Cr=String.prototype.replace,j0=String.prototype.toUpperCase,Au=String.prototype.toLowerCase,tl=RegExp.prototype.test,Iu=Array.prototype.concat,jt=Array.prototype.join,q0=Array.prototype.slice,Bu=Math.floor,ks=typeof BigInt=="function"?BigInt.prototype.valueOf:null,ss=Object.getOwnPropertySymbols,Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,mn=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ot=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===mn||"symbol")?Symbol.toStringTag:null,rl=Object.prototype.propertyIsEnumerable,_u=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function ku(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||tl.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var r=e<0?-Bu(-e):Bu(e);if(r!==e){var i=String(r),a=xo.call(t,i.length+1);return Cr.call(i,n,"$&_")+"."+Cr.call(Cr.call(a,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Cr.call(t,n,"$&_")}var Ns=O0,Ru=Ns.custom,Nu=il(Ru)?Ru:null,G0=function e(t,n,r,i){var a=n||{};if(br(a,"quoteStyle")&&a.quoteStyle!=="single"&&a.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(br(a,"maxStringLength")&&(typeof a.maxStringLength=="number"?a.maxStringLength<0&&a.maxStringLength!==1/0:a.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=br(a,"customInspect")?a.customInspect:!0;if(typeof s!="boolean"&&s!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(br(a,"indent")&&a.indent!==null&&a.indent!=="	"&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(br(a,"numericSeparator")&&typeof a.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=a.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return sl(t,a);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return o?ku(t,u):u}if(typeof t=="bigint"){var c=String(t)+"n";return o?ku(t,c):c}var l=typeof a.depth>"u"?5:a.depth;if(typeof r>"u"&&(r=0),r>=l&&l>0&&typeof t=="object")return Ps(t)?"[Array]":"[Object]";var f=lh(a,r);if(typeof i>"u")i=[];else if(al(i,t)>=0)return"[Circular]";function d(q,Y,z){if(Y&&(i=q0.call(i),i.push(Y)),z){var ie={depth:a.depth};return br(a,"quoteStyle")&&(ie.quoteStyle=a.quoteStyle),e(q,ie,r+1,i)}return e(q,a,r+1,i)}if(typeof t=="function"&&!Pu(t)){var v=th(t),h=Li(t,d);return"[Function"+(v?": "+v:" (anonymous)")+"]"+(h.length>0?" { "+jt.call(h,", ")+" }":"")}if(il(t)){var m=mn?Cr.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Rs.call(t);return typeof t=="object"&&!mn?Qn(m):m}if(oh(t)){for(var b="<"+Au.call(String(t.nodeName)),E=t.attributes||[],x=0;x<E.length;x++)b+=" "+E[x].name+"="+nl(W0(E[x].value),"double",a);return b+=">",t.childNodes&&t.childNodes.length&&(b+="..."),b+="</"+Au.call(String(t.nodeName))+">",b}if(Ps(t)){if(t.length===0)return"[]";var A=Li(t,d);return f&&!ch(A)?"["+Ls(A,f)+"]":"[ "+jt.call(A,", ")+" ]"}if(Q0(t)){var B=Li(t,d);return!("cause"in Error.prototype)&&"cause"in t&&!rl.call(t,"cause")?"{ ["+String(t)+"] "+jt.call(Iu.call("[cause]: "+d(t.cause),B),", ")+" }":B.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+jt.call(B,", ")+" }"}if(typeof t=="object"&&s){if(Nu&&typeof t[Nu]=="function"&&Ns)return Ns(t,{depth:l-r});if(s!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(rh(t)){var _=[];return wu&&wu.call(t,function(q,Y){_.push(d(Y,t,!0)+" => "+d(q,t))}),Lu("Map",ia.call(t),_,f)}if(ah(t)){var L=[];return Tu&&Tu.call(t,function(q){L.push(d(q,t))}),Lu("Set",aa.call(t),L,f)}if(nh(t))return os("WeakMap");if(sh(t))return os("WeakSet");if(ih(t))return os("WeakRef");if(X0(t))return Qn(d(Number(t)));if(Z0(t))return Qn(d(ks.call(t)));if(J0(t))return Qn(M0.call(t));if(Y0(t))return Qn(d(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(t===G)return"{ [object globalThis] }";if(!z0(t)&&!Pu(t)){var W=Li(t,d),te=_u?_u(t)===Object.prototype:t instanceof Object||t.constructor===Object,re=t instanceof Object?"":"null prototype",P=!te&&ot&&Object(t)===t&&ot in t?xo.call(Kr(t),8,-1):re?"Object":"",T=te||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",D=T+(P||re?"["+jt.call(Iu.call([],P||[],re||[]),": ")+"] ":"");return W.length===0?D+"{}":f?D+"{"+Ls(W,f)+"}":D+"{ "+jt.call(W,", ")+" }"}return String(t)};function nl(e,t,n){var r=(n.quoteStyle||t)==="double"?'"':"'";return r+e+r}function W0(e){return Cr.call(String(e),/"/g,"&quot;")}function Ps(e){return Kr(e)==="[object Array]"&&(!ot||!(typeof e=="object"&&ot in e))}function z0(e){return Kr(e)==="[object Date]"&&(!ot||!(typeof e=="object"&&ot in e))}function Pu(e){return Kr(e)==="[object RegExp]"&&(!ot||!(typeof e=="object"&&ot in e))}function Q0(e){return Kr(e)==="[object Error]"&&(!ot||!(typeof e=="object"&&ot in e))}function Y0(e){return Kr(e)==="[object String]"&&(!ot||!(typeof e=="object"&&ot in e))}function X0(e){return Kr(e)==="[object Number]"&&(!ot||!(typeof e=="object"&&ot in e))}function J0(e){return Kr(e)==="[object Boolean]"&&(!ot||!(typeof e=="object"&&ot in e))}function il(e){if(mn)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!Rs)return!1;try{return Rs.call(e),!0}catch{}return!1}function Z0(e){if(!e||typeof e!="object"||!ks)return!1;try{return ks.call(e),!0}catch{}return!1}var eh=Object.prototype.hasOwnProperty||function(e){return e in this};function br(e,t){return eh.call(e,t)}function Kr(e){return V0.call(e)}function th(e){if(e.name)return e.name;var t=H0.call($0.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function al(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function rh(e){if(!ia||!e||typeof e!="object")return!1;try{ia.call(e);try{aa.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function nh(e){if(!oi||!e||typeof e!="object")return!1;try{oi.call(e,oi);try{ui.call(e,ui)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function ih(e){if(!xu||!e||typeof e!="object")return!1;try{return xu.call(e),!0}catch{}return!1}function ah(e){if(!aa||!e||typeof e!="object")return!1;try{aa.call(e);try{ia.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function sh(e){if(!ui||!e||typeof e!="object")return!1;try{ui.call(e,ui);try{oi.call(e,oi)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function oh(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function sl(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return sl(xo.call(e,0,t.maxStringLength),t)+r}var i=Cr.call(Cr.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,uh);return nl(i,"single",t)}function uh(e){var t=e.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return n?"\\"+n:"\\x"+(t<16?"0":"")+j0.call(t.toString(16))}function Qn(e){return"Object("+e+")"}function os(e){return e+" { ? }"}function Lu(e,t,n,r){var i=r?Ls(n,r):jt.call(n,", ");return e+" ("+t+") {"+i+"}"}function ch(e){for(var t=0;t<e.length;t++)if(al(e[t],`
`)>=0)return!1;return!0}function lh(e,t){var n;if(e.indent==="	")n="	";else if(typeof e.indent=="number"&&e.indent>0)n=jt.call(Array(e.indent+1)," ");else return null;return{base:n,prev:jt.call(Array(t+1),n)}}function Ls(e,t){if(e.length===0)return"";var n=`
`+t.prev+t.base;return n+jt.call(e,","+n)+`
`+t.prev}function Li(e,t){var n=Ps(e),r=[];if(n){r.length=e.length;for(var i=0;i<e.length;i++)r[i]=br(e,i)?t(e[i],e):""}var a=typeof ss=="function"?ss(e):[],s;if(mn){s={};for(var o=0;o<a.length;o++)s["$"+a[o]]=a[o]}for(var u in e)br(e,u)&&(n&&String(Number(u))===u&&u<e.length||mn&&s["$"+u]instanceof Symbol||(tl.call(/[^\w$]/,u)?r.push(t(u,e)+": "+t(e[u],e)):r.push(u+": "+t(e[u],e))));if(typeof ss=="function")for(var c=0;c<a.length;c++)rl.call(e,a[c])&&r.push("["+t(a[c])+"]: "+t(e[a[c]],e));return r}var ol=td,On=rd,fh=G0,dh=nd,Ui=ol("%WeakMap%",!0),Oi=ol("%Map%",!0),hh=On("WeakMap.prototype.get",!0),ph=On("WeakMap.prototype.set",!0),yh=On("WeakMap.prototype.has",!0),gh=On("Map.prototype.get",!0),vh=On("Map.prototype.set",!0),mh=On("Map.prototype.has",!0),Ao=function(e,t){for(var n=e,r;(r=n.next)!==null;n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r},bh=function(e,t){var n=Ao(e,t);return n&&n.value},Sh=function(e,t,n){var r=Ao(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}},Eh=function(e,t){return!!Ao(e,t)},Ch=function(){var t,n,r,i={assert:function(a){if(!i.has(a))throw new dh("Side channel does not contain "+fh(a))},get:function(a){if(Ui&&a&&(typeof a=="object"||typeof a=="function")){if(t)return hh(t,a)}else if(Oi){if(n)return gh(n,a)}else if(r)return bh(r,a)},has:function(a){if(Ui&&a&&(typeof a=="object"||typeof a=="function")){if(t)return yh(t,a)}else if(Oi){if(n)return mh(n,a)}else if(r)return Eh(r,a);return!1},set:function(a,s){Ui&&a&&(typeof a=="object"||typeof a=="function")?(t||(t=new Ui),ph(t,a,s)):Oi?(n||(n=new Oi),vh(n,a,s)):(r||(r={key:{},next:null}),Sh(r,a,s))}};return i},wh=String.prototype.replace,Th=/%20/g,us={RFC1738:"RFC1738",RFC3986:"RFC3986"},Io={default:us.RFC3986,formatters:{RFC1738:function(e){return wh.call(e,Th,"+")},RFC3986:function(e){return String(e)}},RFC1738:us.RFC1738,RFC3986:us.RFC3986},xh=Io,cs=Object.prototype.hasOwnProperty,qr=Array.isArray,Mt=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),Ah=function(t){for(;t.length>1;){var n=t.pop(),r=n.obj[n.prop];if(qr(r)){for(var i=[],a=0;a<r.length;++a)typeof r[a]<"u"&&i.push(r[a]);n.obj[n.prop]=i}}},ul=function(t,n){for(var r=n&&n.plainObjects?Object.create(null):{},i=0;i<t.length;++i)typeof t[i]<"u"&&(r[i]=t[i]);return r},Ih=function e(t,n,r){if(!n)return t;if(typeof n!="object"){if(qr(t))t.push(n);else if(t&&typeof t=="object")(r&&(r.plainObjects||r.allowPrototypes)||!cs.call(Object.prototype,n))&&(t[n]=!0);else return[t,n];return t}if(!t||typeof t!="object")return[t].concat(n);var i=t;return qr(t)&&!qr(n)&&(i=ul(t,r)),qr(t)&&qr(n)?(n.forEach(function(a,s){if(cs.call(t,s)){var o=t[s];o&&typeof o=="object"&&a&&typeof a=="object"?t[s]=e(o,a,r):t.push(a)}else t[s]=a}),t):Object.keys(n).reduce(function(a,s){var o=n[s];return cs.call(a,s)?a[s]=e(a[s],o,r):a[s]=o,a},i)},Bh=function(t,n){return Object.keys(n).reduce(function(r,i){return r[i]=n[i],r},t)},_h=function(e,t,n){var r=e.replace(/\+/g," ");if(n==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},ls=1024,kh=function(t,n,r,i,a){if(t.length===0)return t;var s=t;if(typeof t=="symbol"?s=Symbol.prototype.toString.call(t):typeof t!="string"&&(s=String(t)),r==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(v){return"%26%23"+parseInt(v.slice(2),16)+"%3B"});for(var o="",u=0;u<s.length;u+=ls){for(var c=s.length>=ls?s.slice(u,u+ls):s,l=[],f=0;f<c.length;++f){var d=c.charCodeAt(f);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||a===xh.RFC1738&&(d===40||d===41)){l[l.length]=c.charAt(f);continue}if(d<128){l[l.length]=Mt[d];continue}if(d<2048){l[l.length]=Mt[192|d>>6]+Mt[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=Mt[224|d>>12]+Mt[128|d>>6&63]+Mt[128|d&63];continue}f+=1,d=65536+((d&1023)<<10|c.charCodeAt(f)&1023),l[l.length]=Mt[240|d>>18]+Mt[128|d>>12&63]+Mt[128|d>>6&63]+Mt[128|d&63]}o+=l.join("")}return o},Rh=function(t){for(var n=[{obj:{o:t},prop:"o"}],r=[],i=0;i<n.length;++i)for(var a=n[i],s=a.obj[a.prop],o=Object.keys(s),u=0;u<o.length;++u){var c=o[u],l=s[c];typeof l=="object"&&l!==null&&r.indexOf(l)===-1&&(n.push({obj:s,prop:c}),r.push(l))}return Ah(n),t},Nh=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},Ph=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},Lh=function(t,n){return[].concat(t,n)},Uh=function(t,n){if(qr(t)){for(var r=[],i=0;i<t.length;i+=1)r.push(n(t[i]));return r}return n(t)},cl={arrayToObject:ul,assign:Bh,combine:Lh,compact:Rh,decode:_h,encode:kh,isBuffer:Ph,isRegExp:Nh,maybeMap:Uh,merge:Ih},ll=Ch,Yi=cl,ci=Io,Oh=Object.prototype.hasOwnProperty,fl={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,n){return t+"["+n+"]"},repeat:function(t){return t}},$t=Array.isArray,Dh=Array.prototype.push,dl=function(e,t){Dh.apply(e,$t(t)?t:[t])},Kh=Date.prototype.toISOString,Uu=ci.default,Ue={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Yi.encode,encodeValuesOnly:!1,format:Uu,formatter:ci.formatters[Uu],indices:!1,serializeDate:function(t){return Kh.call(t)},skipNulls:!1,strictNullHandling:!1},Fh=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},ds={},Mh=function e(t,n,r,i,a,s,o,u,c,l,f,d,v,h,m,b,E,x){for(var A=t,B=x,_=0,L=!1;(B=B.get(ds))!==void 0&&!L;){var W=B.get(t);if(_+=1,typeof W<"u"){if(W===_)throw new RangeError("Cyclic object value");L=!0}typeof B.get(ds)>"u"&&(_=0)}if(typeof l=="function"?A=l(n,A):A instanceof Date?A=v(A):r==="comma"&&$t(A)&&(A=Yi.maybeMap(A,function(Ae){return Ae instanceof Date?v(Ae):Ae})),A===null){if(s)return c&&!b?c(n,Ue.encoder,E,"key",h):n;A=""}if(Fh(A)||Yi.isBuffer(A)){if(c){var te=b?n:c(n,Ue.encoder,E,"key",h);return[m(te)+"="+m(c(A,Ue.encoder,E,"value",h))]}return[m(n)+"="+m(String(A))]}var re=[];if(typeof A>"u")return re;var P;if(r==="comma"&&$t(A))b&&c&&(A=Yi.maybeMap(A,c)),P=[{value:A.length>0?A.join(",")||null:void 0}];else if($t(l))P=l;else{var T=Object.keys(A);P=f?T.sort(f):T}var D=u?n.replace(/\./g,"%2E"):n,q=i&&$t(A)&&A.length===1?D+"[]":D;if(a&&$t(A)&&A.length===0)return q+"[]";for(var Y=0;Y<P.length;++Y){var z=P[Y],ie=typeof z=="object"&&typeof z.value<"u"?z.value:A[z];if(!(o&&ie===null)){var V=d&&u?z.replace(/\./g,"%2E"):z,je=$t(A)?typeof r=="function"?r(q,V):q:q+(d?"."+V:"["+V+"]");x.set(t,_);var Ut=ll();Ut.set(ds,x),dl(re,e(ie,je,r,i,a,s,o,u,r==="comma"&&b&&$t(A)?null:c,l,f,d,v,h,m,b,E,Ut))}}return re},Vh=function(t){if(!t)return Ue;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=t.charset||Ue.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=ci.default;if(typeof t.format<"u"){if(!Oh.call(ci.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var i=ci.formatters[r],a=Ue.filter;(typeof t.filter=="function"||$t(t.filter))&&(a=t.filter);var s;if(t.arrayFormat in fl?s=t.arrayFormat:"indices"in t?s=t.indices?"indices":"repeat":s=Ue.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var o=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:Ue.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Ue.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Ue.allowEmptyArrays,arrayFormat:s,charset:n,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Ue.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Ue.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Ue.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Ue.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Ue.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Ue.encodeValuesOnly,filter:a,format:r,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Ue.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Ue.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Ue.strictNullHandling}},$h=function(e,t){var n=e,r=Vh(t),i,a;typeof r.filter=="function"?(a=r.filter,n=a("",n)):$t(r.filter)&&(a=r.filter,i=a);var s=[];if(typeof n!="object"||n===null)return"";var o=fl[r.arrayFormat],u=o==="comma"&&r.commaRoundTrip;i||(i=Object.keys(n)),r.sort&&i.sort(r.sort);for(var c=ll(),l=0;l<i.length;++l){var f=i[l];r.skipNulls&&n[f]===null||dl(s,Mh(n[f],f,o,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}var d=s.join(r.delimiter),v=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?v+="utf8=%26%2310003%3B&":v+="utf8=%E2%9C%93&"),d.length>0?v+d:""},bn=cl,Us=Object.prototype.hasOwnProperty,Hh=Array.isArray,ke={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:bn.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},jh=function(e){return e.replace(/&#(\d+);/g,function(t,n){return String.fromCharCode(parseInt(n,10))})},hl=function(e,t){return e&&typeof e=="string"&&t.comma&&e.indexOf(",")>-1?e.split(","):e},qh="utf8=%26%2310003%3B",Gh="utf8=%E2%9C%93",Wh=function(t,n){var r={__proto__:null},i=n.ignoreQueryPrefix?t.replace(/^\?/,""):t;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var a=n.parameterLimit===1/0?void 0:n.parameterLimit,s=i.split(n.delimiter,a),o=-1,u,c=n.charset;if(n.charsetSentinel)for(u=0;u<s.length;++u)s[u].indexOf("utf8=")===0&&(s[u]===Gh?c="utf-8":s[u]===qh&&(c="iso-8859-1"),o=u,u=s.length);for(u=0;u<s.length;++u)if(u!==o){var l=s[u],f=l.indexOf("]="),d=f===-1?l.indexOf("="):f+1,v,h;d===-1?(v=n.decoder(l,ke.decoder,c,"key"),h=n.strictNullHandling?null:""):(v=n.decoder(l.slice(0,d),ke.decoder,c,"key"),h=bn.maybeMap(hl(l.slice(d+1),n),function(b){return n.decoder(b,ke.decoder,c,"value")})),h&&n.interpretNumericEntities&&c==="iso-8859-1"&&(h=jh(h)),l.indexOf("[]=")>-1&&(h=Hh(h)?[h]:h);var m=Us.call(r,v);m&&n.duplicates==="combine"?r[v]=bn.combine(r[v],h):(!m||n.duplicates==="last")&&(r[v]=h)}return r},zh=function(e,t,n,r){for(var i=r?t:hl(t,n),a=e.length-1;a>=0;--a){var s,o=e[a];if(o==="[]"&&n.parseArrays)s=n.allowEmptyArrays&&(i===""||n.strictNullHandling&&i===null)?[]:[].concat(i);else{s=n.plainObjects?Object.create(null):{};var u=o.charAt(0)==="["&&o.charAt(o.length-1)==="]"?o.slice(1,-1):o,c=n.decodeDotInKeys?u.replace(/%2E/g,"."):u,l=parseInt(c,10);!n.parseArrays&&c===""?s={0:i}:!isNaN(l)&&o!==c&&String(l)===c&&l>=0&&n.parseArrays&&l<=n.arrayLimit?(s=[],s[l]=i):c!=="__proto__"&&(s[c]=i)}i=s}return i},Qh=function(t,n,r,i){if(t){var a=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,s=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,u=r.depth>0&&s.exec(a),c=u?a.slice(0,u.index):a,l=[];if(c){if(!r.plainObjects&&Us.call(Object.prototype,c)&&!r.allowPrototypes)return;l.push(c)}for(var f=0;r.depth>0&&(u=o.exec(a))!==null&&f<r.depth;){if(f+=1,!r.plainObjects&&Us.call(Object.prototype,u[1].slice(1,-1))&&!r.allowPrototypes)return;l.push(u[1])}return u&&l.push("["+a.slice(u.index)+"]"),zh(l,n,r,i)}},Yh=function(t){if(!t)return ke;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=typeof t.charset>"u"?ke.charset:t.charset,r=typeof t.duplicates>"u"?ke.duplicates:t.duplicates;if(r!=="combine"&&r!=="first"&&r!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:ke.allowDots:!!t.allowDots;return{allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:ke.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:ke.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:ke.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:ke.arrayLimit,charset:n,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:ke.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:ke.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:ke.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:ke.decoder,delimiter:typeof t.delimiter=="string"||bn.isRegExp(t.delimiter)?t.delimiter:ke.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:ke.depth,duplicates:r,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:ke.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:ke.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:ke.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:ke.strictNullHandling}},Xh=function(e,t){var n=Yh(t);if(e===""||e===null||typeof e>"u")return n.plainObjects?Object.create(null):{};for(var r=typeof e=="string"?Wh(e,n):e,i=n.plainObjects?Object.create(null):{},a=Object.keys(r),s=0;s<a.length;++s){var o=a[s],u=Qh(o,r[o],n,typeof e=="string");i=bn.merge(i,u,n)}return n.allowSparse===!0?i:bn.compact(i)},Jh=$h,Zh=Xh,ep=Io,tp={formats:ep,parse:Zh,stringify:Jh};const rp=Nc(tp);var Q=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})},Ou=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},Du;(function(e){e.LIGHT="light",e.DARK="dark"})(Du||(Du={}));var Os;(function(e){e.PENDING="PENDING",e.COMPLETE="COMPLETE"})(Os||(Os={}));var Ds;(function(e){e.MOBILE="MOBILE",e.WEB="WEB"})(Ds||(Ds={}));var sa;(function(e){e.DKLS="DKLS",e.CGGMP="CGGMP"})(sa||(sa={}));var Ku;(function(e){e.ETH="ETH",e.CELO="CELO",e.MATIC="MATIC"})(Ku||(Ku={}));var oa;(function(e){e.USER="USER",e.RECOVERY="RECOVERY",e.BIOMETRICS="BIOMETRICS"})(oa||(oa={}));const pl={USER:"USER",RECOVERY:"RECOVERY"},hs="x-capsule-sid";class np{constructor({userManagementHost:t,apiKey:n,opts:r,retrieveSessionCookie:i,persistSessionCookie:a}){this.createUser=u=>Q(this,void 0,void 0,function*(){return(yield this.baseRequest.post("/users",u)).data}),this.checkUserExists=u=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/exists?email=${encodeURIComponent(u)}`)}),this.verifyEmail=(u,c)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${u}/verify-email`,c)}),this.addSessionPublicKey=(u,c)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${u}/biometrics/key`,c)}),this.getSessionPublicKeys=u=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${u}/biometrics/keys`)}),this.getSessionPublicKey=(u,c)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${u}/biometrics/${c}`)}),this.patchSessionPublicKey=(u,c,l,f)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.patch(`/users/${c}/biometrics/${l}`,f,{headers:{"X-Partner-ID":u}})}),this.getWebChallenge=(u,c)=>Q(this,void 0,void 0,function*(){const l={};u&&(l.email=u),c&&(l.publicKey=c);const f=rp.stringify(l);return(yield this.baseRequest.get(`/biometrics/challenge${f===""?"":`?${f}`}`)).data}),this.touchSession=u=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/touch?regenerate=${!!u}`)}),this.verifyWebChallenge=(u,c)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.post("/biometrics/verify",c,{headers:{"X-Partner-ID":u}})}),this.getSessionChallenge=u=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${u}/biometrics/challenge`)}),this.verifySessionChallenge=(u,c)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${u}/biometrics/verify`,c)}),this.createWallet=(u,c)=>Q(this,void 0,void 0,function*(){return(yield this.baseRequest.post(`/users/${u}/wallets`,c)).data}),this.createPregenWallet=u=>Q(this,void 0,void 0,function*(){return(yield this.baseRequest.post("/wallets/pregen",u)).data}),this.getPregenWallets=u=>Q(this,void 0,void 0,function*(){return(yield this.baseRequest.get(`/wallets/pregen?email=${encodeURIComponent(u)}`)).data}),this.claimPregenWallet=u=>Q(this,void 0,void 0,function*(){yield this.baseRequest.post("/wallets/pregen/claim",u)}),this.sendTransaction=(u,c,l)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${u}/wallets/${c}/transactions/send`,l)}),this.signTransaction=(u,c,l)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${u}/wallets/${c}/transactions/sign`,l)}),this.refreshKeys=(u,c)=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${u}/wallets/${c}/refresh`)}),this.updatePregenWallet=(u,c)=>Q(this,void 0,void 0,function*(){return(yield this.baseRequest.patch(`wallets/pregen/${u}`,c)).data}),this.getWallets=u=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${u}/wallets`)}),this.login=u=>Q(this,void 0,void 0,function*(){const c=u;return yield this.baseRequest.post("/login",c)}),this.verifyLogin=u=>Q(this,void 0,void 0,function*(){const c={verificationCode:u};return yield this.baseRequest.post("/login/verify-email",c)}),this.logout=()=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.get("/logout")}),this.recoveryVerification=(u,c)=>Q(this,void 0,void 0,function*(){const l={email:u,verificationCode:c};return yield this.baseRequest.post("/recovery/verification",l)}),this.recoveryInit=u=>Q(this,void 0,void 0,function*(){const c={email:u};return yield this.baseRequest.post("/recovery",c)}),this.preSignMessage=(u,c,l)=>Q(this,void 0,void 0,function*(){const f={message:l};return(yield this.baseRequest.post(`/users/${u}/wallets/${c}/messages/sign`,f)).data}),this.deleteSelf=u=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.delete(`/users/${u}`)}),this.getCapsuleShare=(u,c)=>Q(this,void 0,void 0,function*(){return(yield this.baseRequest.get(`/users/${u}/wallets/${c}/capsule-share`)).data.share}),this.getBackupKit=u=>Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/download-backup-kit/${u}`,{responseType:"blob"})});const o={baseURL:t,withCredentials:!0,headers:n?{"X-External-API-Key":n}:void 0};if(i){const u=Array.isArray(or.defaults.transformRequest)?or.defaults.transformRequest:[or.defaults.transformRequest];o.transformRequest=[function(c,l){const f=i();return f&&(l[hs]=f),c},...u]}if(a){const u=Array.isArray(or.defaults.transformResponse)?or.defaults.transformResponse:[or.defaults.transformResponse];o.transformResponse=[...u,function(c,l,f){return l!=null&&l[hs]&&a(l[hs]),c}]}this.baseRequest=or.create(o),r!=null&&r.useFetchAdapter&&(or.defaults.adapter=function(u){return fetch(u.baseURL+u.url.substring(1),{method:u.method,headers:u.headers,body:u.data,credentials:u.withCredentials?"include":void 0}).then(c=>c.text().then(l=>({data:l,status:c.status,statusText:c.statusText,headers:c.headers,config:u,request:fetch}))).catch(function(c){throw c})})}uploadKeyshares(t,n,r){return Q(this,void 0,void 0,function*(){const i={keyShares:r};return yield this.baseRequest.post(`/users/${t}/wallets/${n}/key-shares`,i)})}uploadUserKeyShares(t,n){return Q(this,void 0,void 0,function*(){const r={keyShares:n};return yield this.baseRequest.post(`/users/${t}/key-shares`,r)})}getKeyshare(t,n,r,i){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${t}/wallets/${n}/key-shares?type=${r}${i?`&encryptor=${i}`:""}`)})}getBiometricKeyshares(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${t}/biometrics/key-shares?publicKey=${n}`)})}uploadTransmissionKeyshares(t,n){return Q(this,void 0,void 0,function*(){const r={shares:n};return yield this.baseRequest.post(`/users/${t}/temporary-shares`,r)})}getTransmissionKeyshares(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${t}/temporary-shares?sessionLookupId=${n}`)})}resendVerificationCode(t){var{userId:n}=t,r=Ou(t,["userId"]);return Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${n}/resend-verification-code`,r)})}cancelRecoveryAttempt(t){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.post("recovery/cancel",{email:t})})}check2FAStatus(t){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/2fa/users/${t}/check-status`)})}enable2FA(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/2fa/users/${t}/enable`,{verificationCode:n})})}setup2FA(t){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/2fa/users/${t}/setup`)})}initializeRecovery(t){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.post("/recovery/init",{email:t})})}finalizeRecovery(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/recovery/users/${t}/wallets/${n}/finish`)})}recoverUserShare(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/recovery/users/${t}/wallets/${n}/key-shares?type=USER&encryptor=RECOVERY`)})}verifyEmailForRecovery(t,n){return Q(this,void 0,void 0,function*(){const r={email:t,verificationCode:n};return yield this.baseRequest.post("/recovery/verify-email",r)})}verify2FA(t,n){return Q(this,void 0,void 0,function*(){const r={email:t,verificationCode:n};return yield this.baseRequest.post("/2fa/verify",r)})}tempTrasmissionInit(t,n){return Q(this,void 0,void 0,function*(){const r={message:t,userId:n};return yield this.baseRequest.post("/temporary-transmissions",r)})}tempTrasmission(t){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/temporary-transmissions/${t}`)})}getPartner(t){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/partners/${t}`)})}acceptScopes(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${t}/scopes/accept`,n)})}getPendingTransaction(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${t}/pending-transactions/${n}`)})}acceptPendingTransaction(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.post(`/users/${t}/pending-transactions/${n}/accept`)})}getPolicyPermissions(t,n){return Q(this,void 0,void 0,function*(){return yield this.baseRequest.get(`/users/${t}/policies/${n}/permissions`)})}distributeCapsuleShare(t){var{userId:n,walletId:r}=t,i=Ou(t,["userId","walletId"]);return Q(this,void 0,void 0,function*(){const a=i;return yield this.baseRequest.post(`/users/${n}/wallets/${r}/capsule-share/distribute`,a)})}keepSessionAlive(t){return Q(this,void 0,void 0,function*(){return(yield this.baseRequest.post(`/users/${t}/session/keep-alive`)).data})}}var ip={exports:{}},Bo={},_o={};Object.defineProperty(_o,"__esModule",{value:!0});function ap(e){var t=4,n=e.length,r=n%t;if(!r)return e;var i=n,a=t-r,s=n+a,o=R.Buffer.alloc(s);for(o.write(e);a--;)o.write("=",i++);return o.toString()}_o.default=ap;Object.defineProperty(Bo,"__esModule",{value:!0});var sp=_o;function yl(e,t){return t===void 0&&(t="utf8"),R.Buffer.isBuffer(e)?Ks(e.toString("base64")):Ks(R.Buffer.from(e,t).toString("base64"))}function op(e,t){return t===void 0&&(t="utf8"),R.Buffer.from(ko(e),"base64").toString(t)}function ko(e){return e=e.toString(),sp.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function Ks(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function up(e){return R.Buffer.from(ko(e),"base64")}var Dn=yl;Dn.encode=yl;Dn.decode=op;Dn.toBase64=ko;Dn.fromBase64=Ks;Dn.toBuffer=up;Bo.default=Dn;(function(e){e.exports=Bo.default,e.exports.default=e.exports})(ip);var se={options:{usePureJavaScript:!1}},Ro={},cp=Ro,Fu={};Ro.encode=function(e,t,n){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(n!==void 0&&typeof n!="number")throw new TypeError('"maxline" must be a number.');var r="";if(!(e instanceof Uint8Array))r=lp(e,t);else{var i=0,a=t.length,s=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var u=0,c=e[i];u<o.length;++u)c+=o[u]<<8,o[u]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;e[i]===0&&i<e.length-1;++i)r+=s;for(i=o.length-1;i>=0;--i)r+=t[o[i]]}if(n){var l=new RegExp(".{1,"+n+"}","g");r=r.match(l).join(`\r
`)}return r};Ro.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var n=Fu[t];if(!n){n=Fu[t]=[];for(var r=0;r<t.length;++r)n[t.charCodeAt(r)]=r}e=e.replace(/\s/g,"");for(var i=t.length,a=t.charAt(0),s=[0],r=0;r<e.length;r++){var o=n[e.charCodeAt(r)];if(o===void 0)return;for(var u=0,c=o;u<s.length;++u)c+=s[u]*i,s[u]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var l=0;e[l]===a&&l<e.length-1;++l)s.push(0);return typeof R.Buffer<"u"?R.Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function lp(e,t){var n=0,r=t.length,i=t.charAt(0),a=[0];for(n=0;n<e.length();++n){for(var s=0,o=e.at(n);s<a.length;++s)o+=a[s]<<8,a[s]=o%r,o=o/r|0;for(;o>0;)a.push(o%r),o=o/r|0}var u="";for(n=0;e.at(n)===0&&n<e.length()-1;++n)u+=i;for(n=a.length-1;n>=0;--n)u+=t[a[n]];return u}var Mu=se,Vu=cp,w=Mu.util=Mu.util||{};(function(){if(typeof Er<"u"&&Er.nextTick&&!Er.browser){w.nextTick=Er.nextTick,typeof setImmediate=="function"?w.setImmediate=setImmediate:w.setImmediate=w.nextTick;return}if(typeof setImmediate=="function"){w.setImmediate=function(){return setImmediate.apply(void 0,arguments)},w.nextTick=function(s){return setImmediate(s)};return}if(w.setImmediate=function(s){setTimeout(s,0)},typeof window<"u"&&typeof window.postMessage=="function"){let s=function(o){if(o.source===window&&o.data===e){o.stopPropagation();var u=t.slice();t.length=0,u.forEach(function(c){c()})}};var e="forge.setImmediate",t=[];w.setImmediate=function(o){t.push(o),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",s,!0)}if(typeof MutationObserver<"u"){var n=Date.now(),r=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var o=t.slice();t.length=0,o.forEach(function(u){u()})}).observe(i,{attributes:!0});var a=w.setImmediate;w.setImmediate=function(o){Date.now()-n>15?(n=Date.now(),a(o)):(t.push(o),t.length===1&&i.setAttribute("a",r=!r))}}w.nextTick=w.setImmediate})();w.isNodejs=typeof Er<"u"&&Er.versions&&Er.versions.node;w.globalScope=function(){return w.isNodejs?G:typeof self>"u"?window:self}();w.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};w.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};w.isArrayBufferView=function(e){return e&&w.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Ii(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}w.ByteBuffer=No;function No(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(w.isArrayBuffer(e)||w.isArrayBufferView(e))if(typeof R.Buffer<"u"&&e instanceof R.Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var n=0;n<t.length;++n)this.putByte(t[n])}}else(e instanceof No||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}w.ByteStringBuffer=No;var fp=4096;w.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>fp&&(this.data.substr(0,1),this._constructedStringLength=0)};w.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};w.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};w.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};w.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var n=this.data;t>0;)t&1&&(n+=e),t>>>=1,t>0&&(e+=e);return this.data=n,this._optimizeConstructedString(t),this};w.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};w.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(w.encodeUtf8(e))};w.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};w.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};w.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};w.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};w.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};w.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};w.ByteStringBuffer.prototype.putInt=function(e,t){Ii(t);var n="";do t-=8,n+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(n)};w.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};w.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};w.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};w.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};w.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};w.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};w.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};w.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};w.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};w.ByteStringBuffer.prototype.getInt=function(e){Ii(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};w.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t};w.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};w.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};w.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};w.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};w.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};w.ByteStringBuffer.prototype.copy=function(){var e=w.createBuffer(this.data);return e.read=this.read,e};w.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};w.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};w.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};w.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);n<16&&(e+="0"),e+=n.toString(16)}return e};w.ByteStringBuffer.prototype.toString=function(){return w.decodeUtf8(this.bytes())};function dp(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var n=w.isArrayBuffer(e),r=w.isArrayBufferView(e);if(n||r){n?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}w.DataBuffer=dp;w.DataBuffer.prototype.length=function(){return this.write-this.read};w.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};w.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var n=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(n),this.data=new DataView(r.buffer),this};w.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};w.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var n=0;n<t;++n)this.data.setUint8(e);return this};w.DataBuffer.prototype.putBytes=function(e,t){if(w.isArrayBufferView(e)){var n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=n.byteLength-n.byteOffset;this.accommodate(r);var i=new Uint8Array(this.data.buffer,this.write);return i.set(n),this.write+=r,this}if(w.isArrayBuffer(e)){var n=new Uint8Array(e);this.accommodate(n.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(n,this.write),this.write+=n.byteLength,this}if(e instanceof w.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&w.isArrayBufferView(e.data)){var n=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(n.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(n),this.write+=n.byteLength,this}if(e instanceof w.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var a;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=w.binary.hex.decode(e,a,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=w.binary.base64.decode(e,a,this.write),this;if(t==="utf8"&&(e=w.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=w.binary.raw.decode(a),this;if(t==="utf16")return this.accommodate(e.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=w.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};w.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};w.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};w.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};w.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};w.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};w.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};w.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};w.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};w.DataBuffer.prototype.putInt=function(e,t){Ii(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};w.DataBuffer.prototype.putSignedInt=function(e,t){return Ii(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};w.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};w.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};w.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};w.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};w.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};w.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};w.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};w.DataBuffer.prototype.getInt=function(e){Ii(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};w.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t};w.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};w.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};w.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};w.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};w.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};w.DataBuffer.prototype.copy=function(){return new w.DataBuffer(this)};w.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};w.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};w.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};w.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var n=this.data.getUint8(t);n<16&&(e+="0"),e+=n.toString(16)}return e};w.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return w.binary.raw.encode(t);if(e==="hex")return w.binary.hex.encode(t);if(e==="base64")return w.binary.base64.encode(t);if(e==="utf8")return w.text.utf8.decode(t);if(e==="utf16")return w.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};w.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=w.encodeUtf8(e)),new w.ByteBuffer(e)};w.fillString=function(e,t){for(var n="";t>0;)t&1&&(n+=e),t>>>=1,t>0&&(e+=e);return n};w.xorBytes=function(e,t,n){for(var r="",i="",a="",s=0,o=0;n>0;--n,++s)i=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(r+=a,a="",o=0),a+=String.fromCharCode(i),++o;return r+=a,r};w.hexToBytes=function(e){var t="",n=0;for(e.length&!0&&(n=1,t+=String.fromCharCode(parseInt(e[0],16)));n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t};w.bytesToHex=function(e){return w.createBuffer(e).toHex()};w.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var wr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Tr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],gl="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";w.encode64=function(e,t){for(var n="",r="",i,a,s,o=0;o<e.length;)i=e.charCodeAt(o++),a=e.charCodeAt(o++),s=e.charCodeAt(o++),n+=wr.charAt(i>>2),n+=wr.charAt((i&3)<<4|a>>4),isNaN(a)?n+="==":(n+=wr.charAt((a&15)<<2|s>>6),n+=isNaN(s)?"=":wr.charAt(s&63)),t&&n.length>t&&(r+=n.substr(0,t)+`\r
`,n=n.substr(t));return r+=n,r};w.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",n,r,i,a,s=0;s<e.length;)n=Tr[e.charCodeAt(s++)-43],r=Tr[e.charCodeAt(s++)-43],i=Tr[e.charCodeAt(s++)-43],a=Tr[e.charCodeAt(s++)-43],t+=String.fromCharCode(n<<2|r>>4),i!==64&&(t+=String.fromCharCode((r&15)<<4|i>>2),a!==64&&(t+=String.fromCharCode((i&3)<<6|a)));return t};w.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};w.decodeUtf8=function(e){return decodeURIComponent(escape(e))};w.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Vu.encode,decode:Vu.decode}};w.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};w.binary.raw.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(e.length)),n=n||0;for(var i=n,a=0;a<e.length;++a)r[i++]=e.charCodeAt(a);return t?i-n:r};w.binary.hex.encode=w.bytesToHex;w.binary.hex.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2))),n=n||0;var i=0,a=n;for(e.length&1&&(i=1,r[a++]=parseInt(e[0],16));i<e.length;i+=2)r[a++]=parseInt(e.substr(i,2),16);return t?a-n:r};w.binary.base64.encode=function(e,t){for(var n="",r="",i,a,s,o=0;o<e.byteLength;)i=e[o++],a=e[o++],s=e[o++],n+=wr.charAt(i>>2),n+=wr.charAt((i&3)<<4|a>>4),isNaN(a)?n+="==":(n+=wr.charAt((a&15)<<2|s>>6),n+=isNaN(s)?"=":wr.charAt(s&63)),t&&n.length>t&&(r+=n.substr(0,t)+`\r
`,n=n.substr(t));return r+=n,r};w.binary.base64.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),n=n||0;for(var i,a,s,o,u=0,c=n;u<e.length;)i=Tr[e.charCodeAt(u++)-43],a=Tr[e.charCodeAt(u++)-43],s=Tr[e.charCodeAt(u++)-43],o=Tr[e.charCodeAt(u++)-43],r[c++]=i<<2|a>>4,s!==64&&(r[c++]=(a&15)<<4|s>>2,o!==64&&(r[c++]=(s&3)<<6|o));return t?c-n:r.subarray(0,c)};w.binary.base58.encode=function(e,t){return w.binary.baseN.encode(e,gl,t)};w.binary.base58.decode=function(e,t){return w.binary.baseN.decode(e,gl,t)};w.text={utf8:{},utf16:{}};w.text.utf8.encode=function(e,t,n){e=w.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length)),n=n||0;for(var i=n,a=0;a<e.length;++a)r[i++]=e.charCodeAt(a);return t?i-n:r};w.text.utf8.decode=function(e){return w.decodeUtf8(String.fromCharCode.apply(null,e))};w.text.utf16.encode=function(e,t,n){var r=t;r||(r=new Uint8Array(e.length*2));var i=new Uint16Array(r.buffer);n=n||0;for(var a=n,s=n,o=0;o<e.length;++o)i[s++]=e.charCodeAt(o),a+=2;return t?a-n:r};w.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};w.deflate=function(e,t,n){if(t=w.decode64(e.deflate(w.encode64(t)).rval),n){var r=2,i=t.charCodeAt(1);i&32&&(r=6),t=t.substring(r,t.length-4)}return t};w.inflate=function(e,t,n){var r=e.inflate(w.encode64(t)).rval;return r===null?null:w.decode64(r)};var Po=function(e,t,n){if(!e)throw new Error("WebStorage not available.");var r;if(n===null?r=e.removeItem(t):(n=w.encode64(JSON.stringify(n)),r=e.setItem(t,n)),typeof r<"u"&&r.rval!==!0){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}},Lo=function(e,t){if(!e)throw new Error("WebStorage not available.");var n=e.getItem(t);if(e.init)if(n.rval===null){if(n.error){var r=new Error(n.error.message);throw r.id=n.error.id,r.name=n.error.name,r}n=null}else n=n.rval;return n!==null&&(n=JSON.parse(w.decode64(n))),n},hp=function(e,t,n,r){var i=Lo(e,t);i===null&&(i={}),i[n]=r,Po(e,t,i)},pp=function(e,t,n){var r=Lo(e,t);return r!==null&&(r=n in r?r[n]:null),r},yp=function(e,t,n){var r=Lo(e,t);if(r!==null&&n in r){delete r[n];var i=!0;for(var a in r){i=!1;break}i&&(r=null),Po(e,t,r)}},gp=function(e,t){Po(e,t,null)},Ba=function(e,t,n){var r=null;typeof n>"u"&&(n=["web","flash"]);var i,a=!1,s=null;for(var o in n){i=n[o];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");r=e.apply(this,t),a=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,r=e.apply(this,t),a=!0)}catch(u){s=u}if(a)break}if(!a)throw s;return r};w.setItem=function(e,t,n,r,i){Ba(hp,arguments,i)};w.getItem=function(e,t,n,r){return Ba(pp,arguments,r)};w.removeItem=function(e,t,n,r){Ba(yp,arguments,r)};w.clearItems=function(e,t,n){Ba(gp,arguments,n)};w.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};w.format=function(e){for(var t=/%./g,n,r,i=0,a=[],s=0;n=t.exec(e);){r=e.substring(s,t.lastIndex-2),r.length>0&&a.push(r),s=t.lastIndex;var o=n[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(e.substring(s)),a.join("")};w.formatNumber=function(e,t,n,r){var i=e,a=isNaN(t=Math.abs(t))?2:t,s=n===void 0?",":n,o=r===void 0?".":r,u=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",l=c.length>3?c.length%3:0;return u+(l?c.substr(0,l)+o:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")};w.formatSize=function(e){return e>=1073741824?e=w.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=w.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=w.formatNumber(e/1024,0)+" KiB":e=w.formatNumber(e,0)+" bytes",e};w.bytesFromIP=function(e){return e.indexOf(".")!==-1?w.bytesFromIPv4(e):e.indexOf(":")!==-1?w.bytesFromIPv6(e):null};w.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=w.createBuffer(),n=0;n<e.length;++n){var r=parseInt(e[n],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()};w.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(s){return s.length===0&&++t,!0});for(var n=(8-e.length+t)*2,r=w.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){r.fillWithByte(0,n),n=0;continue}var a=w.hexToBytes(e[i]);a.length<2&&r.putByte(0),r.putBytes(a)}return r.getBytes()};w.bytesToIP=function(e){return e.length===4?w.bytesToIPv4(e):e.length===16?w.bytesToIPv6(e):null};w.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t.join(".")};w.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],n=[],r=0,i=0;i<e.length;i+=2){for(var a=w.bytesToHex(e[i]+e[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=n[n.length-1],o=t.length;!s||o!==s.end+1?n.push({start:o,end:o}):(s.end=o,s.end-s.start>n[r].end-n[r].start&&(r=n.length-1))}t.push(a)}if(n.length>0){var u=n[r];u.end-u.start>0&&(t.splice(u.start,u.end-u.start+1,""),u.start===0&&t.unshift(""),u.end===7&&t.push(""))}return t.join(":")};w.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in w&&!e.update)return t(null,w.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return w.cores=navigator.hardwareConcurrency,t(null,w.cores);if(typeof Worker>"u")return w.cores=1,t(null,w.cores);if(typeof Blob>"u")return w.cores=2,t(null,w.cores);var n=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){var o=Date.now(),u=o+4;self.postMessage({st:o,et:u})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16);function r(s,o,u){if(o===0){var c=Math.floor(s.reduce(function(l,f){return l+f},0)/s.length);return w.cores=Math.max(1,c),URL.revokeObjectURL(n),t(null,w.cores)}i(u,function(l,f){s.push(a(u,f)),r(s,o-1,u)})}function i(s,o){for(var u=[],c=[],l=0;l<s;++l){var f=new Worker(n);f.addEventListener("message",function(d){if(c.push(d.data),c.length===s){for(var v=0;v<s;++v)u[v].terminate();o(null,c)}}),u.push(f)}for(var l=0;l<s;++l)u[l].postMessage(l)}function a(s,o){for(var u=[],c=0;c<s;++c)for(var l=o[c],f=u[c]=[],d=0;d<s;++d)if(c!==d){var v=o[d];(l.st>v.st&&l.st<v.et||v.st>l.st&&v.st<l.et)&&f.push(d)}return u.reduce(function(h,m){return Math.max(h,m.length)},0)}};var Fe=se;Fe.cipher=Fe.cipher||{};Fe.cipher.algorithms=Fe.cipher.algorithms||{};Fe.cipher.createCipher=function(e,t){var n=e;if(typeof n=="string"&&(n=Fe.cipher.getAlgorithm(n),n&&(n=n())),!n)throw new Error("Unsupported algorithm: "+e);return new Fe.cipher.BlockCipher({algorithm:n,key:t,decrypt:!1})};Fe.cipher.createDecipher=function(e,t){var n=e;if(typeof n=="string"&&(n=Fe.cipher.getAlgorithm(n),n&&(n=n())),!n)throw new Error("Unsupported algorithm: "+e);return new Fe.cipher.BlockCipher({algorithm:n,key:t,decrypt:!0})};Fe.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Fe.cipher.algorithms[e]=t};Fe.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Fe.cipher.algorithms?Fe.cipher.algorithms[e]:null};var Uo=Fe.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Uo.prototype.start=function(e){e=e||{};var t={};for(var n in e)t[n]=e[n];t.decrypt=this._decrypt,this._finish=!1,this._input=Fe.util.createBuffer(),this.output=e.output||Fe.util.createBuffer(),this.mode.start(t)};Uo.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Uo.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(n){return e(this.blockSize,n,!1)},this.mode.unpad=function(n){return e(this.blockSize,n,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))};var Ke=se;Ke.cipher=Ke.cipher||{};var ce=Ke.cipher.modes=Ke.cipher.modes||{};ce.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};ce.ecb.prototype.start=function(e){};ce.ecb.prototype.encrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};ce.ecb.prototype.decrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};ce.ecb.prototype.pad=function(e,t){var n=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(n,n),!0};ce.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var n=e.length(),r=e.at(n-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};ce.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};ce.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=_a(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};ce.cbc.prototype.encrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r]);this._prev=this._outBlock};ce.cbc.prototype.decrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)};ce.cbc.prototype.pad=function(e,t){var n=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(n,n),!0};ce.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var n=e.length(),r=e.at(n-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};ce.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ke.util.createBuffer(),this._partialBytes=0};ce.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=_a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ce.cfb.prototype.encrypt=function(e,t,n){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var a=(this.blockSize-r)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!n)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};ce.cfb.prototype.decrypt=function(e,t,n){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-r)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!n)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};ce.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ke.util.createBuffer(),this._partialBytes=0};ce.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=_a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ce.ofb.prototype.encrypt=function(e,t,n){var r=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-r)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!n)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};ce.ofb.prototype.decrypt=ce.ofb.prototype.encrypt;ce.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ke.util.createBuffer(),this._partialBytes=0};ce.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=_a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ce.ctr.prototype.encrypt=function(e,t,n){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-r)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!n)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}ka(this._inBlock)};ce.ctr.prototype.decrypt=ce.ctr.prototype.encrypt;ce.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ke.util.createBuffer(),this._partialBytes=0,this._R=3774873600};ce.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Ke.util.createBuffer(e.iv);this._cipherLength=0;var n;if("additionalData"in e?n=Ke.util.createBuffer(e.additionalData):n=Ke.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Ke.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var r=t.length();if(r===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Fs(r*8)))}this._inBlock=this._j0.slice(0),ka(this._inBlock),this._partialBytes=0,n=Ke.util.createBuffer(n),this._aDataLength=Fs(n.length()*8);var i=n.length()%this.blockSize;for(i&&n.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];n.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()])};ce.gcm.prototype.encrypt=function(e,t,n){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-r)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a<=0||n){if(n){var s=r%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!n)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),ka(this._inBlock)};ce.gcm.prototype.decrypt=function(e,t,n){var r=e.length();if(r<this.blockSize&&!(n&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),ka(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize};ce.gcm.prototype.afterFinish=function(e,t){var n=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Ke.util.createBuffer();var r=this._aDataLength.concat(Fs(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,r);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(n=!1),n};ce.gcm.prototype.multiply=function(e,t){for(var n=[0,0,0,0],r=t.slice(0),i=0;i<128;++i){var a=e[i/32|0]&1<<31-i%32;a&&(n[0]^=r[0],n[1]^=r[1],n[2]^=r[2],n[3]^=r[3]),this.pow(r,r)}return n};ce.gcm.prototype.pow=function(e,t){for(var n=e[3]&1,r=3;r>0;--r)t[r]=e[r]>>>1|(e[r-1]&1)<<31;t[0]=e[0]>>>1,n&&(t[0]^=this._R)};ce.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],n=0;n<32;++n){var r=n/8|0,i=e[r]>>>(7-n%8)*4&15,a=this._m[n][i];t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3]}return t};ce.gcm.prototype.ghash=function(e,t,n){return t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3],this.tableMultiply(t)};ce.gcm.prototype.generateHashTable=function(e,t){for(var n=8/t,r=4*n,i=16*n,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],u=s/r|0,c=(r-1-s%r)*t;o[u]=1<<t-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,e),t)}return a};ce.gcm.prototype.generateSubHashTable=function(e,t){var n=1<<t,r=n>>>1,i=new Array(n);i[r]=e.slice(0);for(var a=r>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<r;){for(var s=1;s<a;++s){var o=i[a],u=i[s];i[a+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}a*=2}for(i[0]=[0,0,0,0],a=r+1;a<n;++a){var c=i[a^r];i[a]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return i};function _a(e,t){if(typeof e=="string"&&(e=Ke.util.createBuffer(e)),Ke.util.isArray(e)&&e.length>4){var n=e;e=Ke.util.createBuffer();for(var r=0;r<n.length;++r)e.putByte(n[r])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Ke.util.isArray(e)){for(var i=[],a=t/4,r=0;r<a;++r)i.push(e.getInt32());e=i}return e}function ka(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Fs(e){return[e/4294967296|0,e&4294967295]}var we=se;we.aes=we.aes||{};we.aes.startEncrypting=function(e,t,n,r){var i=Ra({key:e,output:n,decrypt:!1,mode:r});return i.start(t),i};we.aes.createEncryptionCipher=function(e,t){return Ra({key:e,output:null,decrypt:!1,mode:t})};we.aes.startDecrypting=function(e,t,n,r){var i=Ra({key:e,output:n,decrypt:!0,mode:r});return i.start(t),i};we.aes.createDecryptionCipher=function(e,t){return Ra({key:e,output:null,decrypt:!0,mode:t})};we.aes.Algorithm=function(e,t){Oo||ml();var n=this;n.name=e,n.mode=new t({blockSize:16,cipher:{encrypt:function(r,i){return Vs(n._w,r,i,!1)},decrypt:function(r,i){return Vs(n._w,r,i,!0)}}}),n._init=!1};we.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,n;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=we.util.createBuffer(t);else if(we.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){n=t,t=we.util.createBuffer();for(var r=0;r<n.length;++r)t.putByte(n[r])}if(!we.util.isArray(t)){n=t,t=[];var i=n.length();if(i===16||i===24||i===32){i=i>>>2;for(var r=0;r<i;++r)t.push(n.getInt32())}}if(!we.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=bl(t,e.decrypt&&!s),this._init=!0}};we.aes._expandKey=function(e,t){return Oo||ml(),bl(e,t)};we.aes._updateBlock=Vs;Kn("AES-ECB",we.cipher.modes.ecb);Kn("AES-CBC",we.cipher.modes.cbc);Kn("AES-CFB",we.cipher.modes.cfb);Kn("AES-OFB",we.cipher.modes.ofb);Kn("AES-CTR",we.cipher.modes.ctr);Kn("AES-GCM",we.cipher.modes.gcm);function Kn(e,t){var n=function(){return new we.aes.Algorithm(e,t)};we.cipher.registerAlgorithm(e,n)}var Oo=!1,an=4,ut,Ms,vl,Yr,Ft;function ml(){Oo=!0,vl=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;ut=new Array(256),Ms=new Array(256),Yr=new Array(4),Ft=new Array(4);for(var t=0;t<4;++t)Yr[t]=new Array(256),Ft[t]=new Array(256);for(var n=0,r=0,i,a,s,o,u,c,l,t=0;t<256;++t){o=r^r<<1^r<<2^r<<3^r<<4,o=o>>8^o&255^99,ut[n]=o,Ms[o]=n,u=e[o],i=e[n],a=e[i],s=e[a],c=u<<24^o<<16^o<<8^(o^u),l=(i^a^s)<<24^(n^s)<<16^(n^a^s)<<8^(n^i^s);for(var f=0;f<4;++f)Yr[f][n]=c,Ft[f][o]=l,c=c<<24|c>>>8,l=l<<24|l>>>8;n===0?n=r=1:(n=i^e[e[e[i^s]]],r^=e[e[r]])}}function bl(e,t){for(var n=e.slice(0),r,i=1,a=n.length,s=a+6+1,o=an*s,u=a;u<o;++u)r=n[u-1],u%a===0?(r=ut[r>>>16&255]<<24^ut[r>>>8&255]<<16^ut[r&255]<<8^ut[r>>>24]^vl[i]<<24,i++):a>6&&u%a===4&&(r=ut[r>>>24]<<24^ut[r>>>16&255]<<16^ut[r>>>8&255]<<8^ut[r&255]),n[u]=n[u-a]^r;if(t){var c,l=Ft[0],f=Ft[1],d=Ft[2],v=Ft[3],h=n.slice(0);o=n.length;for(var u=0,m=o-an;u<o;u+=an,m-=an)if(u===0||u===o-an)h[u]=n[m],h[u+1]=n[m+3],h[u+2]=n[m+2],h[u+3]=n[m+1];else for(var b=0;b<an;++b)c=n[m+b],h[u+(3&-b)]=l[ut[c>>>24]]^f[ut[c>>>16&255]]^d[ut[c>>>8&255]]^v[ut[c&255]];n=h}return n}function Vs(e,t,n,r){var i=e.length/4-1,a,s,o,u,c;r?(a=Ft[0],s=Ft[1],o=Ft[2],u=Ft[3],c=Ms):(a=Yr[0],s=Yr[1],o=Yr[2],u=Yr[3],c=ut);var l,f,d,v,h,m,b;l=t[0]^e[0],f=t[r?3:1]^e[1],d=t[2]^e[2],v=t[r?1:3]^e[3];for(var E=3,x=1;x<i;++x)h=a[l>>>24]^s[f>>>16&255]^o[d>>>8&255]^u[v&255]^e[++E],m=a[f>>>24]^s[d>>>16&255]^o[v>>>8&255]^u[l&255]^e[++E],b=a[d>>>24]^s[v>>>16&255]^o[l>>>8&255]^u[f&255]^e[++E],v=a[v>>>24]^s[l>>>16&255]^o[f>>>8&255]^u[d&255]^e[++E],l=h,f=m,d=b;n[0]=c[l>>>24]<<24^c[f>>>16&255]<<16^c[d>>>8&255]<<8^c[v&255]^e[++E],n[r?3:1]=c[f>>>24]<<24^c[d>>>16&255]<<16^c[v>>>8&255]<<8^c[l&255]^e[++E],n[2]=c[d>>>24]<<24^c[v>>>16&255]<<16^c[l>>>8&255]<<8^c[f&255]^e[++E],n[r?1:3]=c[v>>>24]<<24^c[l>>>16&255]<<16^c[f>>>8&255]<<8^c[d&255]^e[++E]}function Ra(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),n="AES-"+t,r;e.decrypt?r=we.cipher.createDecipher(n,e.key):r=we.cipher.createCipher(n,e.key);var i=r.start;return r.start=function(a,s){var o=null;s instanceof we.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(r,s)},r}var li=se;li.pki=li.pki||{};var $s=li.pki.oids=li.oids=li.oids||{};function K(e,t){$s[e]=t,$s[t]=e}function me(e,t){$s[e]=t}K("1.2.840.113549.1.1.1","rsaEncryption");K("1.2.840.113549.1.1.4","md5WithRSAEncryption");K("1.2.840.113549.1.1.5","sha1WithRSAEncryption");K("1.2.840.113549.1.1.7","RSAES-OAEP");K("1.2.840.113549.1.1.8","mgf1");K("1.2.840.113549.1.1.9","pSpecified");K("1.2.840.113549.1.1.10","RSASSA-PSS");K("1.2.840.113549.1.1.11","sha256WithRSAEncryption");K("1.2.840.113549.1.1.12","sha384WithRSAEncryption");K("1.2.840.113549.1.1.13","sha512WithRSAEncryption");K("1.3.101.112","EdDSA25519");K("1.2.840.10040.4.3","dsa-with-sha1");K("1.3.14.3.2.7","desCBC");K("1.3.14.3.2.26","sha1");K("1.3.14.3.2.29","sha1WithRSASignature");K("2.16.840.1.101.3.4.2.1","sha256");K("2.16.840.1.101.3.4.2.2","sha384");K("2.16.840.1.101.3.4.2.3","sha512");K("2.16.840.1.101.3.4.2.4","sha224");K("2.16.840.1.101.3.4.2.5","sha512-224");K("2.16.840.1.101.3.4.2.6","sha512-256");K("1.2.840.113549.2.2","md2");K("1.2.840.113549.2.5","md5");K("1.2.840.113549.1.7.1","data");K("1.2.840.113549.1.7.2","signedData");K("1.2.840.113549.1.7.3","envelopedData");K("1.2.840.113549.1.7.4","signedAndEnvelopedData");K("1.2.840.113549.1.7.5","digestedData");K("1.2.840.113549.1.7.6","encryptedData");K("1.2.840.113549.1.9.1","emailAddress");K("1.2.840.113549.1.9.2","unstructuredName");K("1.2.840.113549.1.9.3","contentType");K("1.2.840.113549.1.9.4","messageDigest");K("1.2.840.113549.1.9.5","signingTime");K("1.2.840.113549.1.9.6","counterSignature");K("1.2.840.113549.1.9.7","challengePassword");K("1.2.840.113549.1.9.8","unstructuredAddress");K("1.2.840.113549.1.9.14","extensionRequest");K("1.2.840.113549.1.9.20","friendlyName");K("1.2.840.113549.1.9.21","localKeyId");K("1.2.840.113549.1.9.22.1","x509Certificate");K("1.2.840.113549.1.12.10.1.1","keyBag");K("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");K("1.2.840.113549.1.12.10.1.3","certBag");K("1.2.840.113549.1.12.10.1.4","crlBag");K("1.2.840.113549.1.12.10.1.5","secretBag");K("1.2.840.113549.1.12.10.1.6","safeContentsBag");K("1.2.840.113549.1.5.13","pkcs5PBES2");K("1.2.840.113549.1.5.12","pkcs5PBKDF2");K("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");K("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");K("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");K("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");K("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");K("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");K("1.2.840.113549.2.7","hmacWithSHA1");K("1.2.840.113549.2.8","hmacWithSHA224");K("1.2.840.113549.2.9","hmacWithSHA256");K("1.2.840.113549.2.10","hmacWithSHA384");K("1.2.840.113549.2.11","hmacWithSHA512");K("1.2.840.113549.3.7","des-EDE3-CBC");K("2.16.840.1.101.3.4.1.2","aes128-CBC");K("2.16.840.1.101.3.4.1.22","aes192-CBC");K("2.16.840.1.101.3.4.1.42","aes256-CBC");K("2.5.4.3","commonName");K("2.5.4.4","surname");K("2.5.4.5","serialNumber");K("2.5.4.6","countryName");K("2.5.4.7","localityName");K("2.5.4.8","stateOrProvinceName");K("2.5.4.9","streetAddress");K("2.5.4.10","organizationName");K("2.5.4.11","organizationalUnitName");K("2.5.4.12","title");K("2.5.4.13","description");K("2.5.4.15","businessCategory");K("2.5.4.17","postalCode");K("2.5.4.42","givenName");K("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");K("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");K("2.16.840.1.113730.1.1","nsCertType");K("2.16.840.1.113730.1.13","nsComment");me("2.5.29.1","authorityKeyIdentifier");me("2.5.29.2","keyAttributes");me("2.5.29.3","certificatePolicies");me("2.5.29.4","keyUsageRestriction");me("2.5.29.5","policyMapping");me("2.5.29.6","subtreesConstraint");me("2.5.29.7","subjectAltName");me("2.5.29.8","issuerAltName");me("2.5.29.9","subjectDirectoryAttributes");me("2.5.29.10","basicConstraints");me("2.5.29.11","nameConstraints");me("2.5.29.12","policyConstraints");me("2.5.29.13","basicConstraints");K("2.5.29.14","subjectKeyIdentifier");K("2.5.29.15","keyUsage");me("2.5.29.16","privateKeyUsagePeriod");K("2.5.29.17","subjectAltName");K("2.5.29.18","issuerAltName");K("2.5.29.19","basicConstraints");me("2.5.29.20","cRLNumber");me("2.5.29.21","cRLReason");me("2.5.29.22","expirationDate");me("2.5.29.23","instructionCode");me("2.5.29.24","invalidityDate");me("2.5.29.25","cRLDistributionPoints");me("2.5.29.26","issuingDistributionPoint");me("2.5.29.27","deltaCRLIndicator");me("2.5.29.28","issuingDistributionPoint");me("2.5.29.29","certificateIssuer");me("2.5.29.30","nameConstraints");K("2.5.29.31","cRLDistributionPoints");K("2.5.29.32","certificatePolicies");me("2.5.29.33","policyMappings");me("2.5.29.34","policyConstraints");K("2.5.29.35","authorityKeyIdentifier");me("2.5.29.36","policyConstraints");K("2.5.29.37","extKeyUsage");me("2.5.29.46","freshestCRL");me("2.5.29.54","inhibitAnyPolicy");K("1.3.6.1.4.1.11129.2.4.2","timestampList");K("1.3.6.1.5.5.7.1.1","authorityInfoAccess");K("1.3.6.1.5.5.7.3.1","serverAuth");K("1.3.6.1.5.5.7.3.2","clientAuth");K("1.3.6.1.5.5.7.3.3","codeSigning");K("1.3.6.1.5.5.7.3.4","emailProtection");K("1.3.6.1.5.5.7.3.8","timeStamping");var Te=se,$=Te.asn1=Te.asn1||{};$.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};$.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};$.create=function(e,t,n,r,i){if(Te.util.isArray(r)){for(var a=[],s=0;s<r.length;++s)r[s]!==void 0&&a.push(r[s]);r=a}var o={tagClass:e,type:t,constructed:n,composed:n||Te.util.isArray(r),value:r};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=$.copy(o)),o};$.copy=function(e,t){var n;if(Te.util.isArray(e)){n=[];for(var r=0;r<e.length;++r)n.push($.copy(e[r],t));return n}return typeof e=="string"?e:(n={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:$.copy(e.value,t)},t&&!t.excludeBitStringContents&&(n.bitStringContents=e.bitStringContents),n)};$.equals=function(e,t,n){if(Te.util.isArray(e)){if(!Te.util.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!$.equals(e[r],t[r]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&$.equals(e.value,t.value);return n&&n.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};$.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var n,r=t&128;return r?n=e.getInt((t&127)<<3):n=t,n}};function ni(e,t,n){if(n>t){var r=new Error("Too few bytes to parse DER.");throw r.available=e.length(),r.remaining=t,r.requested=n,r}}var vp=function(e,t){var n=e.getByte();if(t--,n!==128){var r,i=n&128;if(!i)r=n;else{var a=n&127;ni(e,t,a),r=e.getInt(a<<3)}if(r<0)throw new Error("Negative length: "+r);return r}};$.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=Te.util.createBuffer(e));var n=e.length(),r=Xi(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=n,i.remaining=e.length(),i}return r};function Xi(e,t,n,r){var i;ni(e,t,2);var a=e.getByte();t--;var s=a&192,o=a&31;i=e.length();var u=vp(e,t);if(t-=i-e.length(),u!==void 0&&u>t){if(r.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=e.length(),c.remaining=t,c.requested=u,c}u=t}var l,f,d=(a&32)===32;if(d)if(l=[],u===void 0)for(;;){if(ni(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),l.push(Xi(e,t,n+1,r)),t-=i-e.length()}else for(;u>0;)i=e.length(),l.push(Xi(e,u,n+1,r)),t-=i-e.length(),u-=i-e.length();if(l===void 0&&s===$.Class.UNIVERSAL&&o===$.Type.BITSTRING&&(f=e.bytes(u)),l===void 0&&r.decodeBitStrings&&s===$.Class.UNIVERSAL&&o===$.Type.BITSTRING&&u>1){var v=e.read,h=t,m=0;if(o===$.Type.BITSTRING&&(ni(e,t,1),m=e.getByte(),t--),m===0)try{i=e.length();var b={strict:!0,decodeBitStrings:!0},E=Xi(e,t,n+1,b),x=i-e.length();t-=x,o==$.Type.BITSTRING&&x++;var A=E.tagClass;x===u&&(A===$.Class.UNIVERSAL||A===$.Class.CONTEXT_SPECIFIC)&&(l=[E])}catch{}l===void 0&&(e.read=v,t=h)}if(l===void 0){if(u===void 0){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=t}if(o===$.Type.BMPSTRING)for(l="";u>0;u-=2)ni(e,t,2),l+=String.fromCharCode(e.getInt16()),t-=2;else l=e.getBytes(u),t-=u}var B=f===void 0?null:{bitStringContents:f};return $.create(s,o,d,l,B)}$.toDer=function(e){var t=Te.util.createBuffer(),n=e.tagClass|e.type,r=Te.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=$.equals(e,e.original))),i)r.putBytes(e.bitStringContents);else if(e.composed){e.constructed?n|=32:r.putByte(0);for(var a=0;a<e.value.length;++a)e.value[a]!==void 0&&r.putBuffer($.toDer(e.value[a]))}else if(e.type===$.Type.BMPSTRING)for(var a=0;a<e.value.length;++a)r.putInt16(e.value.charCodeAt(a));else e.type===$.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?r.putBytes(e.value.substr(1)):r.putBytes(e.value);if(t.putByte(n),r.length()<=127)t.putByte(r.length()&127);else{var s=r.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);t.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)t.putByte(o.charCodeAt(a))}return t.putBuffer(r),t};$.oidToDer=function(e){var t=e.split("."),n=Te.util.createBuffer();n.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var r,i,a,s,o=2;o<t.length;++o){r=!0,i=[],a=parseInt(t[o],10);do s=a&127,a=a>>>7,r||(s|=128),i.push(s),r=!1;while(a>0);for(var u=i.length-1;u>=0;--u)n.putByte(i[u])}return n};$.derToOid=function(e){var t;typeof e=="string"&&(e=Te.util.createBuffer(e));var n=e.getByte();t=Math.floor(n/40)+"."+n%40;for(var r=0;e.length()>0;)n=e.getByte(),r=r<<7,n&128?r+=n&127:(t+="."+(r+n),r=0);return t};$.utcTimeToDate=function(e){var t=new Date,n=parseInt(e.substr(0,2),10);n=n>=50?1900+n:2e3+n;var r=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),a=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var u=e.charAt(10),c=10;u!=="+"&&u!=="-"&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(n,r,i),t.setUTCHours(a,s,o,0),c&&(u=e.charAt(c),u==="+"||u==="-")){var l=parseInt(e.substr(c+1,2),10),f=parseInt(e.substr(c+4,2),10),d=l*60+f;d*=6e4,u==="+"?t.setTime(+t-d):t.setTime(+t+d)}return t};$.generalizedTimeToDate=function(e){var t=new Date,n=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),u=0,c=0,l=!1;e.charAt(e.length-1)==="Z"&&(l=!0);var f=e.length-5,d=e.charAt(f);if(d==="+"||d==="-"){var v=parseInt(e.substr(f+1,2),10),h=parseInt(e.substr(f+4,2),10);c=v*60+h,c*=6e4,d==="+"&&(c*=-1),l=!0}return e.charAt(14)==="."&&(u=parseFloat(e.substr(14),10)*1e3),l?(t.setUTCFullYear(n,r,i),t.setUTCHours(a,s,o,u),t.setTime(+t+c)):(t.setFullYear(n,r,i),t.setHours(a,s,o,u)),t};$.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",n=[];n.push((""+e.getUTCFullYear()).substr(2)),n.push(""+(e.getUTCMonth()+1)),n.push(""+e.getUTCDate()),n.push(""+e.getUTCHours()),n.push(""+e.getUTCMinutes()),n.push(""+e.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(t+="0"),t+=n[r];return t+="Z",t};$.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",n=[];n.push(""+e.getUTCFullYear()),n.push(""+(e.getUTCMonth()+1)),n.push(""+e.getUTCDate()),n.push(""+e.getUTCHours()),n.push(""+e.getUTCMinutes()),n.push(""+e.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(t+="0"),t+=n[r];return t+="Z",t};$.integerToDer=function(e){var t=Te.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var n=new Error("Integer too large; max is 32-bits.");throw n.integer=e,n};$.derToInteger=function(e){typeof e=="string"&&(e=Te.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};$.validate=function(e,t,n,r){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&Te.util.isArray(t.value))for(var a=0,s=0;i&&s<t.value.length;++s)i=t.value[s].optional||!1,e.value[a]&&(i=$.validate(e.value[a],t.value[s],n,r),i?++a:t.value[s].optional&&(i=!0)),!i&&r&&r.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&n&&(t.capture&&(n[t.capture]=e.value),t.captureAsn1&&(n[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(n[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e))if(e.bitStringContents.length<2)n[t.captureBitStringValue]="";else{var o=e.bitStringContents.charCodeAt(0);if(o!==0)throw new Error("captureBitStringValue only supported for zero unused bits");n[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else r&&r.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else r&&(e.tagClass!==t.tagClass&&r.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&r.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var $u=/[^\\u0000-\\u00ff]/;$.prettyPrint=function(e,t,n){var r="";t=t||0,n=n||2,t>0&&(r+=`
`);for(var i="",a=0;a<t*n;++a)i+=" ";switch(r+=i+"Tag: ",e.tagClass){case $.Class.UNIVERSAL:r+="Universal:";break;case $.Class.APPLICATION:r+="Application:";break;case $.Class.CONTEXT_SPECIFIC:r+="Context-Specific:";break;case $.Class.PRIVATE:r+="Private:";break}if(e.tagClass===$.Class.UNIVERSAL)switch(r+=e.type,e.type){case $.Type.NONE:r+=" (None)";break;case $.Type.BOOLEAN:r+=" (Boolean)";break;case $.Type.INTEGER:r+=" (Integer)";break;case $.Type.BITSTRING:r+=" (Bit string)";break;case $.Type.OCTETSTRING:r+=" (Octet string)";break;case $.Type.NULL:r+=" (Null)";break;case $.Type.OID:r+=" (Object Identifier)";break;case $.Type.ODESC:r+=" (Object Descriptor)";break;case $.Type.EXTERNAL:r+=" (External or Instance of)";break;case $.Type.REAL:r+=" (Real)";break;case $.Type.ENUMERATED:r+=" (Enumerated)";break;case $.Type.EMBEDDED:r+=" (Embedded PDV)";break;case $.Type.UTF8:r+=" (UTF8)";break;case $.Type.ROID:r+=" (Relative Object Identifier)";break;case $.Type.SEQUENCE:r+=" (Sequence)";break;case $.Type.SET:r+=" (Set)";break;case $.Type.PRINTABLESTRING:r+=" (Printable String)";break;case $.Type.IA5String:r+=" (IA5String (ASCII))";break;case $.Type.UTCTIME:r+=" (UTC time)";break;case $.Type.GENERALIZEDTIME:r+=" (Generalized time)";break;case $.Type.BMPSTRING:r+=" (BMP String)";break}else r+=e.type;if(r+=`
`,r+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var s=0,o="",a=0;a<e.value.length;++a)e.value[a]!==void 0&&(s+=1,o+=$.prettyPrint(e.value[a],t+1,n),a+1<e.value.length&&(o+=","));r+=i+"Sub values: "+s+o}else{if(r+=i+"Value: ",e.type===$.Type.OID){var u=$.derToOid(e.value);r+=u,Te.pki&&Te.pki.oids&&u in Te.pki.oids&&(r+=" ("+Te.pki.oids[u]+") ")}if(e.type===$.Type.INTEGER)try{r+=$.derToInteger(e.value)}catch{r+="0x"+Te.util.bytesToHex(e.value)}else if(e.type===$.Type.BITSTRING){if(e.value.length>1?r+="0x"+Te.util.bytesToHex(e.value.slice(1)):r+="(none)",e.value.length>0){var c=e.value.charCodeAt(0);c==1?r+=" (1 unused bit shown)":c>1&&(r+=" ("+c+" unused bits shown)")}}else if(e.type===$.Type.OCTETSTRING)$u.test(e.value)||(r+="("+e.value+") "),r+="0x"+Te.util.bytesToHex(e.value);else if(e.type===$.Type.UTF8)try{r+=Te.util.decodeUtf8(e.value)}catch(l){if(l.message==="URI malformed")r+="0x"+Te.util.bytesToHex(e.value)+" (malformed UTF8)";else throw l}else e.type===$.Type.PRINTABLESTRING||e.type===$.Type.IA5String?r+=e.value:$u.test(e.value)?r+="0x"+Te.util.bytesToHex(e.value):e.value.length===0?r+="[null]":r+=e.value}return r};var ua=se;ua.md=ua.md||{};ua.md.algorithms=ua.md.algorithms||{};var cr=se,mp=cr.hmac=cr.hmac||{};mp.create=function(){var e=null,t=null,n=null,r=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in cr.md.algorithms)t=cr.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else t=a;if(s===null)s=e;else{if(typeof s=="string")s=cr.util.createBuffer(s);else if(cr.util.isArray(s)){var o=s;s=cr.util.createBuffer();for(var u=0;u<o.length;++u)s.putByte(o[u])}var c=s.length();c>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),n=cr.util.createBuffer(),r=cr.util.createBuffer(),c=s.length();for(var u=0;u<c;++u){var o=s.at(u);n.putByte(54^o),r.putByte(92^o)}if(c<t.blockLength)for(var o=t.blockLength-c,u=0;u<o;++u)n.putByte(54),r.putByte(92);e=s,n=n.bytes(),r=r.bytes()}t.start(),t.update(n)},i.update=function(a){t.update(a)},i.getMac=function(){var a=t.digest().bytes();return t.start(),t.update(r),t.update(a),t.digest()},i.digest=i.getMac,i};var zt=se,Sl=zt.md5=zt.md5||{};zt.md.md5=zt.md.algorithms.md5=Sl;Sl.create=function(){El||bp();var e=null,t=zt.util.createBuffer(),n=new Array(16),r={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var i=r.messageLengthSize/4,a=0;a<i;++a)r.fullMessageLength.push(0);return t=zt.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},r},r.start(),r.update=function(i,a){a==="utf8"&&(i=zt.util.encodeUtf8(i));var s=i.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=s[1],s[1]=s[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),Hu(e,n,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var i=zt.util.createBuffer();i.putBytes(t.bytes());var a=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=a&r.blockLength-1;i.putBytes(Hs.substr(0,r.blockLength-s));for(var o,u=0,c=r.fullMessageLength.length-1;c>=0;--c)o=r.fullMessageLength[c]*8+u,u=o/4294967296>>>0,i.putInt32Le(o>>>0);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};Hu(l,n,i);var f=zt.util.createBuffer();return f.putInt32Le(l.h0),f.putInt32Le(l.h1),f.putInt32Le(l.h2),f.putInt32Le(l.h3),f},r};var Hs=null,Ji=null,ii=null,ln=null,El=!1;function bp(){Hs=String.fromCharCode(128),Hs+=zt.util.fillString(String.fromCharCode(0),64),Ji=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],ii=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],ln=new Array(64);for(var e=0;e<64;++e)ln[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296);El=!0}function Hu(e,t,n){for(var r,i,a,s,o,u,c,l,f=n.length();f>=64;){for(i=e.h0,a=e.h1,s=e.h2,o=e.h3,l=0;l<16;++l)t[l]=n.getInt32Le(),u=o^a&(s^o),r=i+u+ln[l]+t[l],c=ii[l],i=o,o=s,s=a,a+=r<<c|r>>>32-c;for(;l<32;++l)u=s^o&(a^s),r=i+u+ln[l]+t[Ji[l]],c=ii[l],i=o,o=s,s=a,a+=r<<c|r>>>32-c;for(;l<48;++l)u=a^s^o,r=i+u+ln[l]+t[Ji[l]],c=ii[l],i=o,o=s,s=a,a+=r<<c|r>>>32-c;for(;l<64;++l)u=s^(a|~o),r=i+u+ln[l]+t[Ji[l]],c=ii[l],i=o,o=s,s=a,a+=r<<c|r>>>32-c;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,f-=64}}var ca=se,Cl=ca.pem=ca.pem||{};Cl.encode=function(e,t){t=t||{};var n="-----BEGIN "+e.type+`-----\r
`,r;if(e.procType&&(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},n+=Di(r)),e.contentDomain&&(r={name:"Content-Domain",values:[e.contentDomain]},n+=Di(r)),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),n+=Di(r)),e.headers)for(var i=0;i<e.headers.length;++i)n+=Di(e.headers[i]);return e.procType&&(n+=`\r
`),n+=ca.util.encode64(e.body,t.maxline||64)+`\r
`,n+="-----END "+e.type+`-----\r
`,n};Cl.decode=function(e){for(var t=[],n=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,r=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=n.exec(e),!!a;){var s=a[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:ca.util.decode64(a[3])};if(t.push(o),!!a[2]){for(var u=a[2].split(i),c=0;a&&c<u.length;){for(var l=u[c].replace(/\s+$/,""),f=c+1;f<u.length;++f){var d=u[f];if(!/\s/.test(d[0]))break;l+=d,c=f}if(a=l.match(r),a){for(var v={name:a[1],values:[]},h=a[2].split(","),m=0;m<h.length;++m)v.values.push(Sp(h[m]));if(o.procType)if(!o.contentDomain&&v.name==="Content-Domain")o.contentDomain=h[0]||"";else if(!o.dekInfo&&v.name==="DEK-Info"){if(v.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:h[0],parameters:h[1]||null}}else o.headers.push(v);else{if(v.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(v.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:h[0],type:h[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Di(e){for(var t=e.name+": ",n=[],r=function(u,c){return" "+c},i=0;i<e.values.length;++i)n.push(e.values[i].replace(/^(\S+\r\n)/,r));t+=n.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<t.length;++i,++a)if(a>65&&s!==-1){var o=t[s];o===","?(++s,t=t.substr(0,s)+`\r
 `+t.substr(s)):t=t.substr(0,s)+`\r
`+o+t.substr(s+1),a=i-s-1,s=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(s=i);return t}function Sp(e){return e.replace(/^\s+/,"")}var Ie=se;Ie.des=Ie.des||{};Ie.des.startEncrypting=function(e,t,n,r){var i=Na({key:e,output:n,decrypt:!1,mode:r||(t===null?"ECB":"CBC")});return i.start(t),i};Ie.des.createEncryptionCipher=function(e,t){return Na({key:e,output:null,decrypt:!1,mode:t})};Ie.des.startDecrypting=function(e,t,n,r){var i=Na({key:e,output:n,decrypt:!0,mode:r||(t===null?"ECB":"CBC")});return i.start(t),i};Ie.des.createDecryptionCipher=function(e,t){return Na({key:e,output:null,decrypt:!0,mode:t})};Ie.des.Algorithm=function(e,t){var n=this;n.name=e,n.mode=new t({blockSize:8,cipher:{encrypt:function(r,i){return ju(n._keys,r,i,!1)},decrypt:function(r,i){return ju(n._keys,r,i,!0)}}}),n._init=!1};Ie.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=Ie.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=_p(t),this._init=!0}};ir("DES-ECB",Ie.cipher.modes.ecb);ir("DES-CBC",Ie.cipher.modes.cbc);ir("DES-CFB",Ie.cipher.modes.cfb);ir("DES-OFB",Ie.cipher.modes.ofb);ir("DES-CTR",Ie.cipher.modes.ctr);ir("3DES-ECB",Ie.cipher.modes.ecb);ir("3DES-CBC",Ie.cipher.modes.cbc);ir("3DES-CFB",Ie.cipher.modes.cfb);ir("3DES-OFB",Ie.cipher.modes.ofb);ir("3DES-CTR",Ie.cipher.modes.ctr);function ir(e,t){var n=function(){return new Ie.des.Algorithm(e,t)};Ie.cipher.registerAlgorithm(e,n)}var Ep=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Cp=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],wp=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Tp=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],xp=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Ap=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Ip=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Bp=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _p(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],v=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=e.length()>8?3:1,b=[],E=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],x=0,A,B=0;B<m;B++){var _=e.getInt32(),L=e.getInt32();A=(_>>>4^L)&252645135,L^=A,_^=A<<4,A=(L>>>-16^_)&65535,_^=A,L^=A<<-16,A=(_>>>2^L)&858993459,L^=A,_^=A<<2,A=(L>>>-16^_)&65535,_^=A,L^=A<<-16,A=(_>>>1^L)&1431655765,L^=A,_^=A<<1,A=(L>>>8^_)&16711935,_^=A,L^=A<<8,A=(_>>>1^L)&1431655765,L^=A,_^=A<<1,A=_<<8|L>>>20&240,_=L<<24|L<<8&16711680|L>>>8&65280|L>>>24&240,L=A;for(var W=0;W<E.length;++W){E[W]?(_=_<<2|_>>>26,L=L<<2|L>>>26):(_=_<<1|_>>>27,L=L<<1|L>>>27),_&=-15,L&=-15;var te=t[_>>>28]|n[_>>>24&15]|r[_>>>20&15]|i[_>>>16&15]|a[_>>>12&15]|s[_>>>8&15]|o[_>>>4&15],re=u[L>>>28]|c[L>>>24&15]|l[L>>>20&15]|f[L>>>16&15]|d[L>>>12&15]|v[L>>>8&15]|h[L>>>4&15];A=(re>>>16^te)&65535,b[x++]=te^A,b[x++]=re^A<<16}}return b}function ju(e,t,n,r){var i=e.length===32?3:9,a;i===3?a=r?[30,-2,-2]:[0,32,2]:a=r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=t[0],u=t[1];s=(o>>>4^u)&252645135,u^=s,o^=s<<4,s=(o>>>16^u)&65535,u^=s,o^=s<<16,s=(u>>>2^o)&858993459,o^=s,u^=s<<2,s=(u>>>8^o)&16711935,o^=s,u^=s<<8,s=(o>>>1^u)&1431655765,u^=s,o^=s<<1,o=o<<1|o>>>31,u=u<<1|u>>>31;for(var c=0;c<i;c+=3){for(var l=a[c+1],f=a[c+2],d=a[c];d!=l;d+=f){var v=u^e[d],h=(u>>>4|u<<28)^e[d+1];s=o,o=u,u=s^(Cp[v>>>24&63]|Tp[v>>>16&63]|Ap[v>>>8&63]|Bp[v&63]|Ep[h>>>24&63]|wp[h>>>16&63]|xp[h>>>8&63]|Ip[h&63])}s=o,o=u,u=s}o=o>>>1|o<<31,u=u>>>1|u<<31,s=(o>>>1^u)&1431655765,u^=s,o^=s<<1,s=(u>>>8^o)&16711935,o^=s,u^=s<<8,s=(u>>>2^o)&858993459,o^=s,u^=s<<2,s=(o>>>16^u)&65535,u^=s,o^=s<<16,s=(o>>>4^u)&252645135,u^=s,o^=s<<4,n[0]=o,n[1]=u}function Na(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),n="DES-"+t,r;e.decrypt?r=Ie.cipher.createDecipher(n,e.key):r=Ie.cipher.createCipher(n,e.key);var i=r.start;return r.start=function(a,s){var o=null;s instanceof Ie.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(r,s)},r}var ct=se,kp=ct.pkcs5=ct.pkcs5||{},ur;ct.util.isNodejs&&!ct.options.usePureJavaScript&&(ur=tn());ct.pbkdf2=kp.pbkdf2=function(e,t,n,r,i,a){if(typeof i=="function"&&(a=i,i=null),ct.util.isNodejs&&!ct.options.usePureJavaScript&&ur.pbkdf2&&(i===null||typeof i!="object")&&(ur.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=R.Buffer.from(e,"binary"),t=R.Buffer.from(t,"binary"),a?ur.pbkdf2Sync.length===4?ur.pbkdf2(e,t,n,r,function(A,B){if(A)return a(A);a(null,B.toString("binary"))}):ur.pbkdf2(e,t,n,r,i,function(A,B){if(A)return a(A);a(null,B.toString("binary"))}):ur.pbkdf2Sync.length===4?ur.pbkdf2Sync(e,t,n,r).toString("binary"):ur.pbkdf2Sync(e,t,n,r,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in ct.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=ct.md[i].create()}var s=i.digestLength;if(r>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var u=Math.ceil(r/s),c=r-(u-1)*s,l=ct.hmac.create();l.start(i,e);var f="",d,v,h;if(!a){for(var m=1;m<=u;++m){l.start(null,null),l.update(t),l.update(ct.util.int32ToBytes(m)),d=h=l.digest().getBytes();for(var b=2;b<=n;++b)l.start(null,null),l.update(h),v=l.digest().getBytes(),d=ct.util.xorBytes(d,v,s),h=v;f+=m<u?d:d.substr(0,c)}return f}var m=1,b;function E(){if(m>u)return a(null,f);l.start(null,null),l.update(t),l.update(ct.util.int32ToBytes(m)),d=h=l.digest().getBytes(),b=2,x()}function x(){if(b<=n)return l.start(null,null),l.update(h),v=l.digest().getBytes(),d=ct.util.xorBytes(d,v,s),h=v,++b,ct.util.setImmediate(x);f+=m<u?d:d.substr(0,c),++m,E()}E()};var Qt=se,wl=Qt.sha256=Qt.sha256||{};Qt.md.sha256=Qt.md.algorithms.sha256=wl;wl.create=function(){Tl||Rp();var e=null,t=Qt.util.createBuffer(),n=new Array(64),r={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var i=r.messageLengthSize/4,a=0;a<i;++a)r.fullMessageLength.push(0);return t=Qt.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},r},r.start(),r.update=function(i,a){a==="utf8"&&(i=Qt.util.encodeUtf8(i));var s=i.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=s[1],s[1]=s[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),qu(e,n,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var i=Qt.util.createBuffer();i.putBytes(t.bytes());var a=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=a&r.blockLength-1;i.putBytes(js.substr(0,r.blockLength-s));for(var o,u,c=r.fullMessageLength[0]*8,l=0;l<r.fullMessageLength.length-1;++l)o=r.fullMessageLength[l+1]*8,u=o/4294967296>>>0,c+=u,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};qu(f,n,i);var d=Qt.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},r};var js=null,Tl=!1,xl=null;function Rp(){js=String.fromCharCode(128),js+=Qt.util.fillString(String.fromCharCode(0),64),xl=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Tl=!0}function qu(e,t,n){for(var r,i,a,s,o,u,c,l,f,d,v,h,m,b,E,x=n.length();x>=64;){for(c=0;c<16;++c)t[c]=n.getInt32();for(;c<64;++c)r=t[c-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,i=t[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=r+t[c-7]+i+t[c-16]|0;for(l=e.h0,f=e.h1,d=e.h2,v=e.h3,h=e.h4,m=e.h5,b=e.h6,E=e.h7,c=0;c<64;++c)s=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),o=b^h&(m^b),a=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),u=l&f|d&(l^f),r=E+s+o+xl[c]+t[c],i=a+u,E=b,b=m,m=h,h=v+r>>>0,v=d,d=f,f=l,l=r+i>>>0;e.h0=e.h0+l|0,e.h1=e.h1+f|0,e.h2=e.h2+d|0,e.h3=e.h3+v|0,e.h4=e.h4+h|0,e.h5=e.h5+m|0,e.h6=e.h6+b|0,e.h7=e.h7+E|0,x-=64}}var qt=se,Zi=null;qt.util.isNodejs&&!qt.options.usePureJavaScript&&!Er.versions["node-webkit"]&&(Zi=tn());var Np=qt.prng=qt.prng||{};Np.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},n=e.md,r=new Array(32),i=0;i<32;++i)r[i]=n.create();t.pools=r,t.pool=0,t.generate=function(c,l){if(!l)return t.generateSync(c);var f=t.plugin.cipher,d=t.plugin.increment,v=t.plugin.formatKey,h=t.plugin.formatSeed,m=qt.util.createBuffer();t.key=null,b();function b(E){if(E)return l(E);if(m.length()>=c)return l(null,m.getBytes(c));if(t.generated>1048575&&(t.key=null),t.key===null)return qt.util.nextTick(function(){a(b)});var x=f(t.key,t.seed);t.generated+=x.length,m.putBytes(x),t.key=v(f(t.key,d(t.seed))),t.seed=h(f(t.key,t.seed)),qt.util.setImmediate(b)}},t.generateSync=function(c){var l=t.plugin.cipher,f=t.plugin.increment,d=t.plugin.formatKey,v=t.plugin.formatSeed;t.key=null;for(var h=qt.util.createBuffer();h.length()<c;){t.generated>1048575&&(t.key=null),t.key===null&&s();var m=l(t.key,t.seed);t.generated+=m.length,h.putBytes(m),t.key=d(l(t.key,f(t.seed))),t.seed=v(l(t.key,t.seed))}return h.getBytes(c)};function a(c){if(t.pools[0].messageLength>=32)return o(),c();var l=32-t.pools[0].messageLength<<5;t.seedFile(l,function(f,d){if(f)return c(f);t.collect(d),o(),c()})}function s(){if(t.pools[0].messageLength>=32)return o();var c=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(c)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var c=t.plugin.md.create();c.update(t.keyBytes);for(var l=1,f=0;f<32;++f)t.reseeds%l===0&&(c.update(t.pools[f].digest().getBytes()),t.pools[f].start()),l=l<<1;t.keyBytes=c.digest().getBytes(),c.start(),c.update(t.keyBytes);var d=c.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(d),t.generated=0}function u(c){var l=null,f=qt.util.globalScope,d=f.crypto||f.msCrypto;d&&d.getRandomValues&&(l=function(_){return d.getRandomValues(_)});var v=qt.util.createBuffer();if(l)for(;v.length()<c;){var h=Math.max(1,Math.min(c-v.length(),65536)/4),m=new Uint32Array(Math.floor(h));try{l(m);for(var b=0;b<m.length;++b)v.putInt32(m[b])}catch(_){if(!(typeof QuotaExceededError<"u"&&_ instanceof QuotaExceededError))throw _}}if(v.length()<c)for(var E,x,A,B=Math.floor(Math.random()*65536);v.length()<c;){x=16807*(B&65535),E=16807*(B>>16),x+=(E&32767)<<16,x+=E>>15,x=(x&2147483647)+(x>>31),B=x&4294967295;for(var b=0;b<3;++b)A=B>>>(b<<3),A^=Math.floor(Math.random()*256),v.putByte(A&255)}return v.getBytes(c)}return Zi?(t.seedFile=function(c,l){Zi.randomBytes(c,function(f,d){if(f)return l(f);l(null,d.toString())})},t.seedFileSync=function(c){return Zi.randomBytes(c).toString()}):(t.seedFile=function(c,l){try{l(null,u(c))}catch(f){l(f)}},t.seedFileSync=u),t.collect=function(c){for(var l=c.length,f=0;f<l;++f)t.pools[t.pool].update(c.substr(f,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(c,l){for(var f="",d=0;d<l;d+=8)f+=String.fromCharCode(c>>d&255);t.collect(f)},t.registerWorker=function(c){if(c===self)t.seedFile=function(f,d){function v(h){var m=h.data;m.forge&&m.forge.prng&&(self.removeEventListener("message",v),d(m.forge.prng.err,m.forge.prng.bytes))}self.addEventListener("message",v),self.postMessage({forge:{prng:{needed:f}}})};else{var l=function(f){var d=f.data;d.forge&&d.forge.prng&&t.seedFile(d.forge.prng.needed,function(v,h){c.postMessage({forge:{prng:{err:v,bytes:h}}})})};c.addEventListener("message",l)}},t};var Oe=se;(function(){if(Oe.random&&Oe.random.getBytes){Oe.random;return}(function(e){var t={},n=new Array(4),r=Oe.util.createBuffer();t.formatKey=function(f){var d=Oe.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),Oe.aes._expandKey(f,!1)},t.formatSeed=function(f){var d=Oe.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),f},t.cipher=function(f,d){return Oe.aes._updateBlock(f,d,n,!1),r.putInt32(n[0]),r.putInt32(n[1]),r.putInt32(n[2]),r.putInt32(n[3]),r.getBytes()},t.increment=function(f){return++f[3],f},t.md=Oe.md.sha256;function i(){var f=Oe.prng.create(t);return f.getBytes=function(d,v){return f.generate(d,v)},f.getBytesSync=function(d){return f.generate(d)},f}var a=i(),s=null,o=Oe.util.globalScope,u=o.crypto||o.msCrypto;if(u&&u.getRandomValues&&(s=function(f){return u.getRandomValues(f)}),Oe.options.usePureJavaScript||!Oe.util.isNodejs&&!s){if(a.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var l in navigator)try{typeof navigator[l]=="string"&&(c+=navigator[l])}catch{}a.collect(c),c=null}e&&(e().mousemove(function(f){a.collectInt(f.clientX,16),a.collectInt(f.clientY,16)}),e().keypress(function(f){a.collectInt(f.charCode,8)}))}if(!Oe.random)Oe.random=a;else for(var l in a)Oe.random[l]=a[l];Oe.random.createInstance=i,Oe.random})(typeof jQuery<"u"?jQuery:null)})();var pt=se,ps=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Gu=[1,2,3,5],Pp=function(e,t){return e<<t&65535|(e&65535)>>16-t},Lp=function(e,t){return(e&65535)>>t|e<<16-t&65535};pt.rc2=pt.rc2||{};pt.rc2.expandKey=function(e,t){typeof e=="string"&&(e=pt.util.createBuffer(e)),t=t||128;var n=e,r=e.length(),i=t,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=r;o<128;o++)n.putByte(ps[n.at(o-1)+n.at(o-r)&255]);for(n.setAt(128-a,ps[n.at(128-a)&s]),o=127-a;o>=0;o--)n.setAt(o,ps[n.at(o+1)^n.at(o+a)]);return n};var Al=function(e,t,n){var r=!1,i=null,a=null,s=null,o,u,c,l,f=[];for(e=pt.rc2.expandKey(e,t),c=0;c<64;c++)f.push(e.getInt16Le());n?(o=function(h){for(c=0;c<4;c++)h[c]+=f[l]+(h[(c+3)%4]&h[(c+2)%4])+(~h[(c+3)%4]&h[(c+1)%4]),h[c]=Pp(h[c],Gu[c]),l++},u=function(h){for(c=0;c<4;c++)h[c]+=f[h[(c+3)%4]&63]}):(o=function(h){for(c=3;c>=0;c--)h[c]=Lp(h[c],Gu[c]),h[c]-=f[l]+(h[(c+3)%4]&h[(c+2)%4])+(~h[(c+3)%4]&h[(c+1)%4]),l--},u=function(h){for(c=3;c>=0;c--)h[c]-=f[h[(c+3)%4]&63]});var d=function(h){var m=[];for(c=0;c<4;c++){var b=i.getInt16Le();s!==null&&(n?b^=s.getInt16Le():s.putInt16Le(b)),m.push(b&65535)}l=n?0:63;for(var E=0;E<h.length;E++)for(var x=0;x<h[E][0];x++)h[E][1](m);for(c=0;c<4;c++)s!==null&&(n?s.putInt16Le(m[c]):m[c]^=s.getInt16Le()),a.putInt16Le(m[c])},v=null;return v={start:function(h,m){h&&typeof h=="string"&&(h=pt.util.createBuffer(h)),r=!1,i=pt.util.createBuffer(),a=m||new pt.util.createBuffer,s=h,v.output=a},update:function(h){for(r||i.putBuffer(h);i.length()>=8;)d([[5,o],[1,u],[6,o],[1,u],[5,o]])},finish:function(h){var m=!0;if(n)if(h)m=h(8,i,!n);else{var b=i.length()===8?8:8-i.length();i.fillWithByte(b,b)}if(m&&(r=!0,v.update()),!n&&(m=i.length()===0,m))if(h)m=h(8,a,!n);else{var E=a.length(),x=a.at(E-1);x>E?m=!1:a.truncate(x)}return m}},v};pt.rc2.startEncrypting=function(e,t,n){var r=pt.rc2.createEncryptionCipher(e,128);return r.start(t,n),r};pt.rc2.createEncryptionCipher=function(e,t){return Al(e,t,!0)};pt.rc2.startDecrypting=function(e,t,n){var r=pt.rc2.createDecryptionCipher(e,128);return r.start(t,n),r};pt.rc2.createDecryptionCipher=function(e,t){return Al(e,t,!1)};var qs=se;qs.jsbn=qs.jsbn||{};var lr;function O(e,t,n){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,n):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}qs.jsbn.BigInteger=O;function ge(){return new O(null)}function Up(e,t,n,r,i,a){for(;--a>=0;){var s=t*this.data[e++]+n.data[r]+i;i=Math.floor(s/67108864),n.data[r++]=s&67108863}return i}function Op(e,t,n,r,i,a){for(var s=t&32767,o=t>>15;--a>=0;){var u=this.data[e]&32767,c=this.data[e++]>>15,l=o*u+c*s;u=s*u+((l&32767)<<15)+n.data[r]+(i&1073741823),i=(u>>>30)+(l>>>15)+o*c+(i>>>30),n.data[r++]=u&1073741823}return i}function Wu(e,t,n,r,i,a){for(var s=t&16383,o=t>>14;--a>=0;){var u=this.data[e]&16383,c=this.data[e++]>>14,l=o*u+c*s;u=s*u+((l&16383)<<14)+n.data[r]+i,i=(u>>28)+(l>>14)+o*c,n.data[r++]=u&268435455}return i}typeof navigator>"u"?(O.prototype.am=Wu,lr=28):navigator.appName=="Microsoft Internet Explorer"?(O.prototype.am=Op,lr=30):navigator.appName!="Netscape"?(O.prototype.am=Up,lr=26):(O.prototype.am=Wu,lr=28);O.prototype.DB=lr;O.prototype.DM=(1<<lr)-1;O.prototype.DV=1<<lr;var Do=52;O.prototype.FV=Math.pow(2,Do);O.prototype.F1=Do-lr;O.prototype.F2=2*lr-Do;var Dp="0123456789abcdefghijklmnopqrstuvwxyz",Pa=new Array,Fn,At;Fn="0".charCodeAt(0);for(At=0;At<=9;++At)Pa[Fn++]=At;Fn="a".charCodeAt(0);for(At=10;At<36;++At)Pa[Fn++]=At;Fn="A".charCodeAt(0);for(At=10;At<36;++At)Pa[Fn++]=At;function zu(e){return Dp.charAt(e)}function Il(e,t){var n=Pa[e.charCodeAt(t)];return n??-1}function Kp(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function Fp(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function xr(e){var t=ge();return t.fromInt(e),t}function Mp(e,t){var n;if(t==16)n=4;else if(t==8)n=3;else if(t==256)n=8;else if(t==2)n=1;else if(t==32)n=5;else if(t==4)n=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var r=e.length,i=!1,a=0;--r>=0;){var s=n==8?e[r]&255:Il(e,r);if(s<0){e.charAt(r)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+n>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=n,a>=this.DB&&(a-=this.DB)}n==8&&e[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&O.ZERO.subTo(this,this)}function Vp(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function $p(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var n=(1<<t)-1,r,i=!1,a="",s=this.t,o=this.DB-s*this.DB%t;if(s-- >0)for(o<this.DB&&(r=this.data[s]>>o)>0&&(i=!0,a=zu(r));s>=0;)o<t?(r=(this.data[s]&(1<<o)-1)<<t-o,r|=this.data[--s]>>(o+=this.DB-t)):(r=this.data[s]>>(o-=t)&n,o<=0&&(o+=this.DB,--s)),r>0&&(i=!0),i&&(a+=zu(r));return i?a:"0"}function Hp(){var e=ge();return O.ZERO.subTo(this,e),e}function jp(){return this.s<0?this.negate():this}function qp(e){var t=this.s-e.s;if(t!=0)return t;var n=this.t;if(t=n-e.t,t!=0)return this.s<0?-t:t;for(;--n>=0;)if((t=this.data[n]-e.data[n])!=0)return t;return 0}function La(e){var t=1,n;return(n=e>>>16)!=0&&(e=n,t+=16),(n=e>>8)!=0&&(e=n,t+=8),(n=e>>4)!=0&&(e=n,t+=4),(n=e>>2)!=0&&(e=n,t+=2),(n=e>>1)!=0&&(e=n,t+=1),t}function Gp(){return this.t<=0?0:this.DB*(this.t-1)+La(this.data[this.t-1]^this.s&this.DM)}function Wp(e,t){var n;for(n=this.t-1;n>=0;--n)t.data[n+e]=this.data[n];for(n=e-1;n>=0;--n)t.data[n]=0;t.t=this.t+e,t.s=this.s}function zp(e,t){for(var n=e;n<this.t;++n)t.data[n-e]=this.data[n];t.t=Math.max(this.t-e,0),t.s=this.s}function Qp(e,t){var n=e%this.DB,r=this.DB-n,i=(1<<r)-1,a=Math.floor(e/this.DB),s=this.s<<n&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+a+1]=this.data[o]>>r|s,s=(this.data[o]&i)<<n;for(o=a-1;o>=0;--o)t.data[o]=0;t.data[a]=s,t.t=this.t+a+1,t.s=this.s,t.clamp()}function Yp(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}var r=e%this.DB,i=this.DB-r,a=(1<<r)-1;t.data[0]=this.data[n]>>r;for(var s=n+1;s<this.t;++s)t.data[s-n-1]|=(this.data[s]&a)<<i,t.data[s-n]=this.data[s]>>r;r>0&&(t.data[this.t-n-1]|=(this.s&a)<<i),t.t=this.t-n,t.clamp()}function Xp(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);n<i;)r+=this.data[n]-e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t.data[n++]=this.DV+r:r>0&&(t.data[n++]=r),t.t=n,t.clamp()}function Jp(e,t){var n=this.abs(),r=e.abs(),i=n.t;for(t.t=i+r.t;--i>=0;)t.data[i]=0;for(i=0;i<r.t;++i)t.data[i+n.t]=n.am(0,r.data[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&O.ZERO.subTo(t,t)}function Zp(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e.data[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t.data[n],e,2*n,0,1);(e.data[n+t.t]+=t.am(n+1,2*t.data[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e.data[n+t.t]-=t.DV,e.data[n+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(n,t.data[n],e,2*n,0,1)),e.s=0,e.clamp()}function ey(e,t,n){var r=e.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t){t!=null&&t.fromInt(0),n!=null&&this.copyTo(n);return}n==null&&(n=ge());var a=ge(),s=this.s,o=e.s,u=this.DB-La(r.data[r.t-1]);u>0?(r.lShiftTo(u,a),i.lShiftTo(u,n)):(r.copyTo(a),i.copyTo(n));var c=a.t,l=a.data[c-1];if(l!=0){var f=l*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),d=this.FV/f,v=(1<<this.F1)/f,h=1<<this.F2,m=n.t,b=m-c,E=t??ge();for(a.dlShiftTo(b,E),n.compareTo(E)>=0&&(n.data[n.t++]=1,n.subTo(E,n)),O.ONE.dlShiftTo(c,E),E.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--b>=0;){var x=n.data[--m]==l?this.DM:Math.floor(n.data[m]*d+(n.data[m-1]+h)*v);if((n.data[m]+=a.am(0,x,n,b,0,c))<x)for(a.dlShiftTo(b,E),n.subTo(E,n);n.data[m]<--x;)n.subTo(E,n)}t!=null&&(n.drShiftTo(c,t),s!=o&&O.ZERO.subTo(t,t)),n.t=c,n.clamp(),u>0&&n.rShiftTo(u,n),s<0&&O.ZERO.subTo(n,n)}}}function ty(e){var t=ge();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(O.ZERO)>0&&e.subTo(t,t),t}function rn(e){this.m=e}function ry(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function ny(e){return e}function iy(e){e.divRemTo(this.m,null,e)}function ay(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function sy(e,t){e.squareTo(t),this.reduce(t)}rn.prototype.convert=ry;rn.prototype.revert=ny;rn.prototype.reduce=iy;rn.prototype.mulTo=ay;rn.prototype.sqrTo=sy;function oy(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function nn(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function uy(e){var t=ge();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(O.ZERO)>0&&this.m.subTo(t,t),t}function cy(e){var t=ge();return e.copyTo(t),this.reduce(t),t}function ly(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=e.data[t]&32767,r=n*this.mpl+((n*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e.data[n]+=this.m.am(0,r,e,t,0,this.m.t);e.data[n]>=e.DV;)e.data[n]-=e.DV,e.data[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function fy(e,t){e.squareTo(t),this.reduce(t)}function dy(e,t,n){e.multiplyTo(t,n),this.reduce(n)}nn.prototype.convert=uy;nn.prototype.revert=cy;nn.prototype.reduce=ly;nn.prototype.mulTo=dy;nn.prototype.sqrTo=fy;function hy(){return(this.t>0?this.data[0]&1:this.s)==0}function py(e,t){if(e>4294967295||e<1)return O.ONE;var n=ge(),r=ge(),i=t.convert(this),a=La(e)-1;for(i.copyTo(n);--a>=0;)if(t.sqrTo(n,r),(e&1<<a)>0)t.mulTo(r,i,n);else{var s=n;n=r,r=s}return t.revert(n)}function yy(e,t){var n;return e<256||t.isEven()?n=new rn(t):n=new nn(t),this.exp(e,n)}O.prototype.copyTo=Kp;O.prototype.fromInt=Fp;O.prototype.fromString=Mp;O.prototype.clamp=Vp;O.prototype.dlShiftTo=Wp;O.prototype.drShiftTo=zp;O.prototype.lShiftTo=Qp;O.prototype.rShiftTo=Yp;O.prototype.subTo=Xp;O.prototype.multiplyTo=Jp;O.prototype.squareTo=Zp;O.prototype.divRemTo=ey;O.prototype.invDigit=oy;O.prototype.isEven=hy;O.prototype.exp=py;O.prototype.toString=$p;O.prototype.negate=Hp;O.prototype.abs=jp;O.prototype.compareTo=qp;O.prototype.bitLength=Gp;O.prototype.mod=ty;O.prototype.modPowInt=yy;O.ZERO=xr(0);O.ONE=xr(1);function gy(){var e=ge();return this.copyTo(e),e}function vy(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function my(){return this.t==0?this.s:this.data[0]<<24>>24}function by(){return this.t==0?this.s:this.data[0]<<16>>16}function Sy(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Ey(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Cy(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),r=xr(n),i=ge(),a=ge(),s="";for(this.divRemTo(r,i,a);i.signum()>0;)s=(n+a.intValue()).toString(e).substr(1)+s,i.divRemTo(r,i,a);return a.intValue().toString(e)+s}function wy(e,t){this.fromInt(0),t==null&&(t=10);for(var n=this.chunkSize(t),r=Math.pow(t,n),i=!1,a=0,s=0,o=0;o<e.length;++o){var u=Il(e,o);if(u<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=t*s+u,++a>=n&&(this.dMultiply(r),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(t,a)),this.dAddOffset(s,0)),i&&O.ZERO.subTo(this,this)}function Ty(e,t,n){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(O.ONE.shiftLeft(e-1),Ko,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(O.ONE.shiftLeft(e-1),this);else{var r=new Array,i=e&7;r.length=(e>>3)+1,t.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}}function xy(){var e=this.t,t=new Array;t[0]=this.s;var n=this.DB-e*this.DB%8,r,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),r&128&&(r|=-256),i==0&&(this.s&128)!=(r&128)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t}function Ay(e){return this.compareTo(e)==0}function Iy(e){return this.compareTo(e)<0?this:e}function By(e){return this.compareTo(e)>0?this:e}function _y(e,t,n){var r,i,a=Math.min(e.t,this.t);for(r=0;r<a;++r)n.data[r]=t(this.data[r],e.data[r]);if(e.t<this.t){for(i=e.s&this.DM,r=a;r<this.t;++r)n.data[r]=t(this.data[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=a;r<e.t;++r)n.data[r]=t(i,e.data[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()}function ky(e,t){return e&t}function Ry(e){var t=ge();return this.bitwiseTo(e,ky,t),t}function Ko(e,t){return e|t}function Ny(e){var t=ge();return this.bitwiseTo(e,Ko,t),t}function Bl(e,t){return e^t}function Py(e){var t=ge();return this.bitwiseTo(e,Bl,t),t}function _l(e,t){return e&~t}function Ly(e){var t=ge();return this.bitwiseTo(e,_l,t),t}function Uy(){for(var e=ge(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Oy(e){var t=ge();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Dy(e){var t=ge();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Ky(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function Fy(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+Ky(this.data[e]);return this.s<0?this.t*this.DB:-1}function My(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Vy(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=My(this.data[n]^t);return e}function $y(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function Hy(e,t){var n=O.ONE.shiftLeft(e);return this.bitwiseTo(n,t,n),n}function jy(e){return this.changeBit(e,Ko)}function qy(e){return this.changeBit(e,_l)}function Gy(e){return this.changeBit(e,Bl)}function Wy(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);n<i;)r+=this.data[n]+e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t.data[n++]=r:r<-1&&(t.data[n++]=this.DV+r),t.t=n,t.clamp()}function zy(e){var t=ge();return this.addTo(e,t),t}function Qy(e){var t=ge();return this.subTo(e,t),t}function Yy(e){var t=ge();return this.multiplyTo(e,t),t}function Xy(e){var t=ge();return this.divRemTo(e,t,null),t}function Jy(e){var t=ge();return this.divRemTo(e,null,t),t}function Zy(e){var t=ge(),n=ge();return this.divRemTo(e,t,n),new Array(t,n)}function eg(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function tg(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Bi(){}function kl(e){return e}function rg(e,t,n){e.multiplyTo(t,n)}function ng(e,t){e.squareTo(t)}Bi.prototype.convert=kl;Bi.prototype.revert=kl;Bi.prototype.mulTo=rg;Bi.prototype.sqrTo=ng;function ig(e){return this.exp(e,new Bi)}function ag(e,t,n){var r=Math.min(this.t+e.t,t);for(n.s=0,n.t=r;r>0;)n.data[--r]=0;var i;for(i=n.t-this.t;r<i;++r)n.data[r+this.t]=this.am(0,e.data[r],n,r,0,this.t);for(i=Math.min(e.t,t);r<i;++r)this.am(0,e.data[r],n,r,0,t-r);n.clamp()}function sg(e,t,n){--t;var r=n.t=this.t+e.t-t;for(n.s=0;--r>=0;)n.data[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n.data[this.t+r-t]=this.am(t-r,e.data[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)}function Mn(e){this.r2=ge(),this.q3=ge(),O.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function og(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ge();return e.copyTo(t),this.reduce(t),t}function ug(e){return e}function cg(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function lg(e,t){e.squareTo(t),this.reduce(t)}function fg(e,t,n){e.multiplyTo(t,n),this.reduce(n)}Mn.prototype.convert=og;Mn.prototype.revert=ug;Mn.prototype.reduce=cg;Mn.prototype.mulTo=fg;Mn.prototype.sqrTo=lg;function dg(e,t){var n=e.bitLength(),r,i=xr(1),a;if(n<=0)return i;n<18?r=1:n<48?r=3:n<144?r=4:n<768?r=5:r=6,n<8?a=new rn(t):t.isEven()?a=new Mn(t):a=new nn(t);var s=new Array,o=3,u=r-1,c=(1<<r)-1;if(s[1]=a.convert(this),r>1){var l=ge();for(a.sqrTo(s[1],l);o<=c;)s[o]=ge(),a.mulTo(l,s[o-2],s[o]),o+=2}var f=e.t-1,d,v=!0,h=ge(),m;for(n=La(e.data[f])-1;f>=0;){for(n>=u?d=e.data[f]>>n-u&c:(d=(e.data[f]&(1<<n+1)-1)<<u-n,f>0&&(d|=e.data[f-1]>>this.DB+n-u)),o=r;!(d&1);)d>>=1,--o;if((n-=o)<0&&(n+=this.DB,--f),v)s[d].copyTo(i),v=!1;else{for(;o>1;)a.sqrTo(i,h),a.sqrTo(h,i),o-=2;o>0?a.sqrTo(i,h):(m=i,i=h,h=m),a.mulTo(h,s[d],i)}for(;f>=0&&!(e.data[f]&1<<n);)a.sqrTo(i,h),m=i,i=h,h=m,--n<0&&(n=this.DB-1,--f)}return a.revert(i)}function hg(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var i=t.getLowestSetBit(),a=n.getLowestSetBit();if(a<0)return t;for(i<a&&(a=i),a>0&&(t.rShiftTo(a,t),n.rShiftTo(a,n));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return a>0&&n.lShiftTo(a,n),n}function pg(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(t==0)n=this.data[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this.data[r])%e;return n}function yg(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return O.ZERO;for(var n=e.clone(),r=this.clone(),i=xr(1),a=xr(0),s=xr(0),o=xr(1);n.signum()!=0;){for(;n.isEven();)n.rShiftTo(1,n),t?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(e,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;r.isEven();)r.rShiftTo(1,r),t?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);n.compareTo(r)>=0?(n.subTo(r,n),t&&i.subTo(s,i),a.subTo(o,a)):(r.subTo(n,r),t&&s.subTo(i,s),o.subTo(a,o))}if(r.compareTo(O.ONE)!=0)return O.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var Kt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],gg=(1<<26)/Kt[Kt.length-1];function vg(e){var t,n=this.abs();if(n.t==1&&n.data[0]<=Kt[Kt.length-1]){for(t=0;t<Kt.length;++t)if(n.data[0]==Kt[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<Kt.length;){for(var r=Kt[t],i=t+1;i<Kt.length&&r<gg;)r*=Kt[i++];for(r=n.modInt(r);t<i;)if(r%Kt[t++]==0)return!1}return n.millerRabin(e)}function mg(e){var t=this.subtract(O.ONE),n=t.getLowestSetBit();if(n<=0)return!1;for(var r=t.shiftRight(n),i=bg(),a,s=0;s<e;++s){do a=new O(this.bitLength(),i);while(a.compareTo(O.ONE)<=0||a.compareTo(t)>=0);var o=a.modPow(r,this);if(o.compareTo(O.ONE)!=0&&o.compareTo(t)!=0){for(var u=1;u++<n&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(O.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function bg(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}O.prototype.chunkSize=Sy;O.prototype.toRadix=Cy;O.prototype.fromRadix=wy;O.prototype.fromNumber=Ty;O.prototype.bitwiseTo=_y;O.prototype.changeBit=Hy;O.prototype.addTo=Wy;O.prototype.dMultiply=eg;O.prototype.dAddOffset=tg;O.prototype.multiplyLowerTo=ag;O.prototype.multiplyUpperTo=sg;O.prototype.modInt=pg;O.prototype.millerRabin=mg;O.prototype.clone=gy;O.prototype.intValue=vy;O.prototype.byteValue=my;O.prototype.shortValue=by;O.prototype.signum=Ey;O.prototype.toByteArray=xy;O.prototype.equals=Ay;O.prototype.min=Iy;O.prototype.max=By;O.prototype.and=Ry;O.prototype.or=Ny;O.prototype.xor=Py;O.prototype.andNot=Ly;O.prototype.not=Uy;O.prototype.shiftLeft=Oy;O.prototype.shiftRight=Dy;O.prototype.getLowestSetBit=Fy;O.prototype.bitCount=Vy;O.prototype.testBit=$y;O.prototype.setBit=jy;O.prototype.clearBit=qy;O.prototype.flipBit=Gy;O.prototype.add=zy;O.prototype.subtract=Qy;O.prototype.multiply=Yy;O.prototype.divide=Xy;O.prototype.remainder=Jy;O.prototype.divideAndRemainder=Zy;O.prototype.modPow=dg;O.prototype.modInverse=yg;O.prototype.pow=ig;O.prototype.gcd=hg;O.prototype.isProbablePrime=vg;var Yt=se,Rl=Yt.sha1=Yt.sha1||{};Yt.md.sha1=Yt.md.algorithms.sha1=Rl;Rl.create=function(){Nl||Sg();var e=null,t=Yt.util.createBuffer(),n=new Array(80),r={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var i=r.messageLengthSize/4,a=0;a<i;++a)r.fullMessageLength.push(0);return t=Yt.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},r},r.start(),r.update=function(i,a){a==="utf8"&&(i=Yt.util.encodeUtf8(i));var s=i.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=s[1],s[1]=s[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),Qu(e,n,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var i=Yt.util.createBuffer();i.putBytes(t.bytes());var a=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=a&r.blockLength-1;i.putBytes(Gs.substr(0,r.blockLength-s));for(var o,u,c=r.fullMessageLength[0]*8,l=0;l<r.fullMessageLength.length-1;++l)o=r.fullMessageLength[l+1]*8,u=o/4294967296>>>0,c+=u,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};Qu(f,n,i);var d=Yt.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},r};var Gs=null,Nl=!1;function Sg(){Gs=String.fromCharCode(128),Gs+=Yt.util.fillString(String.fromCharCode(0),64),Nl=!0}function Qu(e,t,n){for(var r,i,a,s,o,u,c,l,f=n.length();f>=64;){for(i=e.h0,a=e.h1,s=e.h2,o=e.h3,u=e.h4,l=0;l<16;++l)r=n.getInt32(),t[l]=r,c=o^a&(s^o),r=(i<<5|i>>>27)+c+u+1518500249+r,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=r;for(;l<20;++l)r=t[l-3]^t[l-8]^t[l-14]^t[l-16],r=r<<1|r>>>31,t[l]=r,c=o^a&(s^o),r=(i<<5|i>>>27)+c+u+1518500249+r,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=r;for(;l<32;++l)r=t[l-3]^t[l-8]^t[l-14]^t[l-16],r=r<<1|r>>>31,t[l]=r,c=a^s^o,r=(i<<5|i>>>27)+c+u+1859775393+r,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=r;for(;l<40;++l)r=t[l-6]^t[l-16]^t[l-28]^t[l-32],r=r<<2|r>>>30,t[l]=r,c=a^s^o,r=(i<<5|i>>>27)+c+u+1859775393+r,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=r;for(;l<60;++l)r=t[l-6]^t[l-16]^t[l-28]^t[l-32],r=r<<2|r>>>30,t[l]=r,c=a&s|o&(a^s),r=(i<<5|i>>>27)+c+u+2400959708+r,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=r;for(;l<80;++l)r=t[l-6]^t[l-16]^t[l-28]^t[l-32],r=r<<2|r>>>30,t[l]=r,c=a^s^o,r=(i<<5|i>>>27)+c+u+3395469782+r,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=r;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,e.h4=e.h4+u|0,f-=64}}var Jt=se,Pl=Jt.pkcs1=Jt.pkcs1||{};Pl.encode_rsa_oaep=function(e,t,n){var r,i,a,s;typeof n=="string"?(r=n,i=arguments[3]||void 0,a=arguments[4]||void 0):n&&(r=n.label||void 0,i=n.seed||void 0,a=n.md||void 0,n.mgf1&&n.mgf1.md&&(s=n.mgf1.md)),a?a.start():a=Jt.md.sha1.create(),s||(s=a);var o=Math.ceil(e.n.bitLength()/8),u=o-2*a.digestLength-2;if(t.length>u){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=t.length,c.maxLength=u,c}r||(r=""),a.update(r,"raw");for(var l=a.digest(),f="",d=u-t.length,v=0;v<d;v++)f+="\0";var h=l.getBytes()+f+""+t;if(!i)i=Jt.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var m=la(i,o-a.digestLength-1,s),b=Jt.util.xorBytes(h,m,h.length),E=la(b,a.digestLength,s),x=Jt.util.xorBytes(i,E,i.length);return"\0"+x+b};Pl.decode_rsa_oaep=function(e,t,n){var r,i,a;typeof n=="string"?(r=n,i=arguments[3]||void 0):n&&(r=n.label||void 0,i=n.md||void 0,n.mgf1&&n.mgf1.md&&(a=n.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var b=new Error("RSAES-OAEP encoded message length is invalid.");throw b.length=t.length,b.expectedLength=s,b}if(i===void 0?i=Jt.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r||(r=""),i.update(r,"raw");for(var o=i.digest().getBytes(),u=t.charAt(0),c=t.substring(1,i.digestLength+1),l=t.substring(1+i.digestLength),f=la(l,i.digestLength,a),d=Jt.util.xorBytes(c,f,c.length),v=la(d,s-i.digestLength-1,a),h=Jt.util.xorBytes(l,v,l.length),m=h.substring(0,i.digestLength),b=u!=="\0",E=0;E<i.digestLength;++E)b|=o.charAt(E)!==m.charAt(E);for(var x=1,A=i.digestLength,B=i.digestLength;B<h.length;B++){var _=h.charCodeAt(B),L=_&1^1,W=x?65534:0;b|=_&W,x=x&L,A+=x}if(b||h.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return h.substring(A+1)};function la(e,t,n){n||(n=Jt.md.sha1.create());for(var r="",i=Math.ceil(t/n.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);n.start(),n.update(e+s),r+=n.digest().getBytes()}return r.substring(0,t)}var gr=se;(function(){if(gr.prime){gr.prime;return}var e=gr.prime=gr.prime||{},t=gr.jsbn.BigInteger,n=[6,4,2,4,2,4,6,2],r=new t(null);r.fromInt(30);var i=function(f,d){return f|d};e.generateProbablePrime=function(f,d,v){typeof d=="function"&&(v=d,d={}),d=d||{};var h=d.algorithm||"PRIMEINC";typeof h=="string"&&(h={name:h}),h.options=h.options||{};var m=d.prng||gr.random,b={nextBytes:function(E){for(var x=m.getBytesSync(E.length),A=0;A<E.length;++A)E[A]=x.charCodeAt(A)}};if(h.name==="PRIMEINC")return a(f,b,h.options,v);throw new Error("Invalid prime generation algorithm: "+h.name)};function a(f,d,v,h){return"workers"in v?u(f,d,v,h):s(f,d,v,h)}function s(f,d,v,h){var m=c(f,d),b=0,E=l(m.bitLength());"millerRabinTests"in v&&(E=v.millerRabinTests);var x=10;"maxBlockTime"in v&&(x=v.maxBlockTime),o(m,f,d,b,E,x,h)}function o(f,d,v,h,m,b,E){var x=+new Date;do{if(f.bitLength()>d&&(f=c(d,v)),f.isProbablePrime(m))return E(null,f);f.dAddOffset(n[h++%8],0)}while(b<0||+new Date-x<b);gr.util.setImmediate(function(){o(f,d,v,h,m,b,E)})}function u(f,d,v,h){if(typeof Worker>"u")return s(f,d,v,h);var m=c(f,d),b=v.workers,E=v.workLoad||100,x=E*30/8,A=v.workerScript||"forge/prime.worker.js";if(b===-1)return gr.util.estimateCores(function(_,L){_&&(L=2),b=L-1,B()});B();function B(){b=Math.max(1,b);for(var _=[],L=0;L<b;++L)_[L]=new Worker(A);for(var L=0;L<b;++L)_[L].addEventListener("message",te);var W=!1;function te(re){if(!W){var P=re.data;if(P.found){for(var T=0;T<_.length;++T)_[T].terminate();return W=!0,h(null,new t(P.prime,16))}m.bitLength()>f&&(m=c(f,d));var D=m.toString(16);re.target.postMessage({hex:D,workLoad:E}),m.dAddOffset(x,0)}}}}function c(f,d){var v=new t(f,d),h=f-1;return v.testBit(h)||v.bitwiseTo(t.ONE.shiftLeft(h),i,v),v.dAddOffset(31-v.mod(r).byteValue(),0),v}function l(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})();var X=se;if(typeof ye>"u")var ye=X.jsbn.BigInteger;var Ws=X.util.isNodejs?tn():null,I=X.asn1,It=X.util;X.pki=X.pki||{};X.pki.rsa=X.rsa=X.rsa||{};var ne=X.pki,Eg=[6,4,2,4,2,4,6,2],Cg={name:"PrivateKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},wg={name:"RSAPrivateKey",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Tg={name:"RSAPublicKey",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},xg=X.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:I.Class.UNIVERSAL,type:I.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Ag={name:"DigestInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:I.Class.UNIVERSAL,type:I.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Ig=function(e){var t;if(e.algorithm in ne.oids)t=ne.oids[e.algorithm];else{var n=new Error("Unknown message digest algorithm.");throw n.algorithm=e.algorithm,n}var r=I.oidToDer(t).getBytes(),i=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[]),a=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[]);a.value.push(I.create(I.Class.UNIVERSAL,I.Type.OID,!1,r)),a.value.push(I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,""));var s=I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(a),i.value.push(s),I.toDer(i).getBytes()},Ll=function(e,t,n){if(n)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(ye.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(ye.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var r;do r=new ye(X.util.bytesToHex(X.random.getBytes(t.n.bitLength()/8)),16);while(r.compareTo(t.n)>=0||!r.gcd(t.n).equals(ye.ONE));e=e.multiply(r.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(a)<0;)i=i.add(t.p);var s=i.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return s=s.multiply(r.modInverse(t.n)).mod(t.n),s};ne.rsa.encrypt=function(e,t,n){var r=n,i,a=Math.ceil(t.n.bitLength()/8);n!==!1&&n!==!0?(r=n===2,i=Ul(e,t,n)):(i=X.util.createBuffer(),i.putBytes(e));for(var s=new ye(i.toHex(),16),o=Ll(s,t,r),u=o.toString(16),c=X.util.createBuffer(),l=a-Math.ceil(u.length/2);l>0;)c.putByte(0),--l;return c.putBytes(X.util.hexToBytes(u)),c.getBytes()};ne.rsa.decrypt=function(e,t,n,r){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=i,a}var s=new ye(X.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Ll(s,t,n),u=o.toString(16),c=X.util.createBuffer(),l=i-Math.ceil(u.length/2);l>0;)c.putByte(0),--l;return c.putBytes(X.util.hexToBytes(u)),r!==!1?fa(c.getBytes(),t,n):c.getBytes()};ne.rsa.createKeyPairGenerationState=function(e,t,n){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,n=n||{};var r=n.prng||X.random,i={nextBytes:function(o){for(var u=r.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=u.charCodeAt(c)}},a=n.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:e,rng:i,eInt:t||65537,e:new ye(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};ne.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var n=new ye(null);n.fromInt(30);for(var r=0,i=function(f,d){return f|d},a=+new Date,s,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var u=e.p===null?e.pBits:e.qBits,c=u-1;e.pqState===0?(e.num=new ye(u,e.rng),e.num.testBit(c)||e.num.bitwiseTo(ye.ONE.shiftLeft(c),i,e.num),e.num.dAddOffset(31-e.num.mod(n).byteValue(),0),r=0,++e.pqState):e.pqState===1?e.num.bitLength()>u?e.pqState=0:e.num.isProbablePrime(_g(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Eg[r++%8],0):e.pqState===2?e.pqState=e.num.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(ye.ONE),e.q1=e.q.subtract(ye.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(ye.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var l=e.e.modInverse(e.phi);e.keys={privateKey:ne.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:ne.rsa.setPublicKey(e.n,e.e)}}s=+new Date,o+=s-a,a=s}return e.keys!==null};ne.rsa.generateKeyPair=function(e,t,n,r){if(arguments.length===1?typeof e=="object"?(n=e,e=void 0):typeof e=="function"&&(r=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(r=t,t=void 0):typeof t!="number"&&(n=t,t=void 0):(n=e,r=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof n=="function"&&(r=n,n=void 0):(r=n,n=t,t=void 0)),n=n||{},e===void 0&&(e=n.bits||2048),t===void 0&&(t=n.e||65537),!X.options.usePureJavaScript&&!n.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(r){if(Yu("generateKeyPair"))return Ws.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,u,c){if(o)return r(o);r(null,{privateKey:ne.privateKeyFromPem(c),publicKey:ne.publicKeyFromPem(u)})});if(Xu("generateKey")&&Xu("exportKey"))return It.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Zu(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return It.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){r(o)}).then(function(o){if(o){var u=ne.privateKeyFromAsn1(I.fromDer(X.util.createBuffer(o)));r(null,{privateKey:u,publicKey:ne.setRsaPublicKey(u.n,u.e)})}});if(Ju("generateKey")&&Ju("exportKey")){var i=It.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Zu(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var u=o.target.result,c=It.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);c.oncomplete=function(l){var f=l.target.result,d=ne.privateKeyFromAsn1(I.fromDer(X.util.createBuffer(f)));r(null,{privateKey:d,publicKey:ne.setRsaPublicKey(d.n,d.e)})},c.onerror=function(l){r(l)}},i.onerror=function(o){r(o)};return}}else if(Yu("generateKeyPairSync")){var a=Ws.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ne.privateKeyFromPem(a.privateKey),publicKey:ne.publicKeyFromPem(a.publicKey)}}}var s=ne.rsa.createKeyPairGenerationState(e,t,n);if(!r)return ne.rsa.stepKeyPairGenerationState(s,0),s.keys;Bg(s,n,r)};ne.setRsaPublicKey=ne.rsa.setPublicKey=function(e,t){var n={n:e,e:t};return n.encrypt=function(r,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,u,c){return Ul(o,u,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,u){return X.pkcs1.encode_rsa_oaep(u,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(r,n,!0);return ne.rsa.encrypt(s,n,!0)},n.verify=function(r,i,a,s){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(u,c){c=fa(c,n,!0);var l=I.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),f={},d=[];if(!I.validate(l,Ag,f,d)){var v=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw v.errors=d,v}var h=I.derToOid(f.algorithmIdentifier);if(!(h===X.oids.md2||h===X.oids.md5||h===X.oids.sha1||h===X.oids.sha224||h===X.oids.sha256||h===X.oids.sha384||h===X.oids.sha512||h===X.oids["sha512-224"]||h===X.oids["sha512-256"])){var v=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw v.oid=h,v}if((h===X.oids.md2||h===X.oids.md5)&&!("parameters"in f))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return u===f.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(u,c){return c=fa(c,n,!0),u===c}});var o=ne.rsa.decrypt(i,n,!0,!1);return a.verify(r,o,n.n.bitLength())},n};ne.setRsaPrivateKey=ne.rsa.setPrivateKey=function(e,t,n,r,i,a,s,o){var u={n:e,e:t,d:n,p:r,q:i,dP:a,dQ:s,qInv:o};return u.decrypt=function(c,l,f){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var d=ne.rsa.decrypt(c,u,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:fa};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(v,h){return X.pkcs1.decode_rsa_oaep(h,v,f)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(v){return v}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(d,u,!1)},u.sign=function(c,l){var f=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:Ig},f=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return c}},f=1);var d=l.encode(c,u.n.bitLength());return ne.rsa.encrypt(d,u,f)},u};ne.wrapRsaPrivateKey=function(e){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(0).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(ne.oids.rsaEncryption).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(e).getBytes())])};ne.privateKeyFromAsn1=function(e){var t={},n=[];if(I.validate(e,Cg,t,n)&&(e=I.fromDer(X.util.createBuffer(t.privateKey))),t={},n=[],!I.validate(e,wg,t,n)){var r=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw r.errors=n,r}var i,a,s,o,u,c,l,f;return i=X.util.createBuffer(t.privateKeyModulus).toHex(),a=X.util.createBuffer(t.privateKeyPublicExponent).toHex(),s=X.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=X.util.createBuffer(t.privateKeyPrime1).toHex(),u=X.util.createBuffer(t.privateKeyPrime2).toHex(),c=X.util.createBuffer(t.privateKeyExponent1).toHex(),l=X.util.createBuffer(t.privateKeyExponent2).toHex(),f=X.util.createBuffer(t.privateKeyCoefficient).toHex(),ne.setRsaPrivateKey(new ye(i,16),new ye(a,16),new ye(s,16),new ye(o,16),new ye(u,16),new ye(c,16),new ye(l,16),new ye(f,16))};ne.privateKeyToAsn1=ne.privateKeyToRSAPrivateKey=function(e){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(0).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.n)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.e)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.d)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.p)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.q)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.dP)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.dQ)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.qInv))])};ne.publicKeyFromAsn1=function(e){var t={},n=[];if(I.validate(e,xg,t,n)){var r=I.derToOid(t.publicKeyOid);if(r!==ne.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=r,i}e=t.rsaPublicKey}if(n=[],!I.validate(e,Tg,t,n)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=n,i}var a=X.util.createBuffer(t.publicKeyModulus).toHex(),s=X.util.createBuffer(t.publicKeyExponent).toHex();return ne.setRsaPublicKey(new ye(a,16),new ye(s,16))};ne.publicKeyToAsn1=ne.publicKeyToSubjectPublicKeyInfo=function(e){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(ne.oids.rsaEncryption).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.BITSTRING,!1,[ne.publicKeyToRSAPublicKey(e)])])};ne.publicKeyToRSAPublicKey=function(e){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.n)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,Vt(e.e))])};function Ul(e,t,n){var r=X.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=e.length,a.max=i-11,a}r.putByte(0),r.putByte(n);var s=i-3-e.length,o;if(n===0||n===1){o=n===0?0:255;for(var u=0;u<s;++u)r.putByte(o)}else for(;s>0;){for(var c=0,l=X.random.getBytes(s),u=0;u<s;++u)o=l.charCodeAt(u),o===0?++c:r.putByte(o);s=c}return r.putByte(0),r.putBytes(e),r}function fa(e,t,n,r){var i=Math.ceil(t.n.bitLength()/8),a=X.util.createBuffer(e),s=a.getByte(),o=a.getByte();if(s!==0||n&&o!==0&&o!==1||!n&&o!=2||n&&o===0&&typeof r>"u")throw new Error("Encryption block is invalid.");var u=0;if(o===0){u=i-3-r;for(var c=0;c<u;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(u=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++u}else if(o===2)for(u=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++u}var l=a.getByte();if(l!==0||u!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function Bg(e,t,n){typeof t=="function"&&(n=t,t={}),t=t||{};var r={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(r.prng=t.prng),i();function i(){a(e.pBits,function(o,u){if(o)return n(o);if(e.p=u,e.q!==null)return s(o,e.q);a(e.qBits,s)})}function a(o,u){X.prime.generateProbablePrime(o,r,u)}function s(o,u){if(o)return n(o);if(e.q=u,e.p.compareTo(e.q)<0){var c=e.p;e.p=e.q,e.q=c}if(e.p.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)!==0){e.p=null,i();return}if(e.q.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)!==0){e.q=null,a(e.qBits,s);return}if(e.p1=e.p.subtract(ye.ONE),e.q1=e.q.subtract(ye.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(ye.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,a(e.qBits,s);return}var l=e.e.modInverse(e.phi);e.keys={privateKey:ne.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:ne.rsa.setPublicKey(e.n,e.e)},n(null,e.keys)}}function Vt(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var n=X.util.hexToBytes(t);return n.length>1&&(n.charCodeAt(0)===0&&!(n.charCodeAt(1)&128)||n.charCodeAt(0)===255&&(n.charCodeAt(1)&128)===128)?n.substr(1):n}function _g(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function Yu(e){return X.util.isNodejs&&typeof Ws[e]=="function"}function Xu(e){return typeof It.globalScope<"u"&&typeof It.globalScope.crypto=="object"&&typeof It.globalScope.crypto.subtle=="object"&&typeof It.globalScope.crypto.subtle[e]=="function"}function Ju(e){return typeof It.globalScope<"u"&&typeof It.globalScope.msCrypto=="object"&&typeof It.globalScope.msCrypto.subtle=="object"&&typeof It.globalScope.msCrypto.subtle[e]=="function"}function Zu(e){for(var t=X.util.hexToBytes(e.toString(16)),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}var j=se;if(typeof kg>"u")var kg=j.jsbn.BigInteger;var k=j.asn1,ae=j.pki=j.pki||{};ae.pbe=j.pbe=j.pbe||{};var Mr=ae.oids,Rg={name:"EncryptedPrivateKeyInfo",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Ng={name:"PBES2Algorithms",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Pg={name:"pkcs-12PbeParams",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"iterations"}]};ae.encryptPrivateKeyInfo=function(e,t,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||"aes128",n.prfAlgorithm=n.prfAlgorithm||"sha1";var r=j.random.getBytesSync(n.saltSize),i=n.count,a=k.integerToDer(i),s,o,u;if(n.algorithm.indexOf("aes")===0||n.algorithm==="des"){var c,l,f;switch(n.algorithm){case"aes128":s=16,c=16,l=Mr["aes128-CBC"],f=j.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,l=Mr["aes192-CBC"],f=j.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,l=Mr["aes256-CBC"],f=j.aes.createEncryptionCipher;break;case"des":s=8,c=8,l=Mr.desCBC,f=j.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=n.algorithm,d}var v="hmacWith"+n.prfAlgorithm.toUpperCase(),h=Dl(v),m=j.pkcs5.pbkdf2(t,r,i,s,h),b=j.random.getBytesSync(c),E=f(m);E.start(b),E.update(k.toDer(e)),E.finish(),u=E.output.getBytes();var x=Lg(r,a,s,v);o=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(Mr.pkcs5PBES2).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(Mr.pkcs5PBKDF2).getBytes()),x]),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,b)])])])}else if(n.algorithm==="3des"){s=24;var A=new j.util.ByteBuffer(r),m=ae.pbe.generatePkcs12Key(t,A,1,i,s),b=ae.pbe.generatePkcs12Key(t,A,2,i,s),E=j.des.createEncryptionCipher(m);E.start(b),E.update(k.toDer(e)),E.finish(),u=E.output.getBytes(),o=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(Mr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,r),k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,a.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=n.algorithm,d}var B=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[o,k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,u)]);return B};ae.decryptPrivateKeyInfo=function(e,t){var n=null,r={},i=[];if(!k.validate(e,Rg,r,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=k.derToOid(r.encryptionOid),o=ae.pbe.getCipher(s,r.encryptionParams,t),u=j.util.createBuffer(r.encryptedData);return o.update(u),o.finish()&&(n=k.fromDer(o.output)),n};ae.encryptedPrivateKeyToPem=function(e,t){var n={type:"ENCRYPTED PRIVATE KEY",body:k.toDer(e).getBytes()};return j.pem.encode(n,{maxline:t})};ae.encryptedPrivateKeyFromPem=function(e){var t=j.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var n=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw n.headerType=t.type,n}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return k.fromDer(t.body)};ae.encryptRsaPrivateKey=function(e,t,n){if(n=n||{},!n.legacy){var r=ae.wrapRsaPrivateKey(ae.privateKeyToAsn1(e));return r=ae.encryptPrivateKeyInfo(r,t,n),ae.encryptedPrivateKeyToPem(r)}var i,a,s,o;switch(n.algorithm){case"aes128":i="AES-128-CBC",s=16,a=j.random.getBytesSync(16),o=j.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=j.random.getBytesSync(16),o=j.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=j.random.getBytesSync(16),o=j.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=j.random.getBytesSync(8),o=j.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=j.random.getBytesSync(8),o=j.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+n.algorithm+'".');throw u.algorithm=n.algorithm,u}var c=j.pbe.opensslDeriveBytes(t,a.substr(0,8),s),l=o(c);l.start(a),l.update(k.toDer(ae.privateKeyToAsn1(e))),l.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:j.util.bytesToHex(a).toUpperCase()},body:l.output.getBytes()};return j.pem.encode(f)};ae.decryptRsaPrivateKey=function(e,t){var n=null,r=j.pem.decode(e)[0];if(r.type!=="ENCRYPTED PRIVATE KEY"&&r.type!=="PRIVATE KEY"&&r.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(r.procType&&r.procType.type==="ENCRYPTED"){var a,s;switch(r.dekInfo.algorithm){case"DES-CBC":a=8,s=j.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=j.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=j.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=j.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=j.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(f){return j.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":a=8,s=function(f){return j.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":a=16,s=function(f){return j.rc2.createDecryptionCipher(f,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+r.dekInfo.algorithm+'".');throw i.algorithm=r.dekInfo.algorithm,i}var o=j.util.hexToBytes(r.dekInfo.parameters),u=j.pbe.opensslDeriveBytes(t,o.substr(0,8),a),c=s(u);if(c.start(o),c.update(j.util.createBuffer(r.body)),c.finish())n=c.output.getBytes();else return n}else n=r.body;return r.type==="ENCRYPTED PRIVATE KEY"?n=ae.decryptPrivateKeyInfo(k.fromDer(n),t):n=k.fromDer(n),n!==null&&(n=ae.privateKeyFromAsn1(n)),n};ae.pbe.generatePkcs12Key=function(e,t,n,r,i,a){var s,o;if(typeof a>"u"||a===null){if(!("sha1"in j.md))throw new Error('"sha1" hash algorithm unavailable.');a=j.md.sha1.create()}var u=a.digestLength,c=a.blockLength,l=new j.util.ByteBuffer,f=new j.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)f.putInt16(e.charCodeAt(o));f.putInt16(0)}var d=f.length(),v=t.length(),h=new j.util.ByteBuffer;h.fillWithByte(n,c);var m=c*Math.ceil(v/c),b=new j.util.ByteBuffer;for(o=0;o<m;o++)b.putByte(t.at(o%v));var E=c*Math.ceil(d/c),x=new j.util.ByteBuffer;for(o=0;o<E;o++)x.putByte(f.at(o%d));var A=b;A.putBuffer(x);for(var B=Math.ceil(i/u),_=1;_<=B;_++){var L=new j.util.ByteBuffer;L.putBytes(h.bytes()),L.putBytes(A.bytes());for(var W=0;W<r;W++)a.start(),a.update(L.getBytes()),L=a.digest();var te=new j.util.ByteBuffer;for(o=0;o<c;o++)te.putByte(L.at(o%u));var re=Math.ceil(v/c)+Math.ceil(d/c),P=new j.util.ByteBuffer;for(s=0;s<re;s++){var T=new j.util.ByteBuffer(A.getBytes(c)),D=511;for(o=te.length()-1;o>=0;o--)D=D>>8,D+=te.at(o)+T.at(o),T.setAt(o,D&255);P.putBuffer(T)}A=P,l.putBuffer(L)}return l.truncate(l.length()-i),l};ae.pbe.getCipher=function(e,t,n){switch(e){case ae.oids.pkcs5PBES2:return ae.pbe.getCipherForPBES2(e,t,n);case ae.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ae.oids["pbewithSHAAnd40BitRC2-CBC"]:return ae.pbe.getCipherForPKCS12PBE(e,t,n);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=e,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}};ae.pbe.getCipherForPBES2=function(e,t,n){var r={},i=[];if(!k.validate(t,Ng,r,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(e=k.derToOid(r.kdfOid),e!==ae.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=e,a.supportedOids=["pkcs5PBKDF2"],a}if(e=k.derToOid(r.encOid),e!==ae.oids["aes128-CBC"]&&e!==ae.oids["aes192-CBC"]&&e!==ae.oids["aes256-CBC"]&&e!==ae.oids["des-EDE3-CBC"]&&e!==ae.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=e,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=r.kdfSalt,o=j.util.createBuffer(r.kdfIterationCount);o=o.getInt(o.length()<<3);var u,c;switch(ae.oids[e]){case"aes128-CBC":u=16,c=j.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,c=j.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,c=j.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,c=j.des.createDecryptionCipher;break;case"desCBC":u=8,c=j.des.createDecryptionCipher;break}var l=Ol(r.prfOid),f=j.pkcs5.pbkdf2(n,s,o,u,l),d=r.encIv,v=c(f);return v.start(d),v};ae.pbe.getCipherForPKCS12PBE=function(e,t,n){var r={},i=[];if(!k.validate(t,Pg,r,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=j.util.createBuffer(r.salt),o=j.util.createBuffer(r.iterations);o=o.getInt(o.length()<<3);var u,c,l;switch(e){case ae.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,c=8,l=j.des.startDecrypting;break;case ae.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,c=8,l=function(m,b){var E=j.rc2.createDecryptionCipher(m,40);return E.start(b,null),E};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=e,a}var f=Ol(r.prfOid),d=ae.pbe.generatePkcs12Key(n,s,1,o,u,f);f.start();var v=ae.pbe.generatePkcs12Key(n,s,2,o,c,f);return l(d,v)};ae.pbe.opensslDeriveBytes=function(e,t,n,r){if(typeof r>"u"||r===null){if(!("md5"in j.md))throw new Error('"md5" hash algorithm unavailable.');r=j.md.md5.create()}t===null&&(t="");for(var i=[ec(r,e+t)],a=16,s=1;a<n;++s,a+=16)i.push(ec(r,i[s-1]+e+t));return i.join("").substr(0,n)};function ec(e,t){return e.start().update(t).digest().getBytes()}function Ol(e){var t;if(!e)t="hmacWithSHA1";else if(t=ae.oids[k.derToOid(e)],!t){var n=new Error("Unsupported PRF OID.");throw n.oid=e,n.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],n}return Dl(t)}function Dl(e){var t=j.md;switch(e){case"hmacWithSHA224":t=j.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var n=new Error("Unsupported PRF algorithm.");throw n.algorithm=e,n.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],n}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Lg(e,t,n,r){var i=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,e),k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,t.getBytes())]);return r!=="hmacWithSHA1"&&i.value.push(k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,j.util.hexToBytes(n.toString(16))),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(ae.oids[r]).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.NULL,!1,"")])),i}var Sn=se,H=Sn.asn1,Vn=Sn.pkcs7asn1=Sn.pkcs7asn1||{};Sn.pkcs7=Sn.pkcs7||{};Sn.pkcs7.asn1=Vn;var Kl={name:"ContentInfo",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:H.Class.UNIVERSAL,type:H.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:H.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};Vn.contentInfoValidator=Kl;var Fl={name:"EncryptedContentInfo",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:H.Class.UNIVERSAL,type:H.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:H.Class.UNIVERSAL,type:H.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:H.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:H.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};Vn.envelopedDataValidator={name:"EnvelopedData",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:H.Class.UNIVERSAL,type:H.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:H.Class.UNIVERSAL,type:H.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(Fl)};Vn.encryptedDataValidator={name:"EncryptedData",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:H.Class.UNIVERSAL,type:H.Type.INTEGER,constructed:!1,capture:"version"}].concat(Fl)};var Ug={name:"SignerInfo",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:H.Class.UNIVERSAL,type:H.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:H.Class.UNIVERSAL,type:H.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:H.Class.UNIVERSAL,type:H.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:H.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:H.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:H.Class.UNIVERSAL,type:H.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:H.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};Vn.signedDataValidator={name:"SignedData",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:H.Class.UNIVERSAL,type:H.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:H.Class.UNIVERSAL,type:H.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Kl,{name:"SignedData.Certificates",tagClass:H.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:H.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:H.Class.UNIVERSAL,type:H.Type.SET,capture:"signerInfos",optional:!0,value:[Ug]}]};Vn.recipientInfoValidator={name:"RecipientInfo",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:H.Class.UNIVERSAL,type:H.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:H.Class.UNIVERSAL,type:H.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:H.Class.UNIVERSAL,type:H.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:H.Class.UNIVERSAL,type:H.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:H.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:H.Class.UNIVERSAL,type:H.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};var Jr=se;Jr.mgf=Jr.mgf||{};var Og=Jr.mgf.mgf1=Jr.mgf1=Jr.mgf1||{};Og.create=function(e){var t={generate:function(n,r){for(var i=new Jr.util.ByteBuffer,a=Math.ceil(r/e.digestLength),s=0;s<a;s++){var o=new Jr.util.ByteBuffer;o.putInt32(s),e.start(),e.update(n+o.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-r),i.getBytes()}};return t};var da=se;da.mgf=da.mgf||{};da.mgf.mgf1=da.mgf1;var Gr=se,Dg=Gr.pss=Gr.pss||{};Dg.create=function(e){arguments.length===3&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t=e.md,n=e.mgf,r=t.digestLength,i=e.salt||null;typeof i=="string"&&(i=Gr.util.createBuffer(i));var a;if("saltLength"in e)a=e.saltLength;else if(i!==null)a=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==a)throw new Error("Given salt length does not match length of given salt.");var s=e.prng||Gr.random,o={};return o.encode=function(u,c){var l,f=c-1,d=Math.ceil(f/8),v=u.digest().getBytes();if(d<r+a+2)throw new Error("Message is too long to encrypt.");var h;i===null?h=s.getBytesSync(a):h=i.bytes();var m=new Gr.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(v),m.putBytes(h),t.start(),t.update(m.getBytes());var b=t.digest().getBytes(),E=new Gr.util.ByteBuffer;E.fillWithByte(0,d-a-r-2),E.putByte(1),E.putBytes(h);var x=E.getBytes(),A=d-r-1,B=n.generate(b,A),_="";for(l=0;l<A;l++)_+=String.fromCharCode(x.charCodeAt(l)^B.charCodeAt(l));var L=65280>>8*d-f&255;return _=String.fromCharCode(_.charCodeAt(0)&~L)+_.substr(1),_+b+String.fromCharCode(188)},o.verify=function(u,c,l){var f,d=l-1,v=Math.ceil(d/8);if(c=c.substr(-v),v<r+a+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(c.charCodeAt(v-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var h=v-r-1,m=c.substr(0,h),b=c.substr(h,r),E=65280>>8*v-d&255;if(m.charCodeAt(0)&E)throw new Error("Bits beyond keysize not zero as expected.");var x=n.generate(b,h),A="";for(f=0;f<h;f++)A+=String.fromCharCode(m.charCodeAt(f)^x.charCodeAt(f));A=String.fromCharCode(A.charCodeAt(0)&~E)+A.substr(1);var B=v-r-a-2;for(f=0;f<B;f++)if(A.charCodeAt(f)!==0)throw new Error("Leftmost octets not zero as expected");if(A.charCodeAt(B)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var _=A.substr(-a),L=new Gr.util.ByteBuffer;L.fillWithByte(0,8),L.putBytes(u),L.putBytes(_),t.start(),t.update(L.getBytes());var W=t.digest().getBytes();return b===W},o};var J=se,p=J.asn1,F=J.pki=J.pki||{},pe=F.oids,Be={};Be.CN=pe.commonName;Be.commonName="CN";Be.C=pe.countryName;Be.countryName="C";Be.L=pe.localityName;Be.localityName="L";Be.ST=pe.stateOrProvinceName;Be.stateOrProvinceName="ST";Be.O=pe.organizationName;Be.organizationName="O";Be.OU=pe.organizationalUnitName;Be.organizationalUnitName="OU";Be.E=pe.emailAddress;Be.emailAddress="E";var Ml=J.pki.rsa.publicKeyValidator,Kg={name:"Certificate",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:p.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:p.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:p.Class.UNIVERSAL,type:p.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:p.Class.UNIVERSAL,type:p.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:p.Class.UNIVERSAL,type:p.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:p.Class.UNIVERSAL,type:p.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Ml,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:p.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:p.Class.UNIVERSAL,type:p.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:p.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:p.Class.UNIVERSAL,type:p.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:p.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:p.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:p.Class.UNIVERSAL,type:p.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},Fg={name:"rsapss",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:p.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:p.Class.UNIVERSAL,type:p.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:p.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:p.Class.UNIVERSAL,type:p.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:p.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:p.Class.UNIVERSAL,type:p.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:p.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:p.Class.UNIVERSAL,type:p.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Mg={name:"CertificationRequestInfo",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Ml,{name:"CertificationRequestInfo.attributes",tagClass:p.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:p.Class.UNIVERSAL,type:p.Type.SET,constructed:!0}]}]}]},Vg={name:"CertificationRequest",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Mg,{name:"CertificationRequest.signatureAlgorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:p.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:p.Class.UNIVERSAL,type:p.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};F.RDNAttributesAsArray=function(e,t){for(var n=[],r,i,a,s=0;s<e.value.length;++s){r=e.value[s];for(var o=0;o<r.value.length;++o)a={},i=r.value[o],a.type=p.derToOid(i.value[0].value),a.value=i.value[1].value,a.valueTagClass=i.value[1].type,a.type in pe&&(a.name=pe[a.type],a.name in Be&&(a.shortName=Be[a.name])),t&&(t.update(a.type),t.update(a.value)),n.push(a)}return n};F.CRIAttributesAsArray=function(e){for(var t=[],n=0;n<e.length;++n)for(var r=e[n],i=p.derToOid(r.value[0].value),a=r.value[1].value,s=0;s<a.length;++s){var o={};if(o.type=i,o.value=a[s].value,o.valueTagClass=a[s].type,o.type in pe&&(o.name=pe[o.type],o.name in Be&&(o.shortName=Be[o.name])),o.type===pe.extensionRequest){o.extensions=[];for(var u=0;u<o.value.length;++u)o.extensions.push(F.certificateExtensionFromAsn1(o.value[u]))}t.push(o)}return t};function Ur(e,t){typeof t=="string"&&(t={shortName:t});for(var n=null,r,i=0;n===null&&i<e.attributes.length;++i)r=e.attributes[i],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(n=r);return n}var ha=function(e,t,n){var r={};if(e!==pe["RSASSA-PSS"])return r;n&&(r={hash:{algorithmOid:pe.sha1},mgf:{algorithmOid:pe.mgf1,hash:{algorithmOid:pe.sha1}},saltLength:20});var i={},a=[];if(!p.validate(t,Fg,i,a)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=a,s}return i.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=p.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=p.derToOid(i.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=p.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(r.saltLength=i.saltLength.charCodeAt(0)),r},Ua=function(e){switch(pe[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return J.md.sha1.create();case"md5WithRSAEncryption":return J.md.md5.create();case"sha256WithRSAEncryption":return J.md.sha256.create();case"sha384WithRSAEncryption":return J.md.sha384.create();case"sha512WithRSAEncryption":return J.md.sha512.create();case"RSASSA-PSS":return J.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},Vl=function(e){var t=e.certificate,n;switch(t.signatureOid){case pe.sha1WithRSAEncryption:case pe.sha1WithRSASignature:break;case pe["RSASSA-PSS"]:var r,i;if(r=pe[t.signatureParameters.mgf.hash.algorithmOid],r===void 0||J.md[r]===void 0){var a=new Error("Unsupported MGF hash function.");throw a.oid=t.signatureParameters.mgf.hash.algorithmOid,a.name=r,a}if(i=pe[t.signatureParameters.mgf.algorithmOid],i===void 0||J.mgf[i]===void 0){var a=new Error("Unsupported MGF function.");throw a.oid=t.signatureParameters.mgf.algorithmOid,a.name=i,a}if(i=J.mgf[i].create(J.md[r].create()),r=pe[t.signatureParameters.hash.algorithmOid],r===void 0||J.md[r]===void 0){var a=new Error("Unsupported RSASSA-PSS hash function.");throw a.oid=t.signatureParameters.hash.algorithmOid,a.name=r,a}n=J.pss.create(J.md[r].create(),i,t.signatureParameters.saltLength);break}return t.publicKey.verify(e.md.digest().getBytes(),e.signature,n)};F.certificateFromPem=function(e,t,n){var r=J.pem.decode(e)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=r.type,i}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var a=p.fromDer(r.body,n);return F.certificateFromAsn1(a,t)};F.certificateToPem=function(e,t){var n={type:"CERTIFICATE",body:p.toDer(F.certificateToAsn1(e)).getBytes()};return J.pem.encode(n,{maxline:t})};F.publicKeyFromPem=function(e){var t=J.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var n=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw n.headerType=t.type,n}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=p.fromDer(t.body);return F.publicKeyFromAsn1(r)};F.publicKeyToPem=function(e,t){var n={type:"PUBLIC KEY",body:p.toDer(F.publicKeyToAsn1(e)).getBytes()};return J.pem.encode(n,{maxline:t})};F.publicKeyToRSAPublicKeyPem=function(e,t){var n={type:"RSA PUBLIC KEY",body:p.toDer(F.publicKeyToRSAPublicKey(e)).getBytes()};return J.pem.encode(n,{maxline:t})};F.getPublicKeyFingerprint=function(e,t){t=t||{};var n=t.md||J.md.sha1.create(),r=t.type||"RSAPublicKey",i;switch(r){case"RSAPublicKey":i=p.toDer(F.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":i=p.toDer(F.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}n.start(),n.update(i);var a=n.digest();if(t.encoding==="hex"){var s=a.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return a};F.certificationRequestFromPem=function(e,t,n){var r=J.pem.decode(e)[0];if(r.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=r.type,i}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var a=p.fromDer(r.body,n);return F.certificationRequestFromAsn1(a,t)};F.certificationRequestToPem=function(e,t){var n={type:"CERTIFICATE REQUEST",body:p.toDer(F.certificationRequestToAsn1(e)).getBytes()};return J.pem.encode(n,{maxline:t})};F.createCertificate=function(){var e={};return e.version=2,e.serialNumber="00",e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return Ur(e.issuer,t)},e.issuer.addField=function(t){Bt([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return Ur(e.subject,t)},e.subject.addField=function(t){Bt([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,n){Bt(t),e.subject.attributes=t,delete e.subject.uniqueId,n&&(e.subject.uniqueId=n),e.subject.hash=null},e.setIssuer=function(t,n){Bt(t),e.issuer.attributes=t,delete e.issuer.uniqueId,n&&(e.issuer.uniqueId=n),e.issuer.hash=null},e.setExtensions=function(t){for(var n=0;n<t.length;++n)$l(t[n],{cert:e});e.extensions=t},e.getExtension=function(t){typeof t=="string"&&(t={name:t});for(var n=null,r,i=0;n===null&&i<e.extensions.length;++i)r=e.extensions[i],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(n=r);return n},e.sign=function(t,n){e.md=n||J.md.sha1.create();var r=pe[e.md.algorithm+"WithRSAEncryption"];if(!r){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=e.md.algorithm,i}e.signatureOid=e.siginfo.algorithmOid=r,e.tbsCertificate=F.getTBSCertificate(e);var a=p.toDer(e.tbsCertificate);e.md.update(a.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var n=!1;if(!e.issued(t)){var r=t.issuer,i=e.subject,a=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw a.expectedIssuer=i.attributes,a.actualIssuer=r.attributes,a}var s=t.md;if(s===null){s=Ua({signatureOid:t.signatureOid,type:"certificate"});var o=t.tbsCertificate||F.getTBSCertificate(t),u=p.toDer(o);s.update(u.getBytes())}return s!==null&&(n=Vl({certificate:e,md:s,signature:t.signature})),n},e.isIssuer=function(t){var n=!1,r=e.issuer,i=t.subject;if(r.hash&&i.hash)n=r.hash===i.hash;else if(r.attributes.length===i.attributes.length){n=!0;for(var a,s,o=0;n&&o<r.attributes.length;++o)a=r.attributes[o],s=i.attributes[o],(a.type!==s.type||a.value!==s.value)&&(n=!1)}return n},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return F.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=pe.subjectKeyIdentifier,n=0;n<e.extensions.length;++n){var r=e.extensions[n];if(r.id===t){var i=e.generateSubjectKeyIdentifier().getBytes();return J.util.hexToBytes(r.subjectKeyIdentifier)===i}}return!1},e};F.certificateFromAsn1=function(e,t){var n={},r=[];if(!p.validate(e,Kg,n,r)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=r,i}var a=p.derToOid(n.publicKeyOid);if(a!==F.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=F.createCertificate();s.version=n.certVersion?n.certVersion.charCodeAt(0):0;var o=J.util.createBuffer(n.certSerialNumber);s.serialNumber=o.toHex(),s.signatureOid=J.asn1.derToOid(n.certSignatureOid),s.signatureParameters=ha(s.signatureOid,n.certSignatureParams,!0),s.siginfo.algorithmOid=J.asn1.derToOid(n.certinfoSignatureOid),s.siginfo.parameters=ha(s.siginfo.algorithmOid,n.certinfoSignatureParams,!1),s.signature=n.certSignature;var u=[];if(n.certValidity1UTCTime!==void 0&&u.push(p.utcTimeToDate(n.certValidity1UTCTime)),n.certValidity2GeneralizedTime!==void 0&&u.push(p.generalizedTimeToDate(n.certValidity2GeneralizedTime)),n.certValidity3UTCTime!==void 0&&u.push(p.utcTimeToDate(n.certValidity3UTCTime)),n.certValidity4GeneralizedTime!==void 0&&u.push(p.generalizedTimeToDate(n.certValidity4GeneralizedTime)),u.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(u.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(s.validity.notBefore=u[0],s.validity.notAfter=u[1],s.tbsCertificate=n.tbsCertificate,t){s.md=Ua({signatureOid:s.signatureOid,type:"certificate"});var c=p.toDer(s.tbsCertificate);s.md.update(c.getBytes())}var l=J.md.sha1.create(),f=p.toDer(n.certIssuer);l.update(f.getBytes()),s.issuer.getField=function(h){return Ur(s.issuer,h)},s.issuer.addField=function(h){Bt([h]),s.issuer.attributes.push(h)},s.issuer.attributes=F.RDNAttributesAsArray(n.certIssuer),n.certIssuerUniqueId&&(s.issuer.uniqueId=n.certIssuerUniqueId),s.issuer.hash=l.digest().toHex();var d=J.md.sha1.create(),v=p.toDer(n.certSubject);return d.update(v.getBytes()),s.subject.getField=function(h){return Ur(s.subject,h)},s.subject.addField=function(h){Bt([h]),s.subject.attributes.push(h)},s.subject.attributes=F.RDNAttributesAsArray(n.certSubject),n.certSubjectUniqueId&&(s.subject.uniqueId=n.certSubjectUniqueId),s.subject.hash=d.digest().toHex(),n.certExtensions?s.extensions=F.certificateExtensionsFromAsn1(n.certExtensions):s.extensions=[],s.publicKey=F.publicKeyFromAsn1(n.subjectPublicKeyInfo),s};F.certificateExtensionsFromAsn1=function(e){for(var t=[],n=0;n<e.value.length;++n)for(var r=e.value[n],i=0;i<r.value.length;++i)t.push(F.certificateExtensionFromAsn1(r.value[i]));return t};F.certificateExtensionFromAsn1=function(e){var t={};if(t.id=p.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===p.Type.BOOLEAN?(t.critical=e.value[1].value.charCodeAt(0)!==0,t.value=e.value[2].value):t.value=e.value[1].value,t.id in pe){if(t.name=pe[t.id],t.name==="keyUsage"){var n=p.fromDer(t.value),r=0,i=0;n.value.length>1&&(r=n.value.charCodeAt(1),i=n.value.length>2?n.value.charCodeAt(2):0),t.digitalSignature=(r&128)===128,t.nonRepudiation=(r&64)===64,t.keyEncipherment=(r&32)===32,t.dataEncipherment=(r&16)===16,t.keyAgreement=(r&8)===8,t.keyCertSign=(r&4)===4,t.cRLSign=(r&2)===2,t.encipherOnly=(r&1)===1,t.decipherOnly=(i&128)===128}else if(t.name==="basicConstraints"){var n=p.fromDer(t.value);n.value.length>0&&n.value[0].type===p.Type.BOOLEAN?t.cA=n.value[0].value.charCodeAt(0)!==0:t.cA=!1;var a=null;n.value.length>0&&n.value[0].type===p.Type.INTEGER?a=n.value[0].value:n.value.length>1&&(a=n.value[1].value),a!==null&&(t.pathLenConstraint=p.derToInteger(a))}else if(t.name==="extKeyUsage")for(var n=p.fromDer(t.value),s=0;s<n.value.length;++s){var o=p.derToOid(n.value[s].value);o in pe?t[pe[o]]=!0:t[o]=!0}else if(t.name==="nsCertType"){var n=p.fromDer(t.value),r=0;n.value.length>1&&(r=n.value.charCodeAt(1)),t.client=(r&128)===128,t.server=(r&64)===64,t.email=(r&32)===32,t.objsign=(r&16)===16,t.reserved=(r&8)===8,t.sslCA=(r&4)===4,t.emailCA=(r&2)===2,t.objCA=(r&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];for(var u,n=p.fromDer(t.value),c=0;c<n.value.length;++c){u=n.value[c];var l={type:u.type,value:u.value};switch(t.altNames.push(l),u.type){case 1:case 2:case 6:break;case 7:l.ip=J.util.bytesToIP(u.value);break;case 8:l.oid=p.derToOid(u.value);break}}}else if(t.name==="subjectKeyIdentifier"){var n=p.fromDer(t.value);t.subjectKeyIdentifier=J.util.bytesToHex(n.value)}}return t};F.certificationRequestFromAsn1=function(e,t){var n={},r=[];if(!p.validate(e,Vg,n,r)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=r,i}var a=p.derToOid(n.publicKeyOid);if(a!==F.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=F.createCertificationRequest();if(s.version=n.csrVersion?n.csrVersion.charCodeAt(0):0,s.signatureOid=J.asn1.derToOid(n.csrSignatureOid),s.signatureParameters=ha(s.signatureOid,n.csrSignatureParams,!0),s.siginfo.algorithmOid=J.asn1.derToOid(n.csrSignatureOid),s.siginfo.parameters=ha(s.siginfo.algorithmOid,n.csrSignatureParams,!1),s.signature=n.csrSignature,s.certificationRequestInfo=n.certificationRequestInfo,t){s.md=Ua({signatureOid:s.signatureOid,type:"certification request"});var o=p.toDer(s.certificationRequestInfo);s.md.update(o.getBytes())}var u=J.md.sha1.create();return s.subject.getField=function(c){return Ur(s.subject,c)},s.subject.addField=function(c){Bt([c]),s.subject.attributes.push(c)},s.subject.attributes=F.RDNAttributesAsArray(n.certificationRequestInfoSubject,u),s.subject.hash=u.digest().toHex(),s.publicKey=F.publicKeyFromAsn1(n.subjectPublicKeyInfo),s.getAttribute=function(c){return Ur(s,c)},s.addAttribute=function(c){Bt([c]),s.attributes.push(c)},s.attributes=F.CRIAttributesAsArray(n.certificationRequestInfoAttributes||[]),s};F.createCertificationRequest=function(){var e={};return e.version=0,e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return Ur(e.subject,t)},e.subject.addField=function(t){Bt([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return Ur(e,t)},e.addAttribute=function(t){Bt([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){Bt(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){Bt(t),e.attributes=t},e.sign=function(t,n){e.md=n||J.md.sha1.create();var r=pe[e.md.algorithm+"WithRSAEncryption"];if(!r){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=e.md.algorithm,i}e.signatureOid=e.siginfo.algorithmOid=r,e.certificationRequestInfo=F.getCertificationRequestInfo(e);var a=p.toDer(e.certificationRequestInfo);e.md.update(a.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,n=e.md;if(n===null){n=Ua({signatureOid:e.signatureOid,type:"certification request"});var r=e.certificationRequestInfo||F.getCertificationRequestInfo(e),i=p.toDer(r);n.update(i.getBytes())}return n!==null&&(t=Vl({certificate:e,md:n,signature:e.signature})),t},e};function En(e){for(var t=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]),n,r,i=e.attributes,a=0;a<i.length;++a){n=i[a];var s=n.value,o=p.Type.PRINTABLESTRING;"valueTagClass"in n&&(o=n.valueTagClass,o===p.Type.UTF8&&(s=J.util.encodeUtf8(s))),r=p.create(p.Class.UNIVERSAL,p.Type.SET,!0,[p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(n.type).getBytes()),p.create(p.Class.UNIVERSAL,o,!1,s)])]),t.value.push(r)}return t}function Bt(e){for(var t,n=0;n<e.length;++n){if(t=e[n],typeof t.name>"u"&&(t.type&&t.type in F.oids?t.name=F.oids[t.type]:t.shortName&&t.shortName in Be&&(t.name=F.oids[Be[t.shortName]])),typeof t.type>"u")if(t.name&&t.name in F.oids)t.type=F.oids[t.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=t,r}if(typeof t.shortName>"u"&&t.name&&t.name in Be&&(t.shortName=Be[t.name]),t.type===pe.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=p.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var i=0;i<t.extensions.length;++i)t.value.push(F.certificateExtensionToAsn1($l(t.extensions[i])))}if(typeof t.value>"u"){var r=new Error("Attribute value not specified.");throw r.attribute=t,r}}}function $l(e,t){if(t=t||{},typeof e.name>"u"&&e.id&&e.id in F.oids&&(e.name=F.oids[e.id]),typeof e.id>"u")if(e.name&&e.name in F.oids)e.id=F.oids[e.name];else{var n=new Error("Extension ID not specified.");throw n.extension=e,n}if(typeof e.value<"u")return e;if(e.name==="keyUsage"){var r=0,i=0,a=0;e.digitalSignature&&(i|=128,r=7),e.nonRepudiation&&(i|=64,r=6),e.keyEncipherment&&(i|=32,r=5),e.dataEncipherment&&(i|=16,r=4),e.keyAgreement&&(i|=8,r=3),e.keyCertSign&&(i|=4,r=2),e.cRLSign&&(i|=2,r=1),e.encipherOnly&&(i|=1,r=0),e.decipherOnly&&(a|=128,r=7);var s=String.fromCharCode(r);a!==0?s+=String.fromCharCode(i)+String.fromCharCode(a):i!==0&&(s+=String.fromCharCode(i)),e.value=p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,s)}else if(e.name==="basicConstraints")e.value=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(p.create(p.Class.UNIVERSAL,p.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,p.integerToDer(e.pathLenConstraint).getBytes()));else if(e.name==="extKeyUsage"){e.value=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]);var o=e.value.value;for(var u in e)e[u]===!0&&(u in pe?o.push(p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(pe[u]).getBytes())):u.indexOf(".")!==-1&&o.push(p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(u).getBytes())))}else if(e.name==="nsCertType"){var r=0,i=0;e.client&&(i|=128,r=7),e.server&&(i|=64,r=6),e.email&&(i|=32,r=5),e.objsign&&(i|=16,r=4),e.reserved&&(i|=8,r=3),e.sslCA&&(i|=4,r=2),e.emailCA&&(i|=2,r=1),e.objCA&&(i|=1,r=0);var s=String.fromCharCode(r);i!==0&&(s+=String.fromCharCode(i)),e.value=p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,s)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]);for(var c,l=0;l<e.altNames.length;++l){c=e.altNames[l];var s=c.value;if(c.type===7&&c.ip){if(s=J.util.bytesFromIP(c.ip),s===null){var n=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw n.extension=e,n}}else c.type===8&&(c.oid?s=p.oidToDer(p.oidToDer(c.oid)):s=p.oidToDer(s));e.value.value.push(p.create(p.Class.CONTEXT_SPECIFIC,c.type,!1,s))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=p.create(p.Class.UNIVERSAL,p.Type.IA5STRING,!1,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var f=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=f.toHex(),e.value=p.create(p.Class.UNIVERSAL,p.Type.OCTETSTRING,!1,f.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]);var o=e.value.value;if(e.keyIdentifier){var d=e.keyIdentifier===!0?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;o.push(p.create(p.Class.CONTEXT_SPECIFIC,0,!1,d))}if(e.authorityCertIssuer){var v=[p.create(p.Class.CONTEXT_SPECIFIC,4,!0,[En(e.authorityCertIssuer===!0?t.cert.issuer:e.authorityCertIssuer)])];o.push(p.create(p.Class.CONTEXT_SPECIFIC,1,!0,v))}if(e.serialNumber){var h=J.util.hexToBytes(e.serialNumber===!0?t.cert.serialNumber:e.serialNumber);o.push(p.create(p.Class.CONTEXT_SPECIFIC,2,!1,h))}}else if(e.name==="cRLDistributionPoints"){e.value=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]);for(var o=e.value.value,m=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]),b=p.create(p.Class.CONTEXT_SPECIFIC,0,!0,[]),c,l=0;l<e.altNames.length;++l){c=e.altNames[l];var s=c.value;if(c.type===7&&c.ip){if(s=J.util.bytesFromIP(c.ip),s===null){var n=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw n.extension=e,n}}else c.type===8&&(c.oid?s=p.oidToDer(p.oidToDer(c.oid)):s=p.oidToDer(s));b.value.push(p.create(p.Class.CONTEXT_SPECIFIC,c.type,!1,s))}m.value.push(p.create(p.Class.CONTEXT_SPECIFIC,0,!0,[b])),o.push(m)}if(typeof e.value>"u"){var n=new Error("Extension value not specified.");throw n.extension=e,n}return e}function Fo(e,t){switch(e){case pe["RSASSA-PSS"]:var n=[];return t.hash.algorithmOid!==void 0&&n.push(p.create(p.Class.CONTEXT_SPECIFIC,0,!0,[p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(t.hash.algorithmOid).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,"")])])),t.mgf.algorithmOid!==void 0&&n.push(p.create(p.Class.CONTEXT_SPECIFIC,1,!0,[p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(t.mgf.algorithmOid).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(t.mgf.hash.algorithmOid).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,"")])])])),t.saltLength!==void 0&&n.push(p.create(p.Class.CONTEXT_SPECIFIC,2,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,p.integerToDer(t.saltLength).getBytes())])),p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,n);default:return p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,"")}}function $g(e){var t=p.create(p.Class.CONTEXT_SPECIFIC,0,!0,[]);if(e.attributes.length===0)return t;for(var n=e.attributes,r=0;r<n.length;++r){var i=n[r],a=i.value,s=p.Type.UTF8;"valueTagClass"in i&&(s=i.valueTagClass),s===p.Type.UTF8&&(a=J.util.encodeUtf8(a));var o=!1;"valueConstructed"in i&&(o=i.valueConstructed);var u=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(i.type).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.SET,!0,[p.create(p.Class.UNIVERSAL,s,o,a)])]);t.value.push(u)}return t}var Hg=new Date("1950-01-01T00:00:00Z"),jg=new Date("2050-01-01T00:00:00Z");function tc(e){return e>=Hg&&e<jg?p.create(p.Class.UNIVERSAL,p.Type.UTCTIME,!1,p.dateToUtcTime(e)):p.create(p.Class.UNIVERSAL,p.Type.GENERALIZEDTIME,!1,p.dateToGeneralizedTime(e))}F.getTBSCertificate=function(e){var t=tc(e.validity.notBefore),n=tc(e.validity.notAfter),r=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.CONTEXT_SPECIFIC,0,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,p.integerToDer(e.version).getBytes())]),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,J.util.hexToBytes(e.serialNumber)),p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(e.siginfo.algorithmOid).getBytes()),Fo(e.siginfo.algorithmOid,e.siginfo.parameters)]),En(e.issuer),p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[t,n]),En(e.subject),F.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&r.value.push(p.create(p.Class.CONTEXT_SPECIFIC,1,!0,[p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&r.value.push(p.create(p.Class.CONTEXT_SPECIFIC,2,!0,[p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&r.value.push(F.certificateExtensionsToAsn1(e.extensions)),r};F.getCertificationRequestInfo=function(e){var t=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,p.integerToDer(e.version).getBytes()),En(e.subject),F.publicKeyToAsn1(e.publicKey),$g(e)]);return t};F.distinguishedNameToAsn1=function(e){return En(e)};F.certificateToAsn1=function(e){var t=e.tbsCertificate||F.getTBSCertificate(e);return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[t,p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(e.signatureOid).getBytes()),Fo(e.signatureOid,e.signatureParameters)]),p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};F.certificateExtensionsToAsn1=function(e){var t=p.create(p.Class.CONTEXT_SPECIFIC,3,!0,[]),n=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]);t.value.push(n);for(var r=0;r<e.length;++r)n.value.push(F.certificateExtensionToAsn1(e[r]));return t};F.certificateExtensionToAsn1=function(e){var t=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]);t.value.push(p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(e.id).getBytes())),e.critical&&t.value.push(p.create(p.Class.UNIVERSAL,p.Type.BOOLEAN,!1,String.fromCharCode(255)));var n=e.value;return typeof e.value!="string"&&(n=p.toDer(n).getBytes()),t.value.push(p.create(p.Class.UNIVERSAL,p.Type.OCTETSTRING,!1,n)),t};F.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||F.getCertificationRequestInfo(e);return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[t,p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(e.signatureOid).getBytes()),Fo(e.signatureOid,e.signatureParameters)]),p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};F.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(s){var o=n(s.issuer);return o},t.addCertificate=function(s){if(typeof s=="string"&&(s=J.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))if(s.subject.hash in t.certs){var o=t.certs[s.subject.hash];J.util.isArray(o)||(o=[o]),o.push(s),t.certs[s.subject.hash]=o}else t.certs[s.subject.hash]=s},t.hasCertificate=function(s){typeof s=="string"&&(s=J.pki.certificateFromPem(s));var o=n(s.subject);if(!o)return!1;J.util.isArray(o)||(o=[o]);for(var u=p.toDer(F.certificateToAsn1(s)).getBytes(),c=0;c<o.length;++c){var l=p.toDer(F.certificateToAsn1(o[c])).getBytes();if(u===l)return!0}return!1},t.listAllCertificates=function(){var s=[];for(var o in t.certs)if(t.certs.hasOwnProperty(o)){var u=t.certs[o];if(!J.util.isArray(u))s.push(u);else for(var c=0;c<u.length;++c)s.push(u[c])}return s},t.removeCertificate=function(s){var o;if(typeof s=="string"&&(s=J.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))return null;var u=n(s.subject);if(!J.util.isArray(u))return o=t.certs[s.subject.hash],delete t.certs[s.subject.hash],o;for(var c=p.toDer(F.certificateToAsn1(s)).getBytes(),l=0;l<u.length;++l){var f=p.toDer(F.certificateToAsn1(u[l])).getBytes();c===f&&(o=u[l],u.splice(l,1))}return u.length===0&&delete t.certs[s.subject.hash],o};function n(s){return r(s),t.certs[s.hash]||null}function r(s){if(!s.hash){var o=J.md.sha1.create();s.attributes=F.RDNAttributesAsArray(En(s),o),s.hash=o.digest().toHex()}}if(e)for(var i=0;i<e.length;++i){var a=e[i];t.addCertificate(a)}return t};F.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};F.verifyCertificateChain=function(e,t,n){typeof n=="function"&&(n={verify:n}),n=n||{},t=t.slice(0);var r=t.slice(0),i=n.validityCheckDate;typeof i>"u"&&(i=new Date);var a=!0,s=null,o=0;do{var u=t.shift(),c=null,l=!1;if(i&&(i<u.validity.notBefore||i>u.validity.notAfter)&&(s={message:"Certificate is not valid yet or has expired.",error:F.certificateError.certificate_expired,notBefore:u.validity.notBefore,notAfter:u.validity.notAfter,now:i}),s===null){if(c=t[0]||e.getIssuer(u),c===null&&u.isIssuer(u)&&(l=!0,c=u),c){var f=c;J.util.isArray(f)||(f=[f]);for(var d=!1;!d&&f.length>0;){c=f.shift();try{d=c.verify(u)}catch{}}d||(s={message:"Certificate signature is invalid.",error:F.certificateError.bad_certificate})}s===null&&(!c||l)&&!e.hasCertificate(u)&&(s={message:"Certificate is not trusted.",error:F.certificateError.unknown_ca})}if(s===null&&c&&!u.isIssuer(c)&&(s={message:"Certificate issuer is invalid.",error:F.certificateError.bad_certificate}),s===null)for(var v={keyUsage:!0,basicConstraints:!0},h=0;s===null&&h<u.extensions.length;++h){var m=u.extensions[h];m.critical&&!(m.name in v)&&(s={message:"Certificate has an unsupported critical extension.",error:F.certificateError.unsupported_certificate})}if(s===null&&(!a||t.length===0&&(!c||l))){var b=u.getExtension("basicConstraints"),E=u.getExtension("keyUsage");if(E!==null&&(!E.keyCertSign||b===null)&&(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:F.certificateError.bad_certificate}),s===null&&b!==null&&!b.cA&&(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:F.certificateError.bad_certificate}),s===null&&E!==null&&"pathLenConstraint"in b){var x=o-1;x>b.pathLenConstraint&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:F.certificateError.bad_certificate})}}var A=s===null?!0:s.error,B=n.verify?n.verify(A,o,r):A;if(B===!0)s=null;else throw A===!0&&(s={message:"The application rejected the certificate.",error:F.certificateError.bad_certificate}),(B||B===0)&&(typeof B=="object"&&!J.util.isArray(B)?(B.message&&(s.message=B.message),B.error&&(s.error=B.error)):typeof B=="string"&&(s.error=B)),s;a=!1,++o}while(t.length>0);return!0};var Ce=se,S=Ce.asn1,oe=Ce.pki,mi=Ce.pkcs12=Ce.pkcs12||{},Hl={name:"ContentInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:S.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},qg={name:"PFX",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"version"},Hl,{name:"PFX.macData",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:S.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},Gg={name:"SafeBag",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:S.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:S.Class.UNIVERSAL,type:S.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},Wg={name:"Attribute",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:S.Class.UNIVERSAL,type:S.Type.SET,constructed:!0,capture:"values"}]},zg={name:"CertBag",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:S.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:S.Class.UNIVERSAL,type:S.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function Yn(e,t,n,r){for(var i=[],a=0;a<e.length;a++)for(var s=0;s<e[a].safeBags.length;s++){var o=e[a].safeBags[s];if(!(r!==void 0&&o.type!==r)){if(t===null){i.push(o);continue}o.attributes[t]!==void 0&&o.attributes[t].indexOf(n)>=0&&i.push(o)}}return i}mi.pkcs12FromAsn1=function(e,t,n){typeof t=="string"?(n=t,t=!0):t===void 0&&(t=!0);var r={},i=[];if(!S.validate(e,qg,r,i)){var a=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw a.errors=a,a}var s={version:r.version.charCodeAt(0),safeContents:[],getBags:function(b){var E={},x;return"localKeyId"in b?x=b.localKeyId:"localKeyIdHex"in b&&(x=Ce.util.hexToBytes(b.localKeyIdHex)),x===void 0&&!("friendlyName"in b)&&"bagType"in b&&(E[b.bagType]=Yn(s.safeContents,null,null,b.bagType)),x!==void 0&&(E.localKeyId=Yn(s.safeContents,"localKeyId",x,b.bagType)),"friendlyName"in b&&(E.friendlyName=Yn(s.safeContents,"friendlyName",b.friendlyName,b.bagType)),E},getBagsByFriendlyName:function(b,E){return Yn(s.safeContents,"friendlyName",b,E)},getBagsByLocalKeyId:function(b,E){return Yn(s.safeContents,"localKeyId",b,E)}};if(r.version.charCodeAt(0)!==3){var a=new Error("PKCS#12 PFX of version other than 3 not supported.");throw a.version=r.version.charCodeAt(0),a}if(S.derToOid(r.contentType)!==oe.oids.data){var a=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw a.oid=S.derToOid(r.contentType),a}var o=r.content.value[0];if(o.tagClass!==S.Class.UNIVERSAL||o.type!==S.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(o=Mo(o),r.mac){var u=null,c=0,l=S.derToOid(r.macAlgorithm);switch(l){case oe.oids.sha1:u=Ce.md.sha1.create(),c=20;break;case oe.oids.sha256:u=Ce.md.sha256.create(),c=32;break;case oe.oids.sha384:u=Ce.md.sha384.create(),c=48;break;case oe.oids.sha512:u=Ce.md.sha512.create(),c=64;break;case oe.oids.md5:u=Ce.md.md5.create(),c=16;break}if(u===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+l);var f=new Ce.util.ByteBuffer(r.macSalt),d="macIterations"in r?parseInt(Ce.util.bytesToHex(r.macIterations),16):1,v=mi.generateKey(n,f,3,d,c,u),h=Ce.hmac.create();h.start(u,v),h.update(o.value);var m=h.getMac();if(m.getBytes()!==r.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return Qg(s,o.value,t,n),s};function Mo(e){if(e.composed||e.constructed){for(var t=Ce.util.createBuffer(),n=0;n<e.value.length;++n)t.putBytes(e.value[n].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function Qg(e,t,n,r){if(t=S.fromDer(t,n),t.tagClass!==S.Class.UNIVERSAL||t.type!==S.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<t.value.length;i++){var a=t.value[i],s={},o=[];if(!S.validate(a,Hl,s,o)){var u=new Error("Cannot read ContentInfo.");throw u.errors=o,u}var c={encrypted:!1},l=null,f=s.content.value[0];switch(S.derToOid(s.contentType)){case oe.oids.data:if(f.tagClass!==S.Class.UNIVERSAL||f.type!==S.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");l=Mo(f).value;break;case oe.oids.encryptedData:l=Yg(f,r),c.encrypted=!0;break;default:var u=new Error("Unsupported PKCS#12 contentType.");throw u.contentType=S.derToOid(s.contentType),u}c.safeBags=Xg(l,n,r),e.safeContents.push(c)}}function Yg(e,t){var n={},r=[];if(!S.validate(e,Ce.pkcs7.asn1.encryptedDataValidator,n,r)){var i=new Error("Cannot read EncryptedContentInfo.");throw i.errors=r,i}var a=S.derToOid(n.contentType);if(a!==oe.oids.data){var i=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw i.oid=a,i}a=S.derToOid(n.encAlgorithm);var s=oe.pbe.getCipher(a,n.encParameter,t),o=Mo(n.encryptedContentAsn1),u=Ce.util.createBuffer(o.value);if(s.update(u),!s.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return s.output.getBytes()}function Xg(e,t,n){if(!t&&e.length===0)return[];if(e=S.fromDer(e,t),e.tagClass!==S.Class.UNIVERSAL||e.type!==S.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r=[],i=0;i<e.value.length;i++){var a=e.value[i],s={},o=[];if(!S.validate(a,Gg,s,o)){var u=new Error("Cannot read SafeBag.");throw u.errors=o,u}var c={type:S.derToOid(s.bagId),attributes:Jg(s.bagAttributes)};r.push(c);var l,f,d=s.bagValue.value[0];switch(c.type){case oe.oids.pkcs8ShroudedKeyBag:if(d=oe.decryptPrivateKeyInfo(d,n),d===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case oe.oids.keyBag:try{c.key=oe.privateKeyFromAsn1(d)}catch{c.key=null,c.asn1=d}continue;case oe.oids.certBag:l=zg,f=function(){if(S.derToOid(s.certId)!==oe.oids.x509Certificate){var h=new Error("Unsupported certificate type, only X.509 supported.");throw h.oid=S.derToOid(s.certId),h}var m=S.fromDer(s.cert,t);try{c.cert=oe.certificateFromAsn1(m,!0)}catch{c.cert=null,c.asn1=m}};break;default:var u=new Error("Unsupported PKCS#12 SafeBag type.");throw u.oid=c.type,u}if(l!==void 0&&!S.validate(d,l,s,o)){var u=new Error("Cannot read PKCS#12 "+l.name);throw u.errors=o,u}f()}return r}function Jg(e){var t={};if(e!==void 0)for(var n=0;n<e.length;++n){var r={},i=[];if(!S.validate(e[n],Wg,r,i)){var a=new Error("Cannot read PKCS#12 BagAttribute.");throw a.errors=i,a}var s=S.derToOid(r.oid);if(oe.oids[s]!==void 0){t[oe.oids[s]]=[];for(var o=0;o<r.values.length;++o)t[oe.oids[s]].push(r.values[o].value)}}return t}mi.toPkcs12Asn1=function(e,t,n,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);var i=r.localKeyId,a;if(i!==null)i=Ce.util.hexToBytes(i);else if(r.generateLocalKeyId)if(t){var s=Ce.util.isArray(t)?t[0]:t;typeof s=="string"&&(s=oe.certificateFromPem(s));var o=Ce.md.sha1.create();o.update(S.toDer(oe.certificateToAsn1(s)).getBytes()),i=o.digest().getBytes()}else i=Ce.random.getBytes(20);var u=[];i!==null&&u.push(S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.localKeyId).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SET,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,i)])])),"friendlyName"in r&&u.push(S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.friendlyName).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SET,!0,[S.create(S.Class.UNIVERSAL,S.Type.BMPSTRING,!1,r.friendlyName)])])),u.length>0&&(a=S.create(S.Class.UNIVERSAL,S.Type.SET,!0,u));var c=[],l=[];t!==null&&(Ce.util.isArray(t)?l=t:l=[t]);for(var f=[],d=0;d<l.length;++d){t=l[d],typeof t=="string"&&(t=oe.certificateFromPem(t));var v=d===0?a:void 0,h=oe.certificateToAsn1(t),m=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.certBag).getBytes()),S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.x509Certificate).getBytes()),S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,S.toDer(h).getBytes())])])]),v]);f.push(m)}if(f.length>0){var b=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,f),E=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.data).getBytes()),S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,S.toDer(b).getBytes())])]);c.push(E)}var x=null;if(e!==null){var A=oe.wrapRsaPrivateKey(oe.privateKeyToAsn1(e));n===null?x=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.keyBag).getBytes()),S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[A]),a]):x=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.pkcs8ShroudedKeyBag).getBytes()),S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[oe.encryptPrivateKeyInfo(A,n,r)]),a]);var B=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[x]),_=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.data).getBytes()),S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,S.toDer(B).getBytes())])]);c.push(_)}var L=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,c),W;if(r.useMac){var o=Ce.md.sha1.create(),te=new Ce.util.ByteBuffer(Ce.random.getBytes(r.saltSize)),re=r.count,e=mi.generateKey(n,te,3,re,20),P=Ce.hmac.create();P.start(o,e),P.update(S.toDer(L).getBytes());var T=P.getMac();W=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.sha1).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")]),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,T.getBytes())]),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,te.getBytes()),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(re).getBytes())])}return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(3).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(oe.oids.data).getBytes()),S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,S.toDer(L).getBytes())])]),W])};mi.generateKey=Ce.pbe.generatePkcs12Key;var Or=se,Vo=Or.asn1,Cn=Or.pki=Or.pki||{};Cn.pemToDer=function(e){var t=Or.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Or.util.createBuffer(t.body)};Cn.privateKeyFromPem=function(e){var t=Or.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw n.headerType=t.type,n}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var r=Vo.fromDer(t.body);return Cn.privateKeyFromAsn1(r)};Cn.privateKeyToPem=function(e,t){var n={type:"RSA PRIVATE KEY",body:Vo.toDer(Cn.privateKeyToAsn1(e)).getBytes()};return Or.pem.encode(n,{maxline:t})};Cn.privateKeyInfoToPem=function(e,t){var n={type:"PRIVATE KEY",body:Vo.toDer(e).getBytes()};return Or.pem.encode(n,{maxline:t})};var U=se,Oa=function(e,t,n,r){var i=U.util.createBuffer(),a=e.length>>1,s=a+(e.length&1),o=e.substr(0,s),u=e.substr(a,s),c=U.util.createBuffer(),l=U.hmac.create();n=t+n;var f=Math.ceil(r/16),d=Math.ceil(r/20);l.start("MD5",o);var v=U.util.createBuffer();c.putBytes(n);for(var h=0;h<f;++h)l.start(null,null),l.update(c.getBytes()),c.putBuffer(l.digest()),l.start(null,null),l.update(c.bytes()+n),v.putBuffer(l.digest());l.start("SHA1",u);var m=U.util.createBuffer();c.clear(),c.putBytes(n);for(var h=0;h<d;++h)l.start(null,null),l.update(c.getBytes()),c.putBuffer(l.digest()),l.start(null,null),l.update(c.bytes()+n),m.putBuffer(l.digest());return i.putBytes(U.util.xorBytes(v.getBytes(),m.getBytes(),r)),i},Zg=function(e,t,n){var r=U.hmac.create();r.start("SHA1",e);var i=U.util.createBuffer();return i.putInt32(t[0]),i.putInt32(t[1]),i.putByte(n.type),i.putByte(n.version.major),i.putByte(n.version.minor),i.putInt16(n.length),i.putBytes(n.fragment.bytes()),r.update(i.getBytes()),r.digest().getBytes()},ev=function(e,t,n){var r=!1;try{var i=e.deflate(t.fragment.getBytes());t.fragment=U.util.createBuffer(i),t.length=i.length,r=!0}catch{}return r},tv=function(e,t,n){var r=!1;try{var i=e.inflate(t.fragment.getBytes());t.fragment=U.util.createBuffer(i),t.length=i.length,r=!0}catch{}return r},mt=function(e,t){var n=0;switch(t){case 1:n=e.getByte();break;case 2:n=e.getInt16();break;case 3:n=e.getInt24();break;case 4:n=e.getInt32();break}return U.util.createBuffer(e.getBytes(n))},xt=function(e,t,n){e.putInt(n.length(),t<<3),e.putBuffer(n)},g={};g.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};g.SupportedVersions=[g.Versions.TLS_1_1,g.Versions.TLS_1_0];g.Version=g.SupportedVersions[0];g.MaxFragment=16384-1024;g.ConnectionEnd={server:0,client:1};g.PRFAlgorithm={tls_prf_sha256:0};g.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};g.CipherType={stream:0,block:1,aead:2};g.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};g.CompressionMethod={none:0,deflate:1};g.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};g.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};g.Alert={};g.Alert.Level={warning:1,fatal:2};g.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};g.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};g.CipherSuites={};g.getCipherSuite=function(e){var t=null;for(var n in g.CipherSuites){var r=g.CipherSuites[n];if(r.id[0]===e.charCodeAt(0)&&r.id[1]===e.charCodeAt(1)){t=r;break}}return t};g.handleUnexpected=function(e,t){var n=!e.open&&e.entity===g.ConnectionEnd.client;n||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.unexpected_message}})};g.handleHelloRequest=function(e,t,n){!e.handshaking&&e.handshakes>0&&(g.queue(e,g.createAlert(e,{level:g.Alert.Level.warning,description:g.Alert.Description.no_renegotiation})),g.flush(e)),e.process()};g.parseHelloMessage=function(e,t,n){var r=null,i=e.entity===g.ConnectionEnd.client;if(n<38)e.error(e,{message:i?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.illegal_parameter}});else{var a=t.fragment,s=a.length();if(r={version:{major:a.getByte(),minor:a.getByte()},random:U.util.createBuffer(a.getBytes(32)),session_id:mt(a,1),extensions:[]},i?(r.cipher_suite=a.getBytes(2),r.compression_method=a.getByte()):(r.cipher_suites=mt(a,2),r.compression_methods=mt(a,1)),s=n-(s-a.length()),s>0){for(var o=mt(a,2);o.length()>0;)r.extensions.push({type:[o.getByte(),o.getByte()],data:mt(o,2)});if(!i)for(var u=0;u<r.extensions.length;++u){var c=r.extensions[u];if(c.type[0]===0&&c.type[1]===0)for(var l=mt(c.data,2);l.length()>0;){var f=l.getByte();if(f!==0)break;e.session.extensions.server_name.serverNameList.push(mt(l,2).getBytes())}}}if(e.session.version&&(r.version.major!==e.session.version.major||r.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.protocol_version}});if(i)e.session.cipherSuite=g.getCipherSuite(r.cipher_suite);else for(var d=U.util.createBuffer(r.cipher_suites.bytes());d.length()>0&&(e.session.cipherSuite=g.getCipherSuite(d.getBytes(2)),e.session.cipherSuite===null););if(e.session.cipherSuite===null)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.handshake_failure},cipherSuite:U.util.bytesToHex(r.cipher_suite)});i?e.session.compressionMethod=r.compression_method:e.session.compressionMethod=g.CompressionMethod.none}return r};g.createSecurityParameters=function(e,t){var n=e.entity===g.ConnectionEnd.client,r=t.random.bytes(),i=n?e.session.sp.client_random:r,a=n?r:g.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:g.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:a}};g.handleServerHello=function(e,t,n){var r=g.parseHelloMessage(e,t,n);if(!e.fail){if(r.version.minor<=e.version.minor)e.version.minor=r.version.minor;else return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.protocol_version}});e.session.version=e.version;var i=r.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=jl,e.session.resuming=!0,e.session.sp.server_random=r.random.bytes()):(e.expect=nv,e.session.resuming=!1,g.createSecurityParameters(e,r)),e.session.id=i,e.process()}};g.handleClientHello=function(e,t,n){var r=g.parseHelloMessage(e,t,n);if(!e.fail){var i=r.session_id.bytes(),a=null;if(e.sessionCache&&(a=e.sessionCache.getSession(i),a===null?i="":(a.version.major!==r.version.major||a.version.minor>r.version.minor)&&(a=null,i="")),i.length===0&&(i=U.random.getBytes(32)),e.session.id=i,e.session.clientHelloVersion=r.version,e.session.sp={},a)e.version=e.session.version=a.version,e.session.sp=a.sp;else{for(var s,o=1;o<g.SupportedVersions.length&&(s=g.SupportedVersions[o],!(s.minor<=r.version.minor));++o);e.version={major:s.major,minor:s.minor},e.session.version=e.version}a!==null?(e.expect=$o,e.session.resuming=!0,e.session.sp.client_random=r.random.bytes()):(e.expect=e.verifyClient!==!1?lv:zs,e.session.resuming=!1,g.createSecurityParameters(e,r)),e.open=!0,g.queue(e,g.createRecord(e,{type:g.ContentType.handshake,data:g.createServerHello(e)})),e.session.resuming?(g.queue(e,g.createRecord(e,{type:g.ContentType.change_cipher_spec,data:g.createChangeCipherSpec()})),e.state.pending=g.createConnectionState(e),e.state.current.write=e.state.pending.write,g.queue(e,g.createRecord(e,{type:g.ContentType.handshake,data:g.createFinished(e)}))):(g.queue(e,g.createRecord(e,{type:g.ContentType.handshake,data:g.createCertificate(e)})),e.fail||(g.queue(e,g.createRecord(e,{type:g.ContentType.handshake,data:g.createServerKeyExchange(e)})),e.verifyClient!==!1&&g.queue(e,g.createRecord(e,{type:g.ContentType.handshake,data:g.createCertificateRequest(e)})),g.queue(e,g.createRecord(e,{type:g.ContentType.handshake,data:g.createServerHelloDone(e)})))),g.flush(e),e.process()}};g.handleCertificate=function(e,t,n){if(n<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.illegal_parameter}});var r=t.fragment,i={certificate_list:mt(r,3)},a,s,o=[];try{for(;i.certificate_list.length()>0;)a=mt(i.certificate_list,3),s=U.asn1.fromDer(a),a=U.pki.certificateFromAsn1(s,!0),o.push(a)}catch(c){return e.error(e,{message:"Could not parse certificate list.",cause:c,send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.bad_certificate}})}var u=e.entity===g.ConnectionEnd.client;(u||e.verifyClient===!0)&&o.length===0?e.error(e,{message:u?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.illegal_parameter}}):o.length===0?e.expect=u?rc:zs:(u?e.session.serverCertificate=o[0]:e.session.clientCertificate=o[0],g.verifyCertificateChain(e,o)&&(e.expect=u?rc:zs)),e.process()};g.handleServerKeyExchange=function(e,t,n){if(n>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.unsupported_certificate}});e.expect=iv,e.process()};g.handleClientKeyExchange=function(e,t,n){if(n<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.unsupported_certificate}});var r=t.fragment,i={enc_pre_master_secret:mt(r,2).getBytes()},a=null;if(e.getPrivateKey)try{a=e.getPrivateKey(e,e.session.serverCertificate),a=U.pki.privateKeyFromPem(a)}catch(u){e.error(e,{message:"Could not get private key.",cause:u,send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.internal_error}})}if(a===null)return e.error(e,{message:"No private key set.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.internal_error}});try{var s=e.session.sp;s.pre_master_secret=a.decrypt(i.enc_pre_master_secret);var o=e.session.clientHelloVersion;if(o.major!==s.pre_master_secret.charCodeAt(0)||o.minor!==s.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{s.pre_master_secret=U.random.getBytes(48)}e.expect=$o,e.session.clientCertificate!==null&&(e.expect=fv),e.process()};g.handleCertificateRequest=function(e,t,n){if(n<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.illegal_parameter}});var r=t.fragment,i={certificate_types:mt(r,1),certificate_authorities:mt(r,2)};e.session.certificateRequest=i,e.expect=av,e.process()};g.handleCertificateVerify=function(e,t,n){if(n<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.illegal_parameter}});var r=t.fragment;r.read-=4;var i=r.bytes();r.read+=4;var a={signature:mt(r,2).getBytes()},s=U.util.createBuffer();s.putBuffer(e.session.md5.digest()),s.putBuffer(e.session.sha1.digest()),s=s.getBytes();try{var o=e.session.clientCertificate;if(!o.publicKey.verify(s,a.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(i),e.session.sha1.update(i)}catch{return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.handshake_failure}})}e.expect=$o,e.process()};g.handleServerHelloDone=function(e,t,n){if(n>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.record_overflow}});if(e.serverCertificate===null){var r={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.insufficient_security}},i=0,a=e.verify(e,r.alert.description,i,[]);if(a!==!0)return(a||a===0)&&(typeof a=="object"&&!U.util.isArray(a)?(a.message&&(r.message=a.message),a.alert&&(r.alert.description=a.alert)):typeof a=="number"&&(r.alert.description=a)),e.error(e,r)}e.session.certificateRequest!==null&&(t=g.createRecord(e,{type:g.ContentType.handshake,data:g.createCertificate(e)}),g.queue(e,t)),t=g.createRecord(e,{type:g.ContentType.handshake,data:g.createClientKeyExchange(e)}),g.queue(e,t),e.expect=uv;var s=function(o,u){o.session.certificateRequest!==null&&o.session.clientCertificate!==null&&g.queue(o,g.createRecord(o,{type:g.ContentType.handshake,data:g.createCertificateVerify(o,u)})),g.queue(o,g.createRecord(o,{type:g.ContentType.change_cipher_spec,data:g.createChangeCipherSpec()})),o.state.pending=g.createConnectionState(o),o.state.current.write=o.state.pending.write,g.queue(o,g.createRecord(o,{type:g.ContentType.handshake,data:g.createFinished(o)})),o.expect=jl,g.flush(o),o.process()};if(e.session.certificateRequest===null||e.session.clientCertificate===null)return s(e,null);g.getClientSignature(e,s)};g.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1)return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.illegal_parameter}});var n=e.entity===g.ConnectionEnd.client;(e.session.resuming&&n||!e.session.resuming&&!n)&&(e.state.pending=g.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&n||e.session.resuming&&!n)&&(e.state.pending=null),e.expect=n?sv:dv,e.process()};g.handleFinished=function(e,t,n){var r=t.fragment;r.read-=4;var i=r.bytes();r.read+=4;var a=t.fragment.getBytes();r=U.util.createBuffer(),r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest());var s=e.entity===g.ConnectionEnd.client,o=s?"server finished":"client finished",u=e.session.sp,c=12,l=Oa;if(r=l(u.master_secret,o,r.getBytes(),c),r.getBytes()!==a)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.decrypt_error}});e.session.md5.update(i),e.session.sha1.update(i),(e.session.resuming&&s||!e.session.resuming&&!s)&&(g.queue(e,g.createRecord(e,{type:g.ContentType.change_cipher_spec,data:g.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,g.queue(e,g.createRecord(e,{type:g.ContentType.handshake,data:g.createFinished(e)}))),e.expect=s?ov:hv,e.handshaking=!1,++e.handshakes,e.peerCertificate=s?e.session.serverCertificate:e.session.clientCertificate,g.flush(e),e.isConnected=!0,e.connected(e),e.process()};g.handleAlert=function(e,t){var n=t.fragment,r={level:n.getByte(),description:n.getByte()},i;switch(r.description){case g.Alert.Description.close_notify:i="Connection closed.";break;case g.Alert.Description.unexpected_message:i="Unexpected message.";break;case g.Alert.Description.bad_record_mac:i="Bad record MAC.";break;case g.Alert.Description.decryption_failed:i="Decryption failed.";break;case g.Alert.Description.record_overflow:i="Record overflow.";break;case g.Alert.Description.decompression_failure:i="Decompression failed.";break;case g.Alert.Description.handshake_failure:i="Handshake failure.";break;case g.Alert.Description.bad_certificate:i="Bad certificate.";break;case g.Alert.Description.unsupported_certificate:i="Unsupported certificate.";break;case g.Alert.Description.certificate_revoked:i="Certificate revoked.";break;case g.Alert.Description.certificate_expired:i="Certificate expired.";break;case g.Alert.Description.certificate_unknown:i="Certificate unknown.";break;case g.Alert.Description.illegal_parameter:i="Illegal parameter.";break;case g.Alert.Description.unknown_ca:i="Unknown certificate authority.";break;case g.Alert.Description.access_denied:i="Access denied.";break;case g.Alert.Description.decode_error:i="Decode error.";break;case g.Alert.Description.decrypt_error:i="Decrypt error.";break;case g.Alert.Description.export_restriction:i="Export restriction.";break;case g.Alert.Description.protocol_version:i="Unsupported protocol version.";break;case g.Alert.Description.insufficient_security:i="Insufficient security.";break;case g.Alert.Description.internal_error:i="Internal error.";break;case g.Alert.Description.user_canceled:i="User canceled.";break;case g.Alert.Description.no_renegotiation:i="Renegotiation not supported.";break;default:i="Unknown error.";break}if(r.description===g.Alert.Description.close_notify)return e.close();e.error(e,{message:i,send:!1,origin:e.entity===g.ConnectionEnd.client?"server":"client",alert:r}),e.process()};g.handleHandshake=function(e,t){var n=t.fragment,r=n.getByte(),i=n.getInt24();if(i>n.length())return e.fragmented=t,t.fragment=U.util.createBuffer(),n.read-=4,e.process();e.fragmented=null,n.read-=4;var a=n.bytes(i+4);n.read+=4,r in pa[e.entity][e.expect]?(e.entity===g.ConnectionEnd.server&&!e.open&&!e.fail&&(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:U.md.md5.create(),sha1:U.md.sha1.create()}),r!==g.HandshakeType.hello_request&&r!==g.HandshakeType.certificate_verify&&r!==g.HandshakeType.finished&&(e.session.md5.update(a),e.session.sha1.update(a)),pa[e.entity][e.expect][r](e,t,i)):g.handleUnexpected(e,t)};g.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()};g.handleHeartbeat=function(e,t){var n=t.fragment,r=n.getByte(),i=n.getInt16(),a=n.getBytes(i);if(r===g.HeartbeatMessageType.heartbeat_request){if(e.handshaking||i>a.length)return e.process();g.queue(e,g.createRecord(e,{type:g.ContentType.heartbeat,data:g.createHeartbeat(g.HeartbeatMessageType.heartbeat_response,a)})),g.flush(e)}else if(r===g.HeartbeatMessageType.heartbeat_response){if(a!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,U.util.createBuffer(a))}e.process()};var rv=0,nv=1,rc=2,iv=3,av=4,jl=5,sv=6,ov=7,uv=8,cv=0,lv=1,zs=2,fv=3,$o=4,dv=5,hv=6,y=g.handleUnexpected,ql=g.handleChangeCipherSpec,Me=g.handleAlert,lt=g.handleHandshake,Gl=g.handleApplicationData,Ve=g.handleHeartbeat,Ho=[];Ho[g.ConnectionEnd.client]=[[y,Me,lt,y,Ve],[y,Me,lt,y,Ve],[y,Me,lt,y,Ve],[y,Me,lt,y,Ve],[y,Me,lt,y,Ve],[ql,Me,y,y,Ve],[y,Me,lt,y,Ve],[y,Me,lt,Gl,Ve],[y,Me,lt,y,Ve]];Ho[g.ConnectionEnd.server]=[[y,Me,lt,y,Ve],[y,Me,lt,y,Ve],[y,Me,lt,y,Ve],[y,Me,lt,y,Ve],[ql,Me,y,y,Ve],[y,Me,lt,y,Ve],[y,Me,lt,Gl,Ve],[y,Me,lt,y,Ve]];var vr=g.handleHelloRequest,pv=g.handleServerHello,Wl=g.handleCertificate,nc=g.handleServerKeyExchange,ys=g.handleCertificateRequest,Ki=g.handleServerHelloDone,zl=g.handleFinished,pa=[];pa[g.ConnectionEnd.client]=[[y,y,pv,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[vr,y,y,y,y,y,y,y,y,y,y,Wl,nc,ys,Ki,y,y,y,y,y,y],[vr,y,y,y,y,y,y,y,y,y,y,y,nc,ys,Ki,y,y,y,y,y,y],[vr,y,y,y,y,y,y,y,y,y,y,y,y,ys,Ki,y,y,y,y,y,y],[vr,y,y,y,y,y,y,y,y,y,y,y,y,y,Ki,y,y,y,y,y,y],[vr,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[vr,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,zl],[vr,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[vr,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]];var yv=g.handleClientHello,gv=g.handleClientKeyExchange,vv=g.handleCertificateVerify;pa[g.ConnectionEnd.server]=[[y,yv,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,Wl,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,gv,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,vv,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,zl],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]];g.generateKeys=function(e,t){var n=Oa,r=t.client_random+t.server_random;e.session.resuming||(t.master_secret=n(t.pre_master_secret,"master secret",r,48).bytes(),t.pre_master_secret=null),r=t.server_random+t.client_random;var i=2*t.mac_key_length+2*t.enc_key_length,a=e.version.major===g.Versions.TLS_1_0.major&&e.version.minor===g.Versions.TLS_1_0.minor;a&&(i+=2*t.fixed_iv_length);var s=n(t.master_secret,"key expansion",r,i),o={client_write_MAC_key:s.getBytes(t.mac_key_length),server_write_MAC_key:s.getBytes(t.mac_key_length),client_write_key:s.getBytes(t.enc_key_length),server_write_key:s.getBytes(t.enc_key_length)};return a&&(o.client_write_IV=s.getBytes(t.fixed_iv_length),o.server_write_IV=s.getBytes(t.fixed_iv_length)),o};g.createConnectionState=function(e){var t=e.entity===g.ConnectionEnd.client,n=function(){var a={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(s){return!0},compressionState:null,compressFunction:function(s){return!0},updateSequenceNumber:function(){a.sequenceNumber[1]===4294967295?(a.sequenceNumber[1]=0,++a.sequenceNumber[0]):++a.sequenceNumber[1]}};return a},r={read:n(),write:n()};if(r.read.update=function(a,s){return r.read.cipherFunction(s,r.read)?r.read.compressFunction(a,s,r.read)||a.error(a,{message:"Could not decompress record.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.decompression_failure}}):a.error(a,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.bad_record_mac}}),!a.fail},r.write.update=function(a,s){return r.write.compressFunction(a,s,r.write)?r.write.cipherFunction(s,r.write)||a.error(a,{message:"Could not encrypt record.",send:!1,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.internal_error}}):a.error(a,{message:"Could not compress record.",send:!1,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.internal_error}}),!a.fail},e.session){var i=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(i),i.keys=g.generateKeys(e,i),r.read.macKey=t?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,r.write.macKey=t?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(r,e,i),i.compression_algorithm){case g.CompressionMethod.none:break;case g.CompressionMethod.deflate:r.read.compressFunction=tv,r.write.compressFunction=ev;break;default:throw new Error("Unsupported compression algorithm.")}}return r};g.createRandom=function(){var e=new Date,t=+e+e.getTimezoneOffset()*6e4,n=U.util.createBuffer();return n.putInt32(t),n.putBytes(U.random.getBytes(28)),n};g.createRecord=function(e,t){if(!t.data)return null;var n={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return n};g.createAlert=function(e,t){var n=U.util.createBuffer();return n.putByte(t.level),n.putByte(t.description),g.createRecord(e,{type:g.ContentType.alert,data:n})};g.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=U.util.createBuffer(),n=0;n<e.cipherSuites.length;++n){var r=e.cipherSuites[n];t.putByte(r.id[0]),t.putByte(r.id[1])}var i=t.length(),a=U.util.createBuffer();a.putByte(g.CompressionMethod.none);var s=a.length(),o=U.util.createBuffer();if(e.virtualHost){var u=U.util.createBuffer();u.putByte(0),u.putByte(0);var c=U.util.createBuffer();c.putByte(0),xt(c,2,U.util.createBuffer(e.virtualHost));var l=U.util.createBuffer();xt(l,2,c),xt(u,2,l),o.putBuffer(u)}var f=o.length();f>0&&(f+=2);var d=e.session.id,v=d.length+1+2+4+28+2+i+1+s+f,h=U.util.createBuffer();return h.putByte(g.HandshakeType.client_hello),h.putInt24(v),h.putByte(e.version.major),h.putByte(e.version.minor),h.putBytes(e.session.sp.client_random),xt(h,1,U.util.createBuffer(d)),xt(h,2,t),xt(h,1,a),f>0&&xt(h,2,o),h};g.createServerHello=function(e){var t=e.session.id,n=t.length+1+2+4+28+2+1,r=U.util.createBuffer();return r.putByte(g.HandshakeType.server_hello),r.putInt24(n),r.putByte(e.version.major),r.putByte(e.version.minor),r.putBytes(e.session.sp.server_random),xt(r,1,U.util.createBuffer(t)),r.putByte(e.session.cipherSuite.id[0]),r.putByte(e.session.cipherSuite.id[1]),r.putByte(e.session.compressionMethod),r};g.createCertificate=function(e){var t=e.entity===g.ConnectionEnd.client,n=null;if(e.getCertificate){var r;t?r=e.session.certificateRequest:r=e.session.extensions.server_name.serverNameList,n=e.getCertificate(e,r)}var i=U.util.createBuffer();if(n!==null)try{U.util.isArray(n)||(n=[n]);for(var a=null,s=0;s<n.length;++s){var o=U.pem.decode(n[s])[0];if(o.type!=="CERTIFICATE"&&o.type!=="X509 CERTIFICATE"&&o.type!=="TRUSTED CERTIFICATE"){var u=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw u.headerType=o.type,u}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=U.util.createBuffer(o.body);a===null&&(a=U.asn1.fromDer(c.bytes(),!1));var l=U.util.createBuffer();xt(l,3,c),i.putBuffer(l)}n=U.pki.certificateFromAsn1(a),t?e.session.clientCertificate=n:e.session.serverCertificate=n}catch(v){return e.error(e,{message:"Could not send certificate list.",cause:v,send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.bad_certificate}})}var f=3+i.length(),d=U.util.createBuffer();return d.putByte(g.HandshakeType.certificate),d.putInt24(f),xt(d,3,i),d};g.createClientKeyExchange=function(e){var t=U.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(U.random.getBytes(46));var n=e.session.sp;n.pre_master_secret=t.getBytes();var r=e.session.serverCertificate.publicKey;t=r.encrypt(n.pre_master_secret);var i=t.length+2,a=U.util.createBuffer();return a.putByte(g.HandshakeType.client_key_exchange),a.putInt24(i),a.putInt16(t.length),a.putBytes(t),a};g.createServerKeyExchange=function(e){var t=U.util.createBuffer();return t};g.getClientSignature=function(e,t){var n=U.util.createBuffer();n.putBuffer(e.session.md5.digest()),n.putBuffer(e.session.sha1.digest()),n=n.getBytes(),e.getSignature=e.getSignature||function(r,i,a){var s=null;if(r.getPrivateKey)try{s=r.getPrivateKey(r,r.session.clientCertificate),s=U.pki.privateKeyFromPem(s)}catch(o){r.error(r,{message:"Could not get private key.",cause:o,send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.internal_error}})}s===null?r.error(r,{message:"No private key set.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.internal_error}}):i=s.sign(i,null),a(r,i)},e.getSignature(e,n,t)};g.createCertificateVerify=function(e,t){var n=t.length+2,r=U.util.createBuffer();return r.putByte(g.HandshakeType.certificate_verify),r.putInt24(n),r.putInt16(t.length),r.putBytes(t),r};g.createCertificateRequest=function(e){var t=U.util.createBuffer();t.putByte(1);var n=U.util.createBuffer();for(var r in e.caStore.certs){var i=e.caStore.certs[r],a=U.pki.distinguishedNameToAsn1(i.subject),s=U.asn1.toDer(a);n.putInt16(s.length()),n.putBuffer(s)}var o=1+t.length()+2+n.length(),u=U.util.createBuffer();return u.putByte(g.HandshakeType.certificate_request),u.putInt24(o),xt(u,1,t),xt(u,2,n),u};g.createServerHelloDone=function(e){var t=U.util.createBuffer();return t.putByte(g.HandshakeType.server_hello_done),t.putInt24(0),t};g.createChangeCipherSpec=function(){var e=U.util.createBuffer();return e.putByte(1),e};g.createFinished=function(e){var t=U.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var n=e.entity===g.ConnectionEnd.client,r=e.session.sp,i=12,a=Oa,s=n?"client finished":"server finished";t=a(r.master_secret,s,t.getBytes(),i);var o=U.util.createBuffer();return o.putByte(g.HandshakeType.finished),o.putInt24(t.length()),o.putBuffer(t),o};g.createHeartbeat=function(e,t,n){typeof n>"u"&&(n=t.length);var r=U.util.createBuffer();r.putByte(e),r.putInt16(n),r.putBytes(t);var i=r.length(),a=Math.max(16,i-n-3);return r.putBytes(U.random.getBytes(a)),r};g.queue=function(e,t){if(t&&!(t.fragment.length()===0&&(t.type===g.ContentType.handshake||t.type===g.ContentType.alert||t.type===g.ContentType.change_cipher_spec))){if(t.type===g.ContentType.handshake){var n=t.fragment.bytes();e.session.md5.update(n),e.session.sha1.update(n),n=null}var r;if(t.fragment.length()<=g.MaxFragment)r=[t];else{r=[];for(var i=t.fragment.bytes();i.length>g.MaxFragment;)r.push(g.createRecord(e,{type:t.type,data:U.util.createBuffer(i.slice(0,g.MaxFragment))})),i=i.slice(g.MaxFragment);i.length>0&&r.push(g.createRecord(e,{type:t.type,data:U.util.createBuffer(i)}))}for(var a=0;a<r.length&&!e.fail;++a){var s=r[a],o=e.state.current.write;o.update(e,s)&&e.records.push(s)}}};g.flush=function(e){for(var t=0;t<e.records.length;++t){var n=e.records[t];e.tlsData.putByte(n.type),e.tlsData.putByte(n.version.major),e.tlsData.putByte(n.version.minor),e.tlsData.putInt16(n.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var gs=function(e){switch(e){case!0:return!0;case U.pki.certificateError.bad_certificate:return g.Alert.Description.bad_certificate;case U.pki.certificateError.unsupported_certificate:return g.Alert.Description.unsupported_certificate;case U.pki.certificateError.certificate_revoked:return g.Alert.Description.certificate_revoked;case U.pki.certificateError.certificate_expired:return g.Alert.Description.certificate_expired;case U.pki.certificateError.certificate_unknown:return g.Alert.Description.certificate_unknown;case U.pki.certificateError.unknown_ca:return g.Alert.Description.unknown_ca;default:return g.Alert.Description.bad_certificate}},mv=function(e){switch(e){case!0:return!0;case g.Alert.Description.bad_certificate:return U.pki.certificateError.bad_certificate;case g.Alert.Description.unsupported_certificate:return U.pki.certificateError.unsupported_certificate;case g.Alert.Description.certificate_revoked:return U.pki.certificateError.certificate_revoked;case g.Alert.Description.certificate_expired:return U.pki.certificateError.certificate_expired;case g.Alert.Description.certificate_unknown:return U.pki.certificateError.certificate_unknown;case g.Alert.Description.unknown_ca:return U.pki.certificateError.unknown_ca;default:return U.pki.certificateError.bad_certificate}};g.verifyCertificateChain=function(e,t){try{var n={};for(var r in e.verifyOptions)n[r]=e.verifyOptions[r];n.verify=function(a,s,o){var u=gs(a),c=e.verify(e,a,s,o);if(c!==!0){if(typeof c=="object"&&!U.util.isArray(c)){var l=new Error("The application rejected the certificate.");throw l.send=!0,l.alert={level:g.Alert.Level.fatal,description:g.Alert.Description.bad_certificate},c.message&&(l.message=c.message),c.alert&&(l.alert.description=c.alert),l}c!==a&&(c=mv(c))}return c},U.pki.verifyCertificateChain(e.caStore,t,n)}catch(a){var i=a;(typeof i!="object"||U.util.isArray(i))&&(i={send:!0,alert:{level:g.Alert.Level.fatal,description:gs(a)}}),"send"in i||(i.send=!0),"alert"in i||(i.alert={level:g.Alert.Level.fatal,description:gs(i.error)}),e.error(e,i)}return!e.fail};g.createSessionCache=function(e,t){var n=null;if(e&&e.getSession&&e.setSession&&e.order)n=e;else{n={},n.cache=e||{},n.capacity=Math.max(t||100,1),n.order=[];for(var r in e)n.order.length<=t?n.order.push(r):delete e[r];n.getSession=function(i){var a=null,s=null;if(i?s=U.util.bytesToHex(i):n.order.length>0&&(s=n.order[0]),s!==null&&s in n.cache){a=n.cache[s],delete n.cache[s];for(var o in n.order)if(n.order[o]===s){n.order.splice(o,1);break}}return a},n.setSession=function(i,a){if(n.order.length===n.capacity){var s=n.order.shift();delete n.cache[s]}var s=U.util.bytesToHex(i);n.order.push(s),n.cache[s]=a}}return n};g.createConnection=function(e){var t=null;e.caStore?U.util.isArray(e.caStore)?t=U.pki.createCaStore(e.caStore):t=e.caStore:t=U.pki.createCaStore();var n=e.cipherSuites||null;if(n===null){n=[];for(var r in g.CipherSuites)n.push(g.CipherSuites[r])}var i=e.server?g.ConnectionEnd.server:g.ConnectionEnd.client,a=e.sessionCache?g.createSessionCache(e.sessionCache):null,s={version:{major:g.Version.major,minor:g.Version.minor},entity:i,sessionId:e.sessionId,caStore:t,sessionCache:a,cipherSuites:n,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(l,f,d,v){return f},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:U.util.createBuffer(),tlsData:U.util.createBuffer(),data:U.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(l,f){f.origin=f.origin||(l.entity===g.ConnectionEnd.client?"client":"server"),f.send&&(g.queue(l,g.createAlert(l,f.alert)),g.flush(l));var d=f.fatal!==!1;d&&(l.fail=!0),e.error(l,f),d&&l.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null};s.reset=function(l){s.version={major:g.Version.major,minor:g.Version.minor},s.record=null,s.session=null,s.peerCertificate=null,s.state={pending:null,current:null},s.expect=s.entity===g.ConnectionEnd.client?rv:cv,s.fragmented=null,s.records=[],s.open=!1,s.handshakes=0,s.handshaking=!1,s.isConnected=!1,s.fail=!(l||typeof l>"u"),s.input.clear(),s.tlsData.clear(),s.data.clear(),s.state.current=g.createConnectionState(s)},s.reset();var o=function(l,f){var d=f.type-g.ContentType.change_cipher_spec,v=Ho[l.entity][l.expect];d in v?v[d](l,f):g.handleUnexpected(l,f)},u=function(l){var f=0,d=l.input,v=d.length();if(v<5)f=5-v;else{l.record={type:d.getByte(),version:{major:d.getByte(),minor:d.getByte()},length:d.getInt16(),fragment:U.util.createBuffer(),ready:!1};var h=l.record.version.major===l.version.major;h&&l.session&&l.session.version&&(h=l.record.version.minor===l.version.minor),h||l.error(l,{message:"Incompatible TLS version.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.protocol_version}})}return f},c=function(l){var f=0,d=l.input,v=d.length();if(v<l.record.length)f=l.record.length-v;else{l.record.fragment.putBytes(d.getBytes(l.record.length)),d.compact();var h=l.state.current.read;h.update(l,l.record)&&(l.fragmented!==null&&(l.fragmented.type===l.record.type?(l.fragmented.fragment.putBuffer(l.record.fragment),l.record=l.fragmented):l.error(l,{message:"Invalid fragmented record.",send:!0,alert:{level:g.Alert.Level.fatal,description:g.Alert.Description.unexpected_message}})),l.record.ready=!0)}return f};return s.handshake=function(l){if(s.entity!==g.ConnectionEnd.client)s.error(s,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(s.handshaking)s.error(s,{message:"Handshake already in progress.",fatal:!1});else{s.fail&&!s.open&&s.handshakes===0&&(s.fail=!1),s.handshaking=!0,l=l||"";var f=null;l.length>0&&(s.sessionCache&&(f=s.sessionCache.getSession(l)),f===null&&(l="")),l.length===0&&s.sessionCache&&(f=s.sessionCache.getSession(),f!==null&&(l=f.id)),s.session={id:l,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:U.md.md5.create(),sha1:U.md.sha1.create()},f&&(s.version=f.version,s.session.sp=f.sp),s.session.sp.client_random=g.createRandom().getBytes(),s.open=!0,g.queue(s,g.createRecord(s,{type:g.ContentType.handshake,data:g.createClientHello(s)})),g.flush(s)}},s.process=function(l){var f=0;return l&&s.input.putBytes(l),s.fail||(s.record!==null&&s.record.ready&&s.record.fragment.isEmpty()&&(s.record=null),s.record===null&&(f=u(s)),!s.fail&&s.record!==null&&!s.record.ready&&(f=c(s)),!s.fail&&s.record!==null&&s.record.ready&&o(s,s.record)),f},s.prepare=function(l){return g.queue(s,g.createRecord(s,{type:g.ContentType.application_data,data:U.util.createBuffer(l)})),g.flush(s)},s.prepareHeartbeatRequest=function(l,f){return l instanceof U.util.ByteBuffer&&(l=l.bytes()),typeof f>"u"&&(f=l.length),s.expectedHeartbeatPayload=l,g.queue(s,g.createRecord(s,{type:g.ContentType.heartbeat,data:g.createHeartbeat(g.HeartbeatMessageType.heartbeat_request,l,f)})),g.flush(s)},s.close=function(l){if(!s.fail&&s.sessionCache&&s.session){var f={id:s.session.id,version:s.session.version,sp:s.session.sp};f.sp.keys=null,s.sessionCache.setSession(f.id,f)}s.open&&(s.open=!1,s.input.clear(),(s.isConnected||s.handshaking)&&(s.isConnected=s.handshaking=!1,g.queue(s,g.createAlert(s,{level:g.Alert.Level.warning,description:g.Alert.Description.close_notify})),g.flush(s)),s.closed(s)),s.reset(l)},s};U.tls=U.tls||{};for(var vs in g)typeof g[vs]!="function"&&(U.tls[vs]=g[vs]);U.tls.prf_tls1=Oa;U.tls.hmac_sha1=Zg;U.tls.createSessionCache=g.createSessionCache;U.tls.createConnection=g.createConnection;var Br=se,_t=Br.tls;_t.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=_t.BulkCipherAlgorithm.aes,e.cipher_type=_t.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=_t.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Ql};_t.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=_t.BulkCipherAlgorithm.aes,e.cipher_type=_t.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=_t.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Ql};function Ql(e,t,n){var r=t.entity===Br.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:Br.cipher.createDecipher("AES-CBC",r?n.keys.server_write_key:n.keys.client_write_key),iv:r?n.keys.server_write_IV:n.keys.client_write_IV},e.write.cipherState={init:!1,cipher:Br.cipher.createCipher("AES-CBC",r?n.keys.client_write_key:n.keys.server_write_key),iv:r?n.keys.client_write_IV:n.keys.server_write_IV},e.read.cipherFunction=Cv,e.write.cipherFunction=bv,e.read.macLength=e.write.macLength=n.mac_length,e.read.macFunction=e.write.macFunction=_t.hmac_sha1}function bv(e,t){var n=!1,r=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(r),t.updateSequenceNumber();var i;e.version.minor===_t.Versions.TLS_1_0.minor?i=t.cipherState.init?null:t.cipherState.iv:i=Br.random.getBytesSync(16),t.cipherState.init=!0;var a=t.cipherState.cipher;return a.start({iv:i}),e.version.minor>=_t.Versions.TLS_1_1.minor&&a.output.putBytes(i),a.update(e.fragment),a.finish(Sv)&&(e.fragment=a.output,e.length=e.fragment.length(),n=!0),n}function Sv(e,t,n){if(!n){var r=e-t.length()%e;t.fillWithByte(r-1,r)}return!0}function Ev(e,t,n){var r=!0;if(n){for(var i=t.length(),a=t.last(),s=i-1-a;s<i-1;++s)r=r&&t.at(s)==a;r&&t.truncate(a+1)}return r}function Cv(e,t){var n=!1,r;e.version.minor===_t.Versions.TLS_1_0.minor?r=t.cipherState.init?null:t.cipherState.iv:r=e.fragment.getBytes(16),t.cipherState.init=!0;var i=t.cipherState.cipher;i.start({iv:r}),i.update(e.fragment),n=i.finish(Ev);var a=t.macLength,s=Br.random.getBytesSync(a),o=i.output.length();o>=a?(e.fragment=i.output.getBytes(o-a),s=i.output.getBytes(a)):e.fragment=i.output.getBytes(),e.fragment=Br.util.createBuffer(e.fragment),e.length=e.fragment.length();var u=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),n=wv(t.macKey,s,u)&&n,n}function wv(e,t,n){var r=Br.hmac.create();return r.start("SHA1",e),r.update(t),t=r.digest().getBytes(),r.start(null,null),r.update(n),n=r.digest().getBytes(),t===n}var xe=se,_i=xe.sha512=xe.sha512||{};xe.md.sha512=xe.md.algorithms.sha512=_i;var Yl=xe.sha384=xe.sha512.sha384=xe.sha512.sha384||{};Yl.create=function(){return _i.create("SHA-384")};xe.md.sha384=xe.md.algorithms.sha384=Yl;xe.sha512.sha256=xe.sha512.sha256||{create:function(){return _i.create("SHA-512/256")}};xe.md["sha512/256"]=xe.md.algorithms["sha512/256"]=xe.sha512.sha256;xe.sha512.sha224=xe.sha512.sha224||{create:function(){return _i.create("SHA-512/224")}};xe.md["sha512/224"]=xe.md.algorithms["sha512/224"]=xe.sha512.sha224;_i.create=function(e){if(Xl||Tv(),typeof e>"u"&&(e="SHA-512"),!(e in Wr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Wr[e],n=null,r=xe.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(e){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var u=o.messageLengthSize/4,c=0;c<u;++c)o.fullMessageLength.push(0);r=xe.util.createBuffer(),n=new Array(t.length);for(var c=0;c<t.length;++c)n[c]=t[c].slice(0);return o},o.start(),o.update=function(u,c){c==="utf8"&&(u=xe.util.encodeUtf8(u));var l=u.length;o.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var f=o.fullMessageLength.length-1;f>=0;--f)o.fullMessageLength[f]+=l[1],l[1]=l[0]+(o.fullMessageLength[f]/4294967296>>>0),o.fullMessageLength[f]=o.fullMessageLength[f]>>>0,l[0]=l[1]/4294967296>>>0;return r.putBytes(u),ic(n,i,r),(r.read>2048||r.length()===0)&&r.compact(),o},o.digest=function(){var u=xe.util.createBuffer();u.putBytes(r.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,l=c&o.blockLength-1;u.putBytes(Qs.substr(0,o.blockLength-l));for(var f,d,v=o.fullMessageLength[0]*8,h=0;h<o.fullMessageLength.length-1;++h)f=o.fullMessageLength[h+1]*8,d=f/4294967296>>>0,v+=d,u.putInt32(v>>>0),v=f>>>0;u.putInt32(v);for(var m=new Array(n.length),h=0;h<n.length;++h)m[h]=n[h].slice(0);ic(m,i,u);var b=xe.util.createBuffer(),E;e==="SHA-512"?E=m.length:e==="SHA-384"?E=m.length-2:E=m.length-4;for(var h=0;h<E;++h)b.putInt32(m[h][0]),(h!==E-1||e!=="SHA-512/224")&&b.putInt32(m[h][1]);return b},o};var Qs=null,Xl=!1,Ys=null,Wr=null;function Tv(){Qs=String.fromCharCode(128),Qs+=xe.util.fillString(String.fromCharCode(0),128),Ys=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Wr={},Wr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Wr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Wr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Wr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Xl=!0}function ic(e,t,n){for(var r,i,a,s,o,u,c,l,f,d,v,h,m,b,E,x,A,B,_,L,W,te,re,P,T,D,q,Y,z,ie,V,je,Ut,Ae,Re,Le=n.length();Le>=128;){for(z=0;z<16;++z)t[z][0]=n.getInt32()>>>0,t[z][1]=n.getInt32()>>>0;for(;z<80;++z)je=t[z-2],ie=je[0],V=je[1],r=((ie>>>19|V<<13)^(V>>>29|ie<<3)^ie>>>6)>>>0,i=((ie<<13|V>>>19)^(V<<3|ie>>>29)^(ie<<26|V>>>6))>>>0,Ae=t[z-15],ie=Ae[0],V=Ae[1],a=((ie>>>1|V<<31)^(ie>>>8|V<<24)^ie>>>7)>>>0,s=((ie<<31|V>>>1)^(ie<<24|V>>>8)^(ie<<25|V>>>7))>>>0,Ut=t[z-7],Re=t[z-16],V=i+Ut[1]+s+Re[1],t[z][0]=r+Ut[0]+a+Re[0]+(V/4294967296>>>0)>>>0,t[z][1]=V>>>0;for(m=e[0][0],b=e[0][1],E=e[1][0],x=e[1][1],A=e[2][0],B=e[2][1],_=e[3][0],L=e[3][1],W=e[4][0],te=e[4][1],re=e[5][0],P=e[5][1],T=e[6][0],D=e[6][1],q=e[7][0],Y=e[7][1],z=0;z<80;++z)c=((W>>>14|te<<18)^(W>>>18|te<<14)^(te>>>9|W<<23))>>>0,l=((W<<18|te>>>14)^(W<<14|te>>>18)^(te<<23|W>>>9))>>>0,f=(T^W&(re^T))>>>0,d=(D^te&(P^D))>>>0,o=((m>>>28|b<<4)^(b>>>2|m<<30)^(b>>>7|m<<25))>>>0,u=((m<<4|b>>>28)^(b<<30|m>>>2)^(b<<25|m>>>7))>>>0,v=(m&E|A&(m^E))>>>0,h=(b&x|B&(b^x))>>>0,V=Y+l+d+Ys[z][1]+t[z][1],r=q+c+f+Ys[z][0]+t[z][0]+(V/4294967296>>>0)>>>0,i=V>>>0,V=u+h,a=o+v+(V/4294967296>>>0)>>>0,s=V>>>0,q=T,Y=D,T=re,D=P,re=W,P=te,V=L+i,W=_+r+(V/4294967296>>>0)>>>0,te=V>>>0,_=A,L=B,A=E,B=x,E=m,x=b,V=i+s,m=r+a+(V/4294967296>>>0)>>>0,b=V>>>0;V=e[0][1]+b,e[0][0]=e[0][0]+m+(V/4294967296>>>0)>>>0,e[0][1]=V>>>0,V=e[1][1]+x,e[1][0]=e[1][0]+E+(V/4294967296>>>0)>>>0,e[1][1]=V>>>0,V=e[2][1]+B,e[2][0]=e[2][0]+A+(V/4294967296>>>0)>>>0,e[2][1]=V>>>0,V=e[3][1]+L,e[3][0]=e[3][0]+_+(V/4294967296>>>0)>>>0,e[3][1]=V>>>0,V=e[4][1]+te,e[4][0]=e[4][0]+W+(V/4294967296>>>0)>>>0,e[4][1]=V>>>0,V=e[5][1]+P,e[5][0]=e[5][0]+re+(V/4294967296>>>0)>>>0,e[5][1]=V>>>0,V=e[6][1]+D,e[6][0]=e[6][0]+T+(V/4294967296>>>0)>>>0,e[6][1]=V>>>0,V=e[7][1]+Y,e[7][0]=e[7][0]+q+(V/4294967296>>>0)>>>0,e[7][1]=V>>>0,Le-=128}}var jo={},xv=se,De=xv.asn1;jo.privateKeyValidator={name:"PrivateKeyInfo",tagClass:De.Class.UNIVERSAL,type:De.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:De.Class.UNIVERSAL,type:De.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:De.Class.UNIVERSAL,type:De.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:De.Class.UNIVERSAL,type:De.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:De.Class.UNIVERSAL,type:De.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};jo.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:De.Class.UNIVERSAL,type:De.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:De.Class.UNIVERSAL,type:De.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:De.Class.UNIVERSAL,type:De.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:De.Class.UNIVERSAL,type:De.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]};var He=se,Jl=jo,Av=Jl.publicKeyValidator,Iv=Jl.privateKeyValidator;if(typeof Bv>"u")var Bv=He.jsbn.BigInteger;var Xs=He.util.ByteBuffer,gt=typeof R.Buffer>"u"?Uint8Array:R.Buffer;He.pki=He.pki||{};He.pki.ed25519=He.ed25519=He.ed25519||{};var ue=He.ed25519;ue.constants={};ue.constants.PUBLIC_KEY_BYTE_LENGTH=32;ue.constants.PRIVATE_KEY_BYTE_LENGTH=64;ue.constants.SEED_BYTE_LENGTH=32;ue.constants.SIGN_BYTE_LENGTH=64;ue.constants.HASH_BYTE_LENGTH=64;ue.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===void 0)t=He.random.getBytesSync(ue.constants.SEED_BYTE_LENGTH);else if(typeof t=="string"){if(t.length!==ue.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+ue.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=dr({message:t,encoding:"binary"});for(var n=new gt(ue.constants.PUBLIC_KEY_BYTE_LENGTH),r=new gt(ue.constants.PRIVATE_KEY_BYTE_LENGTH),i=0;i<32;++i)r[i]=t[i];return Nv(n,r),{publicKey:n,privateKey:r}};ue.privateKeyFromAsn1=function(e){var t={},n=[],r=He.asn1.validate(e,Iv,t,n);if(!r){var i=new Error("Invalid Key.");throw i.errors=n,i}var a=He.asn1.derToOid(t.privateKeyOid),s=He.oids.EdDSA25519;if(a!==s)throw new Error('Invalid OID "'+a+'"; OID must be "'+s+'".');var o=t.privateKey,u=dr({message:He.asn1.fromDer(o).value,encoding:"binary"});return{privateKeyBytes:u}};ue.publicKeyFromAsn1=function(e){var t={},n=[],r=He.asn1.validate(e,Av,t,n);if(!r){var i=new Error("Invalid Key.");throw i.errors=n,i}var a=He.asn1.derToOid(t.publicKeyOid),s=He.oids.EdDSA25519;if(a!==s)throw new Error('Invalid OID "'+a+'"; OID must be "'+s+'".');var o=t.ed25519PublicKey;if(o.length!==ue.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return dr({message:o,encoding:"binary"})};ue.publicKeyFromPrivateKey=function(e){e=e||{};var t=dr({message:e.privateKey,encoding:"binary"});if(t.length!==ue.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+ue.constants.PRIVATE_KEY_BYTE_LENGTH);for(var n=new gt(ue.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<n.length;++r)n[r]=t[32+r];return n};ue.sign=function(e){e=e||{};var t=dr(e),n=dr({message:e.privateKey,encoding:"binary"});if(n.length===ue.constants.SEED_BYTE_LENGTH){var r=ue.generateKeyPair({seed:n});n=r.privateKey}else if(n.length!==ue.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+ue.constants.SEED_BYTE_LENGTH+" or "+ue.constants.PRIVATE_KEY_BYTE_LENGTH);var i=new gt(ue.constants.SIGN_BYTE_LENGTH+t.length);Pv(i,t,t.length,n);for(var a=new gt(ue.constants.SIGN_BYTE_LENGTH),s=0;s<a.length;++s)a[s]=i[s];return a};ue.verify=function(e){e=e||{};var t=dr(e);if(e.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var n=dr({message:e.signature,encoding:"binary"});if(n.length!==ue.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+ue.constants.SIGN_BYTE_LENGTH);var r=dr({message:e.publicKey,encoding:"binary"});if(r.length!==ue.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+ue.constants.PUBLIC_KEY_BYTE_LENGTH);var i=new gt(ue.constants.SIGN_BYTE_LENGTH+t.length),a=new gt(ue.constants.SIGN_BYTE_LENGTH+t.length),s;for(s=0;s<ue.constants.SIGN_BYTE_LENGTH;++s)i[s]=n[s];for(s=0;s<t.length;++s)i[s+ue.constants.SIGN_BYTE_LENGTH]=t[s];return Lv(a,i,i.length,r)>=0};function dr(e){var t=e.message;if(t instanceof Uint8Array||t instanceof gt)return t;var n=e.encoding;if(t===void 0)if(e.md)t=e.md.digest().getBytes(),n="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof t=="string"&&!n)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof t=="string"){if(typeof R.Buffer<"u")return R.Buffer.from(t,n);t=new Xs(t,n)}else if(!(t instanceof Xs))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var r=new gt(t.length()),i=0;i<r.length;++i)r[i]=t.at(i);return r}var Js=ee(),ya=ee([1]),_v=ee([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),kv=ee([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),ac=ee([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),sc=ee([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),ms=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),Rv=ee([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function fi(e,t){var n=He.md.sha512.create(),r=new Xs(e);n.update(r.getBytes(t),"binary");var i=n.digest().getBytes();if(typeof R.Buffer<"u")return R.Buffer.from(i,"binary");for(var a=new gt(ue.constants.HASH_BYTE_LENGTH),s=0;s<64;++s)a[s]=i.charCodeAt(s);return a}function Nv(e,t){var n=[ee(),ee(),ee(),ee()],r,i=fi(t,32);for(i[0]&=248,i[31]&=127,i[31]|=64,Go(n,i),qo(e,n),r=0;r<32;++r)t[r+32]=e[r];return 0}function Pv(e,t,n,r){var i,a,s=new Float64Array(64),o=[ee(),ee(),ee(),ee()],u=fi(r,32);u[0]&=248,u[31]&=127,u[31]|=64;var c=n+64;for(i=0;i<n;++i)e[64+i]=t[i];for(i=0;i<32;++i)e[32+i]=u[32+i];var l=fi(e.subarray(32),n+32);for(Zs(l),Go(o,l),qo(e,o),i=32;i<64;++i)e[i]=r[i];var f=fi(e,n+64);for(Zs(f),i=32;i<64;++i)s[i]=0;for(i=0;i<32;++i)s[i]=l[i];for(i=0;i<32;++i)for(a=0;a<32;a++)s[i+a]+=f[i]*u[a];return Zl(e.subarray(32),s),c}function Lv(e,t,n,r){var i,a,s=new gt(32),o=[ee(),ee(),ee(),ee()],u=[ee(),ee(),ee(),ee()];if(a=-1,n<64||Uv(u,r))return-1;for(i=0;i<n;++i)e[i]=t[i];for(i=0;i<32;++i)e[i+32]=r[i];var c=fi(e,n);if(Zs(c),rf(o,u,c),Go(u,t.subarray(32)),eo(o,u),qo(s,o),n-=64,ef(t,0,s,0)){for(i=0;i<n;++i)e[i]=0;return-1}for(i=0;i<n;++i)e[i]=t[i+64];return a=n,a}function Zl(e,t){var n,r,i,a;for(r=63;r>=32;--r){for(n=0,i=r-32,a=r-12;i<a;++i)t[i]+=n-16*t[r]*ms[i-(r-32)],n=t[i]+128>>8,t[i]-=n*256;t[i]+=n,t[r]=0}for(n=0,i=0;i<32;++i)t[i]+=n-(t[31]>>4)*ms[i],n=t[i]>>8,t[i]&=255;for(i=0;i<32;++i)t[i]-=n*ms[i];for(r=0;r<32;++r)t[r+1]+=t[r]>>8,e[r]=t[r]&255}function Zs(e){for(var t=new Float64Array(64),n=0;n<64;++n)t[n]=e[n],e[n]=0;Zl(e,t)}function eo(e,t){var n=ee(),r=ee(),i=ee(),a=ee(),s=ee(),o=ee(),u=ee(),c=ee(),l=ee();fn(n,e[1],e[0]),fn(l,t[1],t[0]),Se(n,n,l),un(r,e[0],e[1]),un(l,t[0],t[1]),Se(r,r,l),Se(i,e[3],t[3]),Se(i,i,kv),Se(a,e[2],t[2]),un(a,a,a),fn(s,r,n),fn(o,a,i),un(u,a,i),un(c,r,n),Se(e[0],s,o),Se(e[1],c,u),Se(e[2],u,o),Se(e[3],s,c)}function oc(e,t,n){for(var r=0;r<4;++r)nf(e[r],t[r],n)}function qo(e,t){var n=ee(),r=ee(),i=ee();Fv(i,t[2]),Se(n,t[0],i),Se(r,t[1],i),ga(e,r),e[31]^=tf(n)<<7}function ga(e,t){var n,r,i,a=ee(),s=ee();for(n=0;n<16;++n)s[n]=t[n];for(bs(s),bs(s),bs(s),r=0;r<2;++r){for(a[0]=s[0]-65517,n=1;n<15;++n)a[n]=s[n]-65535-(a[n-1]>>16&1),a[n-1]&=65535;a[15]=s[15]-32767-(a[14]>>16&1),i=a[15]>>16&1,a[14]&=65535,nf(s,a,1-i)}for(n=0;n<16;n++)e[2*n]=s[n]&255,e[2*n+1]=s[n]>>8}function Uv(e,t){var n=ee(),r=ee(),i=ee(),a=ee(),s=ee(),o=ee(),u=ee();return Ar(e[2],ya),Ov(e[1],t),zr(i,e[1]),Se(a,i,_v),fn(i,i,e[2]),un(a,e[2],a),zr(s,a),zr(o,s),Se(u,o,s),Se(n,u,i),Se(n,n,a),Dv(n,n),Se(n,n,i),Se(n,n,a),Se(n,n,a),Se(e[0],n,a),zr(r,e[0]),Se(r,r,a),uc(r,i)&&Se(e[0],e[0],Rv),zr(r,e[0]),Se(r,r,a),uc(r,i)?-1:(tf(e[0])===t[31]>>7&&fn(e[0],Js,e[0]),Se(e[3],e[0],e[1]),0)}function Ov(e,t){var n;for(n=0;n<16;++n)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function Dv(e,t){var n=ee(),r;for(r=0;r<16;++r)n[r]=t[r];for(r=250;r>=0;--r)zr(n,n),r!==1&&Se(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}function uc(e,t){var n=new gt(32),r=new gt(32);return ga(n,e),ga(r,t),ef(n,0,r,0)}function ef(e,t,n,r){return Kv(e,t,n,r,32)}function Kv(e,t,n,r,i){var a,s=0;for(a=0;a<i;++a)s|=e[t+a]^n[r+a];return(1&s-1>>>8)-1}function tf(e){var t=new gt(32);return ga(t,e),t[0]&1}function rf(e,t,n){var r,i;for(Ar(e[0],Js),Ar(e[1],ya),Ar(e[2],ya),Ar(e[3],Js),i=255;i>=0;--i)r=n[i/8|0]>>(i&7)&1,oc(e,t,r),eo(t,e),eo(e,e),oc(e,t,r)}function Go(e,t){var n=[ee(),ee(),ee(),ee()];Ar(n[0],ac),Ar(n[1],sc),Ar(n[2],ya),Se(n[3],ac,sc),rf(e,n,t)}function Ar(e,t){var n;for(n=0;n<16;n++)e[n]=t[n]|0}function Fv(e,t){var n=ee(),r;for(r=0;r<16;++r)n[r]=t[r];for(r=253;r>=0;--r)zr(n,n),r!==2&&r!==4&&Se(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}function bs(e){var t,n,r=1;for(t=0;t<16;++t)n=e[t]+r+65535,r=Math.floor(n/65536),e[t]=n-r*65536;e[0]+=r-1+37*(r-1)}function nf(e,t,n){for(var r,i=~(n-1),a=0;a<16;++a)r=i&(e[a]^t[a]),e[a]^=r,t[a]^=r}function ee(e){var t,n=new Float64Array(16);if(e)for(t=0;t<e.length;++t)n[t]=e[t];return n}function un(e,t,n){for(var r=0;r<16;++r)e[r]=t[r]+n[r]}function fn(e,t,n){for(var r=0;r<16;++r)e[r]=t[r]-n[r]}function zr(e,t){Se(e,t,t)}function Se(e,t,n){var r,i,a=0,s=0,o=0,u=0,c=0,l=0,f=0,d=0,v=0,h=0,m=0,b=0,E=0,x=0,A=0,B=0,_=0,L=0,W=0,te=0,re=0,P=0,T=0,D=0,q=0,Y=0,z=0,ie=0,V=0,je=0,Ut=0,Ae=n[0],Re=n[1],Le=n[2],qe=n[3],Ge=n[4],We=n[5],ze=n[6],Qe=n[7],Ye=n[8],Xe=n[9],Je=n[10],Ze=n[11],et=n[12],tt=n[13],rt=n[14],nt=n[15];r=t[0],a+=r*Ae,s+=r*Re,o+=r*Le,u+=r*qe,c+=r*Ge,l+=r*We,f+=r*ze,d+=r*Qe,v+=r*Ye,h+=r*Xe,m+=r*Je,b+=r*Ze,E+=r*et,x+=r*tt,A+=r*rt,B+=r*nt,r=t[1],s+=r*Ae,o+=r*Re,u+=r*Le,c+=r*qe,l+=r*Ge,f+=r*We,d+=r*ze,v+=r*Qe,h+=r*Ye,m+=r*Xe,b+=r*Je,E+=r*Ze,x+=r*et,A+=r*tt,B+=r*rt,_+=r*nt,r=t[2],o+=r*Ae,u+=r*Re,c+=r*Le,l+=r*qe,f+=r*Ge,d+=r*We,v+=r*ze,h+=r*Qe,m+=r*Ye,b+=r*Xe,E+=r*Je,x+=r*Ze,A+=r*et,B+=r*tt,_+=r*rt,L+=r*nt,r=t[3],u+=r*Ae,c+=r*Re,l+=r*Le,f+=r*qe,d+=r*Ge,v+=r*We,h+=r*ze,m+=r*Qe,b+=r*Ye,E+=r*Xe,x+=r*Je,A+=r*Ze,B+=r*et,_+=r*tt,L+=r*rt,W+=r*nt,r=t[4],c+=r*Ae,l+=r*Re,f+=r*Le,d+=r*qe,v+=r*Ge,h+=r*We,m+=r*ze,b+=r*Qe,E+=r*Ye,x+=r*Xe,A+=r*Je,B+=r*Ze,_+=r*et,L+=r*tt,W+=r*rt,te+=r*nt,r=t[5],l+=r*Ae,f+=r*Re,d+=r*Le,v+=r*qe,h+=r*Ge,m+=r*We,b+=r*ze,E+=r*Qe,x+=r*Ye,A+=r*Xe,B+=r*Je,_+=r*Ze,L+=r*et,W+=r*tt,te+=r*rt,re+=r*nt,r=t[6],f+=r*Ae,d+=r*Re,v+=r*Le,h+=r*qe,m+=r*Ge,b+=r*We,E+=r*ze,x+=r*Qe,A+=r*Ye,B+=r*Xe,_+=r*Je,L+=r*Ze,W+=r*et,te+=r*tt,re+=r*rt,P+=r*nt,r=t[7],d+=r*Ae,v+=r*Re,h+=r*Le,m+=r*qe,b+=r*Ge,E+=r*We,x+=r*ze,A+=r*Qe,B+=r*Ye,_+=r*Xe,L+=r*Je,W+=r*Ze,te+=r*et,re+=r*tt,P+=r*rt,T+=r*nt,r=t[8],v+=r*Ae,h+=r*Re,m+=r*Le,b+=r*qe,E+=r*Ge,x+=r*We,A+=r*ze,B+=r*Qe,_+=r*Ye,L+=r*Xe,W+=r*Je,te+=r*Ze,re+=r*et,P+=r*tt,T+=r*rt,D+=r*nt,r=t[9],h+=r*Ae,m+=r*Re,b+=r*Le,E+=r*qe,x+=r*Ge,A+=r*We,B+=r*ze,_+=r*Qe,L+=r*Ye,W+=r*Xe,te+=r*Je,re+=r*Ze,P+=r*et,T+=r*tt,D+=r*rt,q+=r*nt,r=t[10],m+=r*Ae,b+=r*Re,E+=r*Le,x+=r*qe,A+=r*Ge,B+=r*We,_+=r*ze,L+=r*Qe,W+=r*Ye,te+=r*Xe,re+=r*Je,P+=r*Ze,T+=r*et,D+=r*tt,q+=r*rt,Y+=r*nt,r=t[11],b+=r*Ae,E+=r*Re,x+=r*Le,A+=r*qe,B+=r*Ge,_+=r*We,L+=r*ze,W+=r*Qe,te+=r*Ye,re+=r*Xe,P+=r*Je,T+=r*Ze,D+=r*et,q+=r*tt,Y+=r*rt,z+=r*nt,r=t[12],E+=r*Ae,x+=r*Re,A+=r*Le,B+=r*qe,_+=r*Ge,L+=r*We,W+=r*ze,te+=r*Qe,re+=r*Ye,P+=r*Xe,T+=r*Je,D+=r*Ze,q+=r*et,Y+=r*tt,z+=r*rt,ie+=r*nt,r=t[13],x+=r*Ae,A+=r*Re,B+=r*Le,_+=r*qe,L+=r*Ge,W+=r*We,te+=r*ze,re+=r*Qe,P+=r*Ye,T+=r*Xe,D+=r*Je,q+=r*Ze,Y+=r*et,z+=r*tt,ie+=r*rt,V+=r*nt,r=t[14],A+=r*Ae,B+=r*Re,_+=r*Le,L+=r*qe,W+=r*Ge,te+=r*We,re+=r*ze,P+=r*Qe,T+=r*Ye,D+=r*Xe,q+=r*Je,Y+=r*Ze,z+=r*et,ie+=r*tt,V+=r*rt,je+=r*nt,r=t[15],B+=r*Ae,_+=r*Re,L+=r*Le,W+=r*qe,te+=r*Ge,re+=r*We,P+=r*ze,T+=r*Qe,D+=r*Ye,q+=r*Xe,Y+=r*Je,z+=r*Ze,ie+=r*et,V+=r*tt,je+=r*rt,Ut+=r*nt,a+=38*_,s+=38*L,o+=38*W,u+=38*te,c+=38*re,l+=38*P,f+=38*T,d+=38*D,v+=38*q,h+=38*Y,m+=38*z,b+=38*ie,E+=38*V,x+=38*je,A+=38*Ut,i=1,r=a+i+65535,i=Math.floor(r/65536),a=r-i*65536,r=s+i+65535,i=Math.floor(r/65536),s=r-i*65536,r=o+i+65535,i=Math.floor(r/65536),o=r-i*65536,r=u+i+65535,i=Math.floor(r/65536),u=r-i*65536,r=c+i+65535,i=Math.floor(r/65536),c=r-i*65536,r=l+i+65535,i=Math.floor(r/65536),l=r-i*65536,r=f+i+65535,i=Math.floor(r/65536),f=r-i*65536,r=d+i+65535,i=Math.floor(r/65536),d=r-i*65536,r=v+i+65535,i=Math.floor(r/65536),v=r-i*65536,r=h+i+65535,i=Math.floor(r/65536),h=r-i*65536,r=m+i+65535,i=Math.floor(r/65536),m=r-i*65536,r=b+i+65535,i=Math.floor(r/65536),b=r-i*65536,r=E+i+65535,i=Math.floor(r/65536),E=r-i*65536,r=x+i+65535,i=Math.floor(r/65536),x=r-i*65536,r=A+i+65535,i=Math.floor(r/65536),A=r-i*65536,r=B+i+65535,i=Math.floor(r/65536),B=r-i*65536,a+=i-1+37*(i-1),i=1,r=a+i+65535,i=Math.floor(r/65536),a=r-i*65536,r=s+i+65535,i=Math.floor(r/65536),s=r-i*65536,r=o+i+65535,i=Math.floor(r/65536),o=r-i*65536,r=u+i+65535,i=Math.floor(r/65536),u=r-i*65536,r=c+i+65535,i=Math.floor(r/65536),c=r-i*65536,r=l+i+65535,i=Math.floor(r/65536),l=r-i*65536,r=f+i+65535,i=Math.floor(r/65536),f=r-i*65536,r=d+i+65535,i=Math.floor(r/65536),d=r-i*65536,r=v+i+65535,i=Math.floor(r/65536),v=r-i*65536,r=h+i+65535,i=Math.floor(r/65536),h=r-i*65536,r=m+i+65535,i=Math.floor(r/65536),m=r-i*65536,r=b+i+65535,i=Math.floor(r/65536),b=r-i*65536,r=E+i+65535,i=Math.floor(r/65536),E=r-i*65536,r=x+i+65535,i=Math.floor(r/65536),x=r-i*65536,r=A+i+65535,i=Math.floor(r/65536),A=r-i*65536,r=B+i+65535,i=Math.floor(r/65536),B=r-i*65536,a+=i-1+37*(i-1),e[0]=a,e[1]=s,e[2]=o,e[3]=u,e[4]=c,e[5]=l,e[6]=f,e[7]=d,e[8]=v,e[9]=h,e[10]=m,e[11]=b,e[12]=E,e[13]=x,e[14]=A,e[15]=B}var St=se;St.kem=St.kem||{};var cc=St.jsbn.BigInteger;St.kem.rsa={};St.kem.rsa.create=function(e,t){t=t||{};var n=t.prng||St.random,r={};return r.encrypt=function(i,a){var s=Math.ceil(i.n.bitLength()/8),o;do o=new cc(St.util.bytesToHex(n.getBytesSync(s)),16).mod(i.n);while(o.compareTo(cc.ONE)<=0);o=St.util.hexToBytes(o.toString(16));var u=s-o.length;u>0&&(o=St.util.fillString(String.fromCharCode(0),u)+o);var c=i.encrypt(o,"NONE"),l=e.generate(o,a);return{encapsulation:c,key:l}},r.decrypt=function(i,a,s){var o=i.decrypt(a,"NONE");return e.generate(o,s)},r};St.kem.kdf1=function(e,t){af(this,e,0,t||e.digestLength)};St.kem.kdf2=function(e,t){af(this,e,1,t||e.digestLength)};function af(e,t,n,r){e.generate=function(i,a){for(var s=new St.util.ByteBuffer,o=Math.ceil(a/r)+n,u=new St.util.ByteBuffer,c=n;c<o;++c){u.putInt32(c),t.start(),t.update(i+u.getBytes());var l=t.digest();s.putBytes(l.getBytes(r))}return s.truncate(s.length()-a),s.getBytes()}}var le=se;le.log=le.log||{};le.log.levels=["none","error","warning","info","debug","verbose","max"];var va={},to=[],di=null;le.log.LEVEL_LOCKED=2;le.log.NO_LEVEL_CHECK=4;le.log.INTERPOLATE=8;for(var Ir=0;Ir<le.log.levels.length;++Ir){var lc=le.log.levels[Ir];va[lc]={index:Ir,name:lc.toUpperCase()}}le.log.logMessage=function(e){for(var t=va[e.level].index,n=0;n<to.length;++n){var r=to[n];if(r.flags&le.log.NO_LEVEL_CHECK)r.f(e);else{var i=va[r.level].index;t<=i&&r.f(r,e)}}};le.log.prepareStandard=function(e){"standard"in e||(e.standard=va[e.level].name+" ["+e.category+"] "+e.message)};le.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]),e.full=le.util.format.apply(this,t)}};le.log.prepareStandardFull=function(e){"standardFull"in e||(le.log.prepareStandard(e),e.standardFull=e.standard)};for(var fc=["error","warning","info","debug","verbose"],Ir=0;Ir<fc.length;++Ir)(function(t){le.log[t]=function(n,r){var i=Array.prototype.slice.call(arguments).slice(2),a={timestamp:new Date,level:t,category:n,message:r,arguments:i};le.log.logMessage(a)}})(fc[Ir]);le.log.makeLogger=function(e){var t={flags:0,f:e};return le.log.setLevel(t,"none"),t};le.log.setLevel=function(e,t){var n=!1;if(e&&!(e.flags&le.log.LEVEL_LOCKED))for(var r=0;r<le.log.levels.length;++r){var i=le.log.levels[r];if(t==i){e.level=t,n=!0;break}}return n};le.log.lock=function(e,t){typeof t>"u"||t?e.flags|=le.log.LEVEL_LOCKED:e.flags&=~le.log.LEVEL_LOCKED};le.log.addLogger=function(e){to.push(e)};if(typeof console<"u"&&"log"in console){var Xn;if(console.error&&console.warn&&console.info&&console.debug){var Mv={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},Wo=function(e,t){le.log.prepareStandard(t);var n=Mv[t.level],r=[t.standard];r=r.concat(t.arguments.slice()),n.apply(console,r)};Xn=le.log.makeLogger(Wo)}else{var Wo=function(t,n){le.log.prepareStandardFull(n),console.log(n.standardFull)};Xn=le.log.makeLogger(Wo)}le.log.setLevel(Xn,"debug"),le.log.addLogger(Xn),di=Xn}else console={log:function(){}};if(di!==null&&typeof window<"u"&&window.location){var Fi=new URL(window.location.href).searchParams;if(Fi.has("console.level")&&le.log.setLevel(di,Fi.get("console.level").slice(-1)[0]),Fi.has("console.lock")){var Vv=Fi.get("console.lock").slice(-1)[0];Vv=="true"&&le.log.lock(di)}}le.log.consoleLogger=di;var M=se,C=M.asn1,ft=M.pkcs7=M.pkcs7||{};ft.messageFromPem=function(e){var t=M.pem.decode(e)[0];if(t.type!=="PKCS7"){var n=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw n.headerType=t.type,n}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var r=C.fromDer(t.body);return ft.messageFromAsn1(r)};ft.messageToPem=function(e,t){var n={type:"PKCS7",body:C.toDer(e.toAsn1()).getBytes()};return M.pem.encode(n,{maxline:t})};ft.messageFromAsn1=function(e){var t={},n=[];if(!C.validate(e,ft.asn1.contentInfoValidator,t,n)){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw r.errors=n,r}var i=C.derToOid(t.contentType),a;switch(i){case M.pki.oids.envelopedData:a=ft.createEnvelopedData();break;case M.pki.oids.encryptedData:a=ft.createEncryptedData();break;case M.pki.oids.signedData:a=ft.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a};ft.createSignedData=function(){var e=null;return e={type:M.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(r){if(zo(e,r,ft.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var i=e.rawCapture.certificates.value,a=0;a<i.length;++a)e.certificates.push(M.pki.certificateFromAsn1(i[a]))},toAsn1:function(){e.contentInfo||e.sign();for(var r=[],i=0;i<e.certificates.length;++i)r.push(M.pki.certificateToAsn1(e.certificates[i]));var a=[],s=C.create(C.Class.CONTEXT_SPECIFIC,0,!0,[C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,C.integerToDer(e.version).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return r.length>0&&s.value[0].value.push(C.create(C.Class.CONTEXT_SPECIFIC,0,!0,r)),a.length>0&&s.value[0].value.push(C.create(C.Class.CONTEXT_SPECIFIC,1,!0,a)),s.value[0].value.push(C.create(C.Class.UNIVERSAL,C.Type.SET,!0,e.signerInfos)),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(e.type).getBytes()),s])},addSigner:function(r){var i=r.issuer,a=r.serialNumber;if(r.certificate){var s=r.certificate;typeof s=="string"&&(s=M.pki.certificateFromPem(s)),i=s.issuer.attributes,a=s.serialNumber}var o=r.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof o=="string"&&(o=M.pki.privateKeyFromPem(o));var u=r.digestAlgorithm||M.pki.oids.sha1;switch(u){case M.pki.oids.sha1:case M.pki.oids.sha256:case M.pki.oids.sha384:case M.pki.oids.sha512:case M.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+u)}var c=r.authenticatedAttributes||[];if(c.length>0){for(var l=!1,f=!1,d=0;d<c.length;++d){var v=c[d];if(!l&&v.type===M.pki.oids.contentType){if(l=!0,f)break;continue}if(!f&&v.type===M.pki.oids.messageDigest){if(f=!0,l)break;continue}}if(!l||!f)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:i,serialNumber:a,digestAlgorithm:u,signatureAlgorithm:M.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(r){if(r=r||{},(typeof e.content!="object"||e.contentInfo===null)&&(e.contentInfo=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(M.pki.oids.data).getBytes())]),"content"in e)){var i;e.content instanceof M.util.ByteBuffer?i=e.content.bytes():typeof e.content=="string"&&(i=M.util.encodeUtf8(e.content)),r.detached?e.detachedContent=C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,i):e.contentInfo.value.push(C.create(C.Class.CONTEXT_SPECIFIC,0,!0,[C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,i)]))}if(e.signers.length!==0){var a=t();n(a)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(r){typeof r=="string"&&(r=M.pki.certificateFromPem(r)),e.certificates.push(r)},addCertificateRevokationList:function(r){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var r={},i=0;i<e.signers.length;++i){var a=e.signers[i],s=a.digestAlgorithm;s in r||(r[s]=M.md[M.pki.oids[s]].create()),a.authenticatedAttributes.length===0?a.md=r[s]:a.md=M.md[M.pki.oids[s]].create()}e.digestAlgorithmIdentifiers=[];for(var s in r)e.digestAlgorithmIdentifiers.push(C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(s).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,"")]));return r}function n(r){var i;if(e.detachedContent?i=e.detachedContent:(i=e.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var a=C.derToOid(e.contentInfo.value[0].value),s=C.toDer(i);s.getByte(),C.getBerValueLength(s),s=s.getBytes();for(var o in r)r[o].start().update(s);for(var u=new Date,c=0;c<e.signers.length;++c){var l=e.signers[c];if(l.authenticatedAttributes.length===0){if(a!==M.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=C.create(C.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=C.create(C.Class.UNIVERSAL,C.Type.SET,!0,[]),d=0;d<l.authenticatedAttributes.length;++d){var v=l.authenticatedAttributes[d];v.type===M.pki.oids.messageDigest?v.value=r[l.digestAlgorithm].digest():v.type===M.pki.oids.signingTime&&(v.value||(v.value=u)),f.value.push(ro(v)),l.authenticatedAttributesAsn1.value.push(ro(v))}s=C.toDer(f).getBytes(),l.md.start().update(s)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=Wv(e.signers)}};ft.createEncryptedData=function(){var e=null;return e={type:M.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:M.pki.oids["aes256-CBC"]},fromAsn1:function(t){zo(e,t,ft.asn1.encryptedDataValidator)},decrypt:function(t){t!==void 0&&(e.encryptedContent.key=t),sf(e)}},e};ft.createEnvelopedData=function(){var e=null;return e={type:M.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:M.pki.oids["aes256-CBC"]},fromAsn1:function(t){var n=zo(e,t,ft.asn1.envelopedDataValidator);e.recipients=jv(n.recipientInfos.value)},toAsn1:function(){return C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(e.type).getBytes()),C.create(C.Class.CONTEXT_SPECIFIC,0,!0,[C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,C.integerToDer(e.version).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SET,!0,qv(e.recipients)),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,zv(e.encryptedContent))])])])},findRecipient:function(t){for(var n=t.issuer.attributes,r=0;r<e.recipients.length;++r){var i=e.recipients[r],a=i.issuer;if(i.serialNumber===t.serialNumber&&a.length===n.length){for(var s=!0,o=0;o<n.length;++o)if(a[o].type!==n[o].type||a[o].value!==n[o].value){s=!1;break}if(s)return i}}return null},decrypt:function(t,n){if(e.encryptedContent.key===void 0&&t!==void 0&&n!==void 0)switch(t.encryptedContent.algorithm){case M.pki.oids.rsaEncryption:case M.pki.oids.desCBC:var r=n.decrypt(t.encryptedContent.content);e.encryptedContent.key=M.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}sf(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:M.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,n){if(e.encryptedContent.content===void 0){n=n||e.encryptedContent.algorithm,t=t||e.encryptedContent.key;var r,i,a;switch(n){case M.pki.oids["aes128-CBC"]:r=16,i=16,a=M.aes.createEncryptionCipher;break;case M.pki.oids["aes192-CBC"]:r=24,i=16,a=M.aes.createEncryptionCipher;break;case M.pki.oids["aes256-CBC"]:r=32,i=16,a=M.aes.createEncryptionCipher;break;case M.pki.oids["des-EDE3-CBC"]:r=24,i=8,a=M.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+n)}if(t===void 0)t=M.util.createBuffer(M.random.getBytes(r));else if(t.length()!=r)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+r+".");e.encryptedContent.algorithm=n,e.encryptedContent.key=t,e.encryptedContent.parameter=M.util.createBuffer(M.random.getBytes(i));var s=a(t);if(s.start(e.encryptedContent.parameter.copy()),s.update(e.content),!s.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=s.output}for(var o=0;o<e.recipients.length;++o){var u=e.recipients[o];if(u.encryptedContent.content===void 0)switch(u.encryptedContent.algorithm){case M.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}},e};function $v(e){var t={},n=[];if(!C.validate(e,ft.asn1.recipientInfoValidator,t,n)){var r=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw r.errors=n,r}return{version:t.version.charCodeAt(0),issuer:M.pki.RDNAttributesAsArray(t.issuer),serialNumber:M.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:C.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function Hv(e){return C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,C.integerToDer(e.version).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[M.pki.distinguishedNameToAsn1({attributes:e.issuer}),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,M.util.hexToBytes(e.serialNumber))]),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(e.encryptedContent.algorithm).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,"")]),C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function jv(e){for(var t=[],n=0;n<e.length;++n)t.push($v(e[n]));return t}function qv(e){for(var t=[],n=0;n<e.length;++n)t.push(Hv(e[n]));return t}function Gv(e){var t=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,C.integerToDer(e.version).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[M.pki.distinguishedNameToAsn1({attributes:e.issuer}),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,M.util.hexToBytes(e.serialNumber))]),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(e.digestAlgorithm).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(e.signatureAlgorithm).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,"")])),t.value.push(C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var n=C.create(C.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<e.unauthenticatedAttributes.length;++r){var i=e.unauthenticatedAttributes[r];n.values.push(ro(i))}t.value.push(n)}return t}function Wv(e){for(var t=[],n=0;n<e.length;++n)t.push(Gv(e[n]));return t}function ro(e){var t;if(e.type===M.pki.oids.contentType)t=C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(e.value).getBytes());else if(e.type===M.pki.oids.messageDigest)t=C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===M.pki.oids.signingTime){var n=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),i=e.value;if(typeof i=="string"){var a=Date.parse(i);isNaN(a)?i.length===13?i=C.utcTimeToDate(i):i=C.generalizedTimeToDate(i):i=new Date(a)}i>=n&&i<r?t=C.create(C.Class.UNIVERSAL,C.Type.UTCTIME,!1,C.dateToUtcTime(i)):t=C.create(C.Class.UNIVERSAL,C.Type.GENERALIZEDTIME,!1,C.dateToGeneralizedTime(i))}return C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(e.type).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SET,!0,[t])])}function zv(e){return[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(M.pki.oids.data).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(e.algorithm).getBytes()),e.parameter?C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),C.create(C.Class.CONTEXT_SPECIFIC,0,!0,[C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,e.content.getBytes())])]}function zo(e,t,n){var r={},i=[];if(!C.validate(t,n,r,i)){var a=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw a.errors=a,a}var s=C.derToOid(r.contentType);if(s!==M.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var o="";if(M.util.isArray(r.encryptedContent))for(var u=0;u<r.encryptedContent.length;++u){if(r.encryptedContent[u].type!==C.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=r.encryptedContent[u].value}else o=r.encryptedContent;e.encryptedContent={algorithm:C.derToOid(r.encAlgorithm),parameter:M.util.createBuffer(r.encParameter.value),content:M.util.createBuffer(o)}}if(r.content){var o="";if(M.util.isArray(r.content))for(var u=0;u<r.content.length;++u){if(r.content[u].type!==C.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=r.content[u].value}else o=r.content;e.content=M.util.createBuffer(o)}return e.version=r.version.charCodeAt(0),e.rawCapture=r,r}function sf(e){if(e.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(e.content===void 0){var t;switch(e.encryptedContent.algorithm){case M.pki.oids["aes128-CBC"]:case M.pki.oids["aes192-CBC"]:case M.pki.oids["aes256-CBC"]:t=M.aes.createDecryptionCipher(e.encryptedContent.key);break;case M.pki.oids.desCBC:case M.pki.oids["des-EDE3-CBC"]:t=M.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}var Ne=se,Da=Ne.ssh=Ne.ssh||{};Da.privateKeyToPutty=function(e,t,n){n=n||"",t=t||"";var r="ssh-rsa",i=t===""?"none":"aes256-cbc",a="PuTTY-User-Key-File-2: "+r+`\r
`;a+="Encryption: "+i+`\r
`,a+="Comment: "+n+`\r
`;var s=Ne.util.createBuffer();dn(s,r),Gt(s,e.e),Gt(s,e.n);var o=Ne.util.encode64(s.bytes(),64),u=Math.floor(o.length/66)+1;a+="Public-Lines: "+u+`\r
`,a+=o;var c=Ne.util.createBuffer();Gt(c,e.d),Gt(c,e.p),Gt(c,e.q),Gt(c,e.qInv);var l;if(!t)l=Ne.util.encode64(c.bytes(),64);else{var f=c.length()+16-1;f-=f%16;var d=Mi(c.bytes());d.truncate(d.length()-f+c.length()),c.putBuffer(d);var v=Ne.util.createBuffer();v.putBuffer(Mi("\0\0\0\0",t)),v.putBuffer(Mi("\0\0\0",t));var h=Ne.aes.createEncryptionCipher(v.truncate(8),"CBC");h.start(Ne.util.createBuffer().fillWithByte(0,16)),h.update(c.copy()),h.finish();var m=h.output;m.truncate(16),l=Ne.util.encode64(m.bytes(),64)}u=Math.floor(l.length/66)+1,a+=`\r
Private-Lines: `+u+`\r
`,a+=l;var b=Mi("putty-private-key-file-mac-key",t),E=Ne.util.createBuffer();dn(E,r),dn(E,i),dn(E,n),E.putInt32(s.length()),E.putBuffer(s),E.putInt32(c.length()),E.putBuffer(c);var x=Ne.hmac.create();return x.start("sha1",b),x.update(E.bytes()),a+=`\r
Private-MAC: `+x.digest().toHex()+`\r
`,a};Da.publicKeyToOpenSSH=function(e,t){var n="ssh-rsa";t=t||"";var r=Ne.util.createBuffer();return dn(r,n),Gt(r,e.e),Gt(r,e.n),n+" "+Ne.util.encode64(r.bytes())+" "+t};Da.privateKeyToOpenSSH=function(e,t){return t?Ne.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):Ne.pki.privateKeyToPem(e)};Da.getPublicKeyFingerprint=function(e,t){t=t||{};var n=t.md||Ne.md.md5.create(),r="ssh-rsa",i=Ne.util.createBuffer();dn(i,r),Gt(i,e.e),Gt(i,e.n),n.start(),n.update(i.getBytes());var a=n.digest();if(t.encoding==="hex"){var s=a.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return a};function Gt(e,t){var n=t.toString(16);n[0]>="8"&&(n="00"+n);var r=Ne.util.hexToBytes(n);e.putInt32(r.length),e.putBytes(r)}function dn(e,t){e.putInt32(t.length),e.putString(t)}function Mi(){for(var e=Ne.md.sha1.create(),t=arguments.length,n=0;n<t;++n)e.update(arguments[n]);return e.digest()}var hi=se;const rr=Nc(hi);var Qv=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};const Yv=rr.pki.rsa,of="RSA-OAEP",uf="794241bc819a125a7b78ea313decc0bc";function dc(e){const t=rr.pki.publicKeyToRSAPublicKeyPem(e.publicKey);return R.Buffer.from(t,"utf-8").toString("hex")}function Xv(e){return R.Buffer.from(e,"hex").toString("utf-8")}function hc(e,t){return Qv(this,void 0,void 0,function*(){const n=rr.random.createInstance();t&&(n.seedFileSync=i=>t,n.seedFile=(i,a)=>{a(null,t)});const r={bits:2048,e:65537,prng:n};if(!e.disableWorkers){r.workLoad=100,r.workers=t?1:-1;const i=yield fetch(`${Sr(e)}/static/js/prime.worker.min.js`),a=new Blob([yield i.text()],{type:"application/javascript"});r.workerScript=URL.createObjectURL(a)}return new Promise((i,a)=>Yv.generateKeyPair(r,(s,o)=>{s&&a(s),i(o)}))})}function Jv(e){const t=rr.random.getBytesSync(16),n=rr.cipher.createCipher("AES-CBC",t);n.start({iv:uf}),n.update(rr.util.createBuffer(e)),n.finish();const r=n.output.toHex();return{key:t,encryptedMessageHex:r}}function Zv(e,t,n){const r=R.Buffer.from(n,"hex").toString("utf-8"),i=e.privateKey.decrypt(r,of),a=rr.cipher.createDecipher("AES-CBC",i);return a.start({iv:uf}),a.update(rr.util.createBuffer(rr.util.hexToBytes(t))),a.finish(),a.output.toString()}function em(e,t){const{key:n,encryptedMessageHex:r}=Jv(t),i=Xv(e),s=rr.pki.publicKeyFromPem(i).encrypt(n,of),o=R.Buffer.from(s,"utf-8").toString("hex");return{encryptedMessageHex:r,encryptedKeyHex:o}}var ma={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ECIES=e.Decrypt=e.Encrypt=e.AES128DecryptAndHMAC=e.AES128Decrypt=e.AES128EncryptAndHMAC=e.AES128Encrypt=e.IV_LENGTH=void 0;var t=tn();e.IV_LENGTH=16;var n=function(l){for(var f=l.length-1;f>=0;f--)if(l[f]++,l[f]!==0)return l;return l},r=function(l,f){for(var d=32,v=(f+7)*8/(d*8),h=R.Buffer.from("00000001","hex"),m=R.Buffer.from("00","hex"),b=0;b<=v;b++){var E=(0,t.createHash)("sha256");E.update(h),E.update(l),m=R.Buffer.concat([m,E.digest()]),h=n(h)}return m.slice(1,f+1)};function i(l,f,d){var v=(0,t.createCipheriv)("aes-128-ctr",l,f),h=v.update(d),m=v.final();return R.Buffer.concat([f,h,m])}e.AES128Encrypt=i;function a(l,f,d){var v=(0,t.randomBytes)(e.IV_LENGTH),h=i(l,v,d),m=(0,t.createHmac)("sha256",f).update(h).digest();return R.Buffer.concat([h,m])}e.AES128EncryptAndHMAC=a;function s(l,f,d){var v=(0,t.createDecipheriv)("aes-128-ctr",l,f),h=v.update(d),m=v.final();return R.Buffer.concat([h,m])}e.AES128Decrypt=s;function o(l,f,d){var v=d.slice(0,e.IV_LENGTH),h=d.slice(e.IV_LENGTH,d.length-32),m=d.slice(d.length-32,d.length),b=R.Buffer.concat([v,h]),E=(0,t.createHmac)("sha256",f).update(b).digest();if(!m.equals(E))throw new Error("MAC mismatch");return s(l,v,h)}e.AES128DecryptAndHMAC=o;function u(l,f){var d=yi().ec,v=new d("secp256k1"),h=v.keyFromPrivate((0,t.randomBytes)(32)),m=h.getPublic(!1,"hex"),b=R.Buffer.from(m,"hex"),E=h.derive(v.keyFromPublic(R.Buffer.concat([R.Buffer.from([4]),l])).getPublic()),x=r(E.toArrayLike(R.Buffer),32),A=x.slice(0,16),B=(0,t.createHash)("sha256").update(x.slice(16)).digest(),_=a(A,B,f),L=R.Buffer.concat([b,_]);return L}e.Encrypt=u;function c(l,f){var d=f.slice(0,65),v=f.slice(65),h=yi().ec,m=new h("secp256k1"),b=m.keyFromPublic(d).getPublic(),E=m.keyFromPrivate(l).derive(b),x=r(E.toBuffer(),32),A=x.slice(0,16),B=(0,t.createHash)("sha256").update(x.slice(16)).digest();return o(A,B,v)}e.Decrypt=c,e.ECIES={Encrypt:u,Decrypt:c,AES128EncryptAndHMAC:a,AES128DecryptAndHMAC:o}})(ma);var Qo={},Yo={},vt={},_r={},tm=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_r,"__esModule",{value:!0});_r.getLength=_r.decode=_r.encode=void 0;var rm=tm(Ln);function cf(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(cf(e[n]));var r=R.Buffer.concat(t);return R.Buffer.concat([pc(r.length,192),r])}else{var i=Xo(e);return i.length===1&&i[0]<128?i:R.Buffer.concat([pc(i.length,128),i])}}_r.encode=cf;function no(e,t){if(e[0]==="0"&&e[1]==="0")throw new Error("invalid RLP: extra zeros");return parseInt(e,t)}function pc(e,t){if(e<56)return R.Buffer.from([e+t]);var n=ao(e),r=n.length/2,i=ao(t+55+r);return R.Buffer.from(i+n,"hex")}function nm(e,t){if(t===void 0&&(t=!1),!e||e.length===0)return R.Buffer.from([]);var n=Xo(e),r=io(n);if(t)return r;if(r.remainder.length!==0)throw new Error("invalid remainder");return r.data}_r.decode=nm;function im(e){if(!e||e.length===0)return R.Buffer.from([]);var t=Xo(e),n=t[0];if(n<=127)return t.length;if(n<=183)return n-127;if(n<=191)return n-182;if(n<=247)return n-191;var r=n-246,i=no(t.slice(1,r).toString("hex"),16);return r+i}_r.getLength=im;function io(e){var t,n,r,i,a,s=[],o=e[0];if(o<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(o<=183){if(t=o-127,o===128?r=R.Buffer.from([]):r=e.slice(1,t),t===2&&r[0]<128)throw new Error("invalid rlp encoding: byte must be less 0x80");return{data:r,remainder:e.slice(t)}}else if(o<=191){if(n=o-182,e.length-1<n)throw new Error("invalid RLP: not enough bytes for string length");if(t=no(e.slice(1,n).toString("hex"),16),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");if(r=e.slice(n,t+n),r.length<t)throw new Error("invalid RLP: not enough bytes for string");return{data:r,remainder:e.slice(t+n)}}else if(o<=247){for(t=o-191,i=e.slice(1,t);i.length;)a=io(i),s.push(a.data),i=a.remainder;return{data:s,remainder:e.slice(t)}}else{n=o-246,t=no(e.slice(1,n).toString("hex"),16);var u=n+t;if(u>e.length)throw new Error("invalid rlp: total length is larger than the data");if(i=e.slice(n,u),i.length===0)throw new Error("invalid rlp, List has a invalid length");for(;i.length;)a=io(i),s.push(a.data),i=a.remainder;return{data:s,remainder:e.slice(u)}}}function lf(e){return e.slice(0,2)==="0x"}function am(e){return typeof e!="string"?e:lf(e)?e.slice(2):e}function ao(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");var t=e.toString(16);return t.length%2?"0"+t:t}function sm(e){return e.length%2?"0"+e:e}function om(e){var t=ao(e);return R.Buffer.from(t,"hex")}function Xo(e){if(!R.Buffer.isBuffer(e)){if(typeof e=="string")return lf(e)?R.Buffer.from(sm(am(e)),"hex"):R.Buffer.from(e);if(typeof e=="number"||typeof e=="bigint")return e?om(e):R.Buffer.from([]);if(e==null)return R.Buffer.from([]);if(e instanceof Uint8Array)return R.Buffer.from(e);if(rm.default.isBN(e))return R.Buffer.from(e.toArray());throw new Error("invalid type")}return e}var um=G&&G.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),cm=G&&G.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),lm=G&&G.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&um(t,e,n);return cm(t,e),t},fm=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vt,"__esModule",{value:!0});vt.rlp=vt.BN=void 0;var dm=fm(Ln);vt.BN=dm.default;var hm=lm(_r);vt.rlp=hm;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.KECCAK256_RLP=e.KECCAK256_RLP_S=e.KECCAK256_RLP_ARRAY=e.KECCAK256_RLP_ARRAY_S=e.KECCAK256_NULL=e.KECCAK256_NULL_S=e.TWO_POW256=e.MAX_INTEGER=e.MAX_UINT64=void 0;var t=R,n=vt;e.MAX_UINT64=new n.BN("ffffffffffffffff",16),e.MAX_INTEGER=new n.BN("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),e.TWO_POW256=new n.BN("10000000000000000000000000000000000000000000000000000000000000000",16),e.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",e.KECCAK256_NULL=t.Buffer.from(e.KECCAK256_NULL_S,"hex"),e.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",e.KECCAK256_RLP_ARRAY=t.Buffer.from(e.KECCAK256_RLP_ARRAY_S,"hex"),e.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",e.KECCAK256_RLP=t.Buffer.from(e.KECCAK256_RLP_S,"hex")})(Yo);var Jo={},Zo={};const ve={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function Tt(e,t){if(!e)throw new Error(t)}function de(e,t,n){if(Tt(t instanceof Uint8Array,`Expected ${e} to be an Uint8Array`),n!==void 0)if(Array.isArray(n)){const r=n.join(", "),i=`Expected ${e} to be an Uint8Array with length [${r}]`;Tt(n.includes(t.length),i)}else{const r=`Expected ${e} to be an Uint8Array with length ${n}`;Tt(t.length===n,r)}}function Vr(e){Tt(cn(e)==="Boolean","Expected compressed to be a Boolean")}function Ot(e=n=>new Uint8Array(n),t){return typeof e=="function"&&(e=e(t)),de("output",e,t),e}function cn(e){return Object.prototype.toString.call(e).slice(8,-1)}var pm=e=>({contextRandomize(t){switch(Tt(t===null||t instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),t!==null&&de("seed",t,32),e.contextRandomize(t)){case 1:throw new Error(ve.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(t){return de("private key",t,32),e.privateKeyVerify(t)===0},privateKeyNegate(t){switch(de("private key",t,32),e.privateKeyNegate(t)){case 0:return t;case 1:throw new Error(ve.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(t,n){switch(de("private key",t,32),de("tweak",n,32),e.privateKeyTweakAdd(t,n)){case 0:return t;case 1:throw new Error(ve.TWEAK_ADD)}},privateKeyTweakMul(t,n){switch(de("private key",t,32),de("tweak",n,32),e.privateKeyTweakMul(t,n)){case 0:return t;case 1:throw new Error(ve.TWEAK_MUL)}},publicKeyVerify(t){return de("public key",t,[33,65]),e.publicKeyVerify(t)===0},publicKeyCreate(t,n=!0,r){switch(de("private key",t,32),Vr(n),r=Ot(r,n?33:65),e.publicKeyCreate(r,t)){case 0:return r;case 1:throw new Error(ve.SECKEY_INVALID);case 2:throw new Error(ve.PUBKEY_SERIALIZE)}},publicKeyConvert(t,n=!0,r){switch(de("public key",t,[33,65]),Vr(n),r=Ot(r,n?33:65),e.publicKeyConvert(r,t)){case 0:return r;case 1:throw new Error(ve.PUBKEY_PARSE);case 2:throw new Error(ve.PUBKEY_SERIALIZE)}},publicKeyNegate(t,n=!0,r){switch(de("public key",t,[33,65]),Vr(n),r=Ot(r,n?33:65),e.publicKeyNegate(r,t)){case 0:return r;case 1:throw new Error(ve.PUBKEY_PARSE);case 2:throw new Error(ve.IMPOSSIBLE_CASE);case 3:throw new Error(ve.PUBKEY_SERIALIZE)}},publicKeyCombine(t,n=!0,r){Tt(Array.isArray(t),"Expected public keys to be an Array"),Tt(t.length>0,"Expected public keys array will have more than zero items");for(const i of t)de("public key",i,[33,65]);switch(Vr(n),r=Ot(r,n?33:65),e.publicKeyCombine(r,t)){case 0:return r;case 1:throw new Error(ve.PUBKEY_PARSE);case 2:throw new Error(ve.PUBKEY_COMBINE);case 3:throw new Error(ve.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(t,n,r=!0,i){switch(de("public key",t,[33,65]),de("tweak",n,32),Vr(r),i=Ot(i,r?33:65),e.publicKeyTweakAdd(i,t,n)){case 0:return i;case 1:throw new Error(ve.PUBKEY_PARSE);case 2:throw new Error(ve.TWEAK_ADD)}},publicKeyTweakMul(t,n,r=!0,i){switch(de("public key",t,[33,65]),de("tweak",n,32),Vr(r),i=Ot(i,r?33:65),e.publicKeyTweakMul(i,t,n)){case 0:return i;case 1:throw new Error(ve.PUBKEY_PARSE);case 2:throw new Error(ve.TWEAK_MUL)}},signatureNormalize(t){switch(de("signature",t,64),e.signatureNormalize(t)){case 0:return t;case 1:throw new Error(ve.SIG_PARSE)}},signatureExport(t,n){de("signature",t,64),n=Ot(n,72);const r={output:n,outputlen:72};switch(e.signatureExport(r,t)){case 0:return n.slice(0,r.outputlen);case 1:throw new Error(ve.SIG_PARSE);case 2:throw new Error(ve.IMPOSSIBLE_CASE)}},signatureImport(t,n){switch(de("signature",t),n=Ot(n,64),e.signatureImport(n,t)){case 0:return n;case 1:throw new Error(ve.SIG_PARSE);case 2:throw new Error(ve.IMPOSSIBLE_CASE)}},ecdsaSign(t,n,r={},i){de("message",t,32),de("private key",n,32),Tt(cn(r)==="Object","Expected options to be an Object"),r.data!==void 0&&de("options.data",r.data),r.noncefn!==void 0&&Tt(cn(r.noncefn)==="Function","Expected options.noncefn to be a Function"),i=Ot(i,64);const a={signature:i,recid:null};switch(e.ecdsaSign(a,t,n,r.data,r.noncefn)){case 0:return a;case 1:throw new Error(ve.SIGN);case 2:throw new Error(ve.IMPOSSIBLE_CASE)}},ecdsaVerify(t,n,r){switch(de("signature",t,64),de("message",n,32),de("public key",r,[33,65]),e.ecdsaVerify(t,n,r)){case 0:return!0;case 3:return!1;case 1:throw new Error(ve.SIG_PARSE);case 2:throw new Error(ve.PUBKEY_PARSE)}},ecdsaRecover(t,n,r,i=!0,a){switch(de("signature",t,64),Tt(cn(n)==="Number"&&n>=0&&n<=3,"Expected recovery id to be a Number within interval [0, 3]"),de("message",r,32),Vr(i),a=Ot(a,i?33:65),e.ecdsaRecover(a,t,n,r)){case 0:return a;case 1:throw new Error(ve.SIG_PARSE);case 2:throw new Error(ve.RECOVER);case 3:throw new Error(ve.IMPOSSIBLE_CASE)}},ecdh(t,n,r={},i){switch(de("public key",t,[33,65]),de("private key",n,32),Tt(cn(r)==="Object","Expected options to be an Object"),r.data!==void 0&&de("options.data",r.data),r.hashfn!==void 0?(Tt(cn(r.hashfn)==="Function","Expected options.hashfn to be a Function"),r.xbuf!==void 0&&de("options.xbuf",r.xbuf,32),r.ybuf!==void 0&&de("options.ybuf",r.ybuf,32),de("output",i)):i=Ot(i,32),e.ecdh(i,t,n,r.data,r.hashfn,r.xbuf,r.ybuf)){case 0:return i;case 1:throw new Error(ve.PUBKEY_PARSE);case 2:throw new Error(ve.ECDH)}}});const ym=yi().ec,Ht=new ym("secp256k1"),fe=Ht.curve,be=fe.n.constructor;function gm(e,t){let n=new be(t);if(n.cmp(fe.p)>=0)return null;n=n.toRed(fe.red);let r=n.redSqr().redIMul(n).redIAdd(fe.b).redSqrt();return e===3!==r.isOdd()&&(r=r.redNeg()),Ht.keyPair({pub:{x:n,y:r}})}function vm(e,t,n){let r=new be(t),i=new be(n);if(r.cmp(fe.p)>=0||i.cmp(fe.p)>=0||(r=r.toRed(fe.red),i=i.toRed(fe.red),(e===6||e===7)&&i.isOdd()!==(e===7)))return null;const a=r.redSqr().redIMul(r);return i.redSqr().redISub(a.redIAdd(fe.b)).isZero()?Ht.keyPair({pub:{x:r,y:i}}):null}function mr(e){const t=e[0];switch(t){case 2:case 3:return e.length!==33?null:gm(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:vm(t,e.subarray(1,33),e.subarray(33,65));default:return null}}function $r(e,t){const n=t.encode(null,e.length===33);for(let r=0;r<e.length;++r)e[r]=n[r]}var mm={contextRandomize(){return 0},privateKeyVerify(e){const t=new be(e);return t.cmp(fe.n)<0&&!t.isZero()?0:1},privateKeyNegate(e){const t=new be(e),n=fe.n.sub(t).umod(fe.n).toArrayLike(Uint8Array,"be",32);return e.set(n),0},privateKeyTweakAdd(e,t){const n=new be(t);if(n.cmp(fe.n)>=0||(n.iadd(new be(e)),n.cmp(fe.n)>=0&&n.isub(fe.n),n.isZero()))return 1;const r=n.toArrayLike(Uint8Array,"be",32);return e.set(r),0},privateKeyTweakMul(e,t){let n=new be(t);if(n.cmp(fe.n)>=0||n.isZero())return 1;n.imul(new be(e)),n.cmp(fe.n)>=0&&(n=n.umod(fe.n));const r=n.toArrayLike(Uint8Array,"be",32);return e.set(r),0},publicKeyVerify(e){return mr(e)===null?1:0},publicKeyCreate(e,t){const n=new be(t);if(n.cmp(fe.n)>=0||n.isZero())return 1;const r=Ht.keyFromPrivate(t).getPublic();return $r(e,r),0},publicKeyConvert(e,t){const n=mr(t);if(n===null)return 1;const r=n.getPublic();return $r(e,r),0},publicKeyNegate(e,t){const n=mr(t);if(n===null)return 1;const r=n.getPublic();return r.y=r.y.redNeg(),$r(e,r),0},publicKeyCombine(e,t){const n=new Array(t.length);for(let i=0;i<t.length;++i)if(n[i]=mr(t[i]),n[i]===null)return 1;let r=n[0].getPublic();for(let i=1;i<n.length;++i)r=r.add(n[i].pub);return r.isInfinity()?2:($r(e,r),0)},publicKeyTweakAdd(e,t,n){const r=mr(t);if(r===null)return 1;if(n=new be(n),n.cmp(fe.n)>=0)return 2;const i=r.getPublic().add(fe.g.mul(n));return i.isInfinity()?2:($r(e,i),0)},publicKeyTweakMul(e,t,n){const r=mr(t);if(r===null)return 1;if(n=new be(n),n.cmp(fe.n)>=0||n.isZero())return 2;const i=r.getPublic().mul(n);return $r(e,i),0},signatureNormalize(e){const t=new be(e.subarray(0,32)),n=new be(e.subarray(32,64));return t.cmp(fe.n)>=0||n.cmp(fe.n)>=0?1:(n.cmp(Ht.nh)===1&&e.set(fe.n.sub(n).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){const n=t.subarray(0,32),r=t.subarray(32,64);if(new be(n).cmp(fe.n)>=0||new be(r).cmp(fe.n)>=0)return 1;const{output:i}=e;let a=i.subarray(4,4+33);a[0]=0,a.set(n,1);let s=33,o=0;for(;s>1&&a[o]===0&&!(a[o+1]&128);--s,++o);if(a=a.subarray(o),a[0]&128||s>1&&a[0]===0&&!(a[1]&128))return 1;let u=i.subarray(6+33,6+33+33);u[0]=0,u.set(r,1);let c=33,l=0;for(;c>1&&u[l]===0&&!(u[l+1]&128);--c,++l);return u=u.subarray(l),u[0]&128||c>1&&u[0]===0&&!(u[1]&128)?1:(e.outputlen=6+s+c,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=a.length,i.set(a,4),i[4+s]=2,i[5+s]=u.length,i.set(u,6+s),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;const n=t[3];if(n===0||5+n>=t.length||t[4+n]!==2)return 1;const r=t[5+n];if(r===0||6+n+r!==t.length||t[4]&128||n>1&&t[4]===0&&!(t[5]&128)||t[n+6]&128||r>1&&t[n+6]===0&&!(t[n+7]&128))return 1;let i=t.subarray(4,4+n);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let a=t.subarray(6+n);if(a.length===33&&a[0]===0&&(a=a.slice(1)),a.length>32)throw new Error("S length is too long");let s=new be(i);s.cmp(fe.n)>=0&&(s=new be(0));let o=new be(t.subarray(6+n));return o.cmp(fe.n)>=0&&(o=new be(0)),e.set(s.toArrayLike(Uint8Array,"be",32),0),e.set(o.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t,n,r,i){if(i){const o=i;i=u=>{const c=o(t,n,null,r,u);if(!(c instanceof Uint8Array&&c.length===32))throw new Error("This is the way");return new be(c)}}const a=new be(n);if(a.cmp(fe.n)>=0||a.isZero())return 1;let s;try{s=Ht.sign(t,n,{canonical:!0,k:i,pers:r})}catch{return 1}return e.signature.set(s.r.toArrayLike(Uint8Array,"be",32),0),e.signature.set(s.s.toArrayLike(Uint8Array,"be",32),32),e.recid=s.recoveryParam,0},ecdsaVerify(e,t,n){const r={r:e.subarray(0,32),s:e.subarray(32,64)},i=new be(r.r),a=new be(r.s);if(i.cmp(fe.n)>=0||a.cmp(fe.n)>=0)return 1;if(a.cmp(Ht.nh)===1||i.isZero()||a.isZero())return 3;const s=mr(n);if(s===null)return 2;const o=s.getPublic();return Ht.verify(t,r,o)?0:3},ecdsaRecover(e,t,n,r){const i={r:t.slice(0,32),s:t.slice(32,64)},a=new be(i.r),s=new be(i.s);if(a.cmp(fe.n)>=0||s.cmp(fe.n)>=0)return 1;if(a.isZero()||s.isZero())return 2;let o;try{o=Ht.recoverPubKey(r,i,n)}catch{return 2}return $r(e,o),0},ecdh(e,t,n,r,i,a,s){const o=mr(t);if(o===null)return 1;const u=new be(n);if(u.cmp(fe.n)>=0||u.isZero())return 2;const c=o.getPublic().mul(u);if(i===void 0){const l=c.encode(null,!0),f=Ht.hash().update(l).digest();for(let d=0;d<32;++d)e[d]=f[d]}else{a||(a=new Uint8Array(32));const l=c.getX().toArray("be",32);for(let h=0;h<32;++h)a[h]=l[h];s||(s=new Uint8Array(32));const f=c.getY().toArray("be",32);for(let h=0;h<32;++h)s[h]=f[h];const d=i(a,s,r);if(!(d instanceof Uint8Array&&d.length===e.length))return 2;e.set(d)}return 0}},yc=pm(mm),Ka={};Object.defineProperty(Ka,"__esModule",{value:!0});var ff=id();function bm(e){return new Promise(function(t,n){ff(e,function(r,i){if(r){n(r);return}t(i)})})}Ka.getRandomBytes=bm;function Sm(e){return ff(e)}Ka.getRandomBytesSync=Sm;(function(e){var t=G&&G.__awaiter||function(c,l,f,d){function v(h){return h instanceof f?h:new f(function(m){m(h)})}return new(f||(f=Promise))(function(h,m){function b(A){try{x(d.next(A))}catch(B){m(B)}}function E(A){try{x(d.throw(A))}catch(B){m(B)}}function x(A){A.done?h(A.value):v(A.value).then(b,E)}x((d=d.apply(c,l||[])).next())})},n=G&&G.__generator||function(c,l){var f={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},d,v,h,m;return m={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function b(x){return function(A){return E([x,A])}}function E(x){if(d)throw new TypeError("Generator is already executing.");for(;f;)try{if(d=1,v&&(h=x[0]&2?v.return:x[0]?v.throw||((h=v.return)&&h.call(v),0):v.next)&&!(h=h.call(v,x[1])).done)return h;switch(v=0,h&&(x=[x[0]&2,h.value]),x[0]){case 0:case 1:h=x;break;case 4:return f.label++,{value:x[1],done:!1};case 5:f.label++,v=x[1],x=[0];continue;case 7:x=f.ops.pop(),f.trys.pop();continue;default:if(h=f.trys,!(h=h.length>0&&h[h.length-1])&&(x[0]===6||x[0]===2)){f=0;continue}if(x[0]===3&&(!h||x[1]>h[0]&&x[1]<h[3])){f.label=x[1];break}if(x[0]===6&&f.label<h[1]){f.label=h[1],h=x;break}if(h&&f.label<h[2]){f.label=h[2],f.ops.push(x);break}h[2]&&f.ops.pop(),f.trys.pop();continue}x=l.call(c,f)}catch(A){x=[6,A],v=0}finally{d=h=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}};function r(c){for(var l in c)e.hasOwnProperty(l)||(e[l]=c[l])}Object.defineProperty(e,"__esModule",{value:!0});var i=yc,a=Ka,s=32;function o(){return t(this,void 0,void 0,function(){var c;return n(this,function(l){switch(l.label){case 0:return[4,a.getRandomBytes(s)];case 1:return c=l.sent(),i.privateKeyVerify(c)?[2,c]:[3,0];case 2:return[2]}})})}e.createPrivateKey=o;function u(){for(;;){var c=a.getRandomBytesSync(s);if(i.privateKeyVerify(c))return c}}e.createPrivateKeySync=u,r(yc)})(Zo);var Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.isHexString=Ee.getKeys=Ee.fromAscii=Ee.fromUtf8=Ee.toAscii=Ee.arrayContainsArray=Ee.getBinarySize=Ee.padToEven=Ee.stripHexPrefix=Ee.isHexPrefixed=void 0;function df(e){if(typeof e!="string")throw new Error("[isHexPrefixed] input must be type 'string', received type ".concat(typeof e));return e[0]==="0"&&e[1]==="x"}Ee.isHexPrefixed=df;var Em=function(e){if(typeof e!="string")throw new Error("[stripHexPrefix] input must be type 'string', received ".concat(typeof e));return df(e)?e.slice(2):e};Ee.stripHexPrefix=Em;function hf(e){var t=e;if(typeof t!="string")throw new Error("[padToEven] value must be type 'string', received ".concat(typeof t));return t.length%2&&(t="0".concat(t)),t}Ee.padToEven=hf;function Cm(e){if(typeof e!="string")throw new Error("[getBinarySize] method requires input type 'string', recieved ".concat(typeof e));return R.Buffer.byteLength(e,"utf8")}Ee.getBinarySize=Cm;function wm(e,t,n){if(Array.isArray(e)!==!0)throw new Error("[arrayContainsArray] method requires input 'superset' to be an array, got type '".concat(typeof e,"'"));if(Array.isArray(t)!==!0)throw new Error("[arrayContainsArray] method requires input 'subset' to be an array, got type '".concat(typeof t,"'"));return t[n?"some":"every"](function(r){return e.indexOf(r)>=0})}Ee.arrayContainsArray=wm;function Tm(e){var t="",n=0,r=e.length;for(e.substring(0,2)==="0x"&&(n=2);n<r;n+=2){var i=parseInt(e.substr(n,2),16);t+=String.fromCharCode(i)}return t}Ee.toAscii=Tm;function xm(e){var t=R.Buffer.from(e,"utf8");return"0x".concat(hf(t.toString("hex")).replace(/^0+|0+$/g,""))}Ee.fromUtf8=xm;function Am(e){for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n),i=r.toString(16);t+=i.length<2?"0".concat(i):i}return"0x".concat(t)}Ee.fromAscii=Am;function Im(e,t,n){if(!Array.isArray(e))throw new Error("[getKeys] method expects input 'params' to be an array, got ".concat(typeof e));if(typeof t!="string")throw new Error("[getKeys] method expects input 'key' to be type 'string', got ".concat(typeof e));for(var r=[],i=0;i<e.length;i++){var a=e[i][t];if(n&&!a)a="";else if(typeof a!="string")throw new Error("invalid abi - expected type 'string', received ".concat(typeof a));r.push(a)}return r}Ee.getKeys=Im;function Bm(e,t){return!(typeof e!="string"||!e.match(/^0x[0-9A-Fa-f]*$/)||t&&e.length!==2+2*t)}Ee.isHexString=Bm;var Fr={},Et={};Object.defineProperty(Et,"__esModule",{value:!0});Et.assertIsString=Et.assertIsArray=Et.assertIsBuffer=Et.assertIsHexString=void 0;var _m=Ee,km=function(e){if(!(0,_m.isHexString)(e)){var t="This method only supports 0x-prefixed hex strings but input was: ".concat(e);throw new Error(t)}};Et.assertIsHexString=km;var Rm=function(e){if(!R.Buffer.isBuffer(e)){var t="This method only supports Buffer but input was: ".concat(e);throw new Error(t)}};Et.assertIsBuffer=Rm;var Nm=function(e){if(!Array.isArray(e)){var t="This method only supports number arrays but input was: ".concat(e);throw new Error(t)}};Et.assertIsArray=Nm;var Pm=function(e){if(typeof e!="string"){var t="This method only supports strings but input was: ".concat(e);throw new Error(t)}};Et.assertIsString=Pm;(function(e){var t=G&&G.__values||function(T){var D=typeof Symbol=="function"&&Symbol.iterator,q=D&&T[D],Y=0;if(q)return q.call(T);if(T&&typeof T.length=="number")return{next:function(){return T&&Y>=T.length&&(T=void 0),{value:T&&T[Y++],done:!T}}};throw new TypeError(D?"Object is not iterable.":"Symbol.iterator is not defined.")},n=G&&G.__read||function(T,D){var q=typeof Symbol=="function"&&T[Symbol.iterator];if(!q)return T;var Y=q.call(T),z,ie=[],V;try{for(;(D===void 0||D-- >0)&&!(z=Y.next()).done;)ie.push(z.value)}catch(je){V={error:je}}finally{try{z&&!z.done&&(q=Y.return)&&q.call(Y)}finally{if(V)throw V.error}}return ie};Object.defineProperty(e,"__esModule",{value:!0}),e.bufArrToArr=e.arrToBufArr=e.validateNoLeadingZeroes=e.baToJSON=e.toUtf8=e.addHexPrefix=e.toUnsigned=e.fromSigned=e.bufferToHex=e.bufferToInt=e.toBuffer=e.unpadHexString=e.unpadArray=e.unpadBuffer=e.setLengthRight=e.setLengthLeft=e.zeros=e.intToBuffer=e.intToHex=void 0;var r=vt,i=Ee,a=Et,s=function(T){if(!Number.isSafeInteger(T)||T<0)throw new Error("Received an invalid integer type: ".concat(T));return"0x".concat(T.toString(16))};e.intToHex=s;var o=function(T){var D=(0,e.intToHex)(T);return R.Buffer.from((0,i.padToEven)(D.slice(2)),"hex")};e.intToBuffer=o;var u=function(T){return R.Buffer.allocUnsafe(T).fill(0)};e.zeros=u;var c=function(T,D,q){var Y=(0,e.zeros)(D);return q?T.length<D?(T.copy(Y),Y):T.slice(0,D):T.length<D?(T.copy(Y,D-T.length),Y):T.slice(-D)},l=function(T,D){return(0,a.assertIsBuffer)(T),c(T,D,!1)};e.setLengthLeft=l;var f=function(T,D){return(0,a.assertIsBuffer)(T),c(T,D,!0)};e.setLengthRight=f;var d=function(T){for(var D=T[0];T.length>0&&D.toString()==="0";)T=T.slice(1),D=T[0];return T},v=function(T){return(0,a.assertIsBuffer)(T),d(T)};e.unpadBuffer=v;var h=function(T){return(0,a.assertIsArray)(T),d(T)};e.unpadArray=h;var m=function(T){return(0,a.assertIsHexString)(T),T=(0,i.stripHexPrefix)(T),d(T)};e.unpadHexString=m;var b=function(T){if(T==null)return R.Buffer.allocUnsafe(0);if(R.Buffer.isBuffer(T))return R.Buffer.from(T);if(Array.isArray(T)||T instanceof Uint8Array)return R.Buffer.from(T);if(typeof T=="string"){if(!(0,i.isHexString)(T))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ".concat(T));return R.Buffer.from((0,i.padToEven)((0,i.stripHexPrefix)(T)),"hex")}if(typeof T=="number")return(0,e.intToBuffer)(T);if(r.BN.isBN(T)){if(T.isNeg())throw new Error("Cannot convert negative BN to buffer. Given: ".concat(T));return T.toArrayLike(R.Buffer)}if(T.toArray)return R.Buffer.from(T.toArray());if(T.toBuffer)return R.Buffer.from(T.toBuffer());throw new Error("invalid type")};e.toBuffer=b;var E=function(T){return new r.BN((0,e.toBuffer)(T)).toNumber()};e.bufferToInt=E;var x=function(T){return T=(0,e.toBuffer)(T),"0x"+T.toString("hex")};e.bufferToHex=x;var A=function(T){return new r.BN(T).fromTwos(256)};e.fromSigned=A;var B=function(T){return R.Buffer.from(T.toTwos(256).toArray())};e.toUnsigned=B;var _=function(T){return typeof T!="string"||(0,i.isHexPrefixed)(T)?T:"0x"+T};e.addHexPrefix=_;var L=function(T){var D=/^(00)+|(00)+$/g;if(T=(0,i.stripHexPrefix)(T),T.length%2!==0)throw new Error("Invalid non-even hex string input for toUtf8() provided");var q=R.Buffer.from(T.replace(D,""),"hex");return q.toString("utf8")};e.toUtf8=L;var W=function(T){if(R.Buffer.isBuffer(T))return"0x".concat(T.toString("hex"));if(T instanceof Array){for(var D=[],q=0;q<T.length;q++)D.push((0,e.baToJSON)(T[q]));return D}};e.baToJSON=W;var te=function(T){var D,q;try{for(var Y=t(Object.entries(T)),z=Y.next();!z.done;z=Y.next()){var ie=n(z.value,2),V=ie[0],je=ie[1];if(je!==void 0&&je.length>0&&je[0]===0)throw new Error("".concat(V," cannot have leading zeroes, received: ").concat(je.toString("hex")))}}catch(Ut){D={error:Ut}}finally{try{z&&!z.done&&(q=Y.return)&&q.call(Y)}finally{if(D)throw D.error}}};e.validateNoLeadingZeroes=te;function re(T){return Array.isArray(T)?T.map(function(D){return re(D)}):R.Buffer.from(T)}e.arrToBufArr=re;function P(T){return Array.isArray(T)?T.map(function(D){return P(D)}):Uint8Array.from(T??[])}e.bufArrToArr=P})(Fr);var Fa={},$n={},eu={};Object.defineProperty(eu,"__esModule",{value:!0});function Lm(e){return function(t){var n=e();return n.update(t),R.Buffer.from(n.digest())}}eu.createHashFunction=Lm;Object.defineProperty($n,"__esModule",{value:!0});var Ma=eu,Va=ad;$n.keccak224=Ma.createHashFunction(function(){return Va("keccak224")});$n.keccak256=Ma.createHashFunction(function(){return Va("keccak256")});$n.keccak384=Ma.createHashFunction(function(){return Va("keccak384")});$n.keccak512=Ma.createHashFunction(function(){return Va("keccak512")});(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.rlphash=e.ripemd160FromArray=e.ripemd160FromString=e.ripemd160=e.sha256FromArray=e.sha256FromString=e.sha256=e.keccakFromArray=e.keccakFromHexString=e.keccakFromString=e.keccak256=e.keccak=void 0;var t=$n,n=sd(),r=vt,i=Fr,a=Et,s=function(B,_){switch(_===void 0&&(_=256),(0,a.assertIsBuffer)(B),_){case 224:return(0,t.keccak224)(B);case 256:return(0,t.keccak256)(B);case 384:return(0,t.keccak384)(B);case 512:return(0,t.keccak512)(B);default:throw new Error("Invald algorithm: keccak".concat(_))}};e.keccak=s;var o=function(B){return(0,e.keccak)(B)};e.keccak256=o;var u=function(B,_){_===void 0&&(_=256),(0,a.assertIsString)(B);var L=R.Buffer.from(B,"utf8");return(0,e.keccak)(L,_)};e.keccakFromString=u;var c=function(B,_){return _===void 0&&(_=256),(0,a.assertIsHexString)(B),(0,e.keccak)((0,i.toBuffer)(B),_)};e.keccakFromHexString=c;var l=function(B,_){return _===void 0&&(_=256),(0,a.assertIsArray)(B),(0,e.keccak)((0,i.toBuffer)(B),_)};e.keccakFromArray=l;var f=function(B){return B=(0,i.toBuffer)(B),n("sha256").update(B).digest()},d=function(B){return(0,a.assertIsBuffer)(B),f(B)};e.sha256=d;var v=function(B){return(0,a.assertIsString)(B),f(B)};e.sha256FromString=v;var h=function(B){return(0,a.assertIsArray)(B),f(B)};e.sha256FromArray=h;var m=function(B,_){B=(0,i.toBuffer)(B);var L=n("rmd160").update(B).digest();return _===!0?(0,i.setLengthLeft)(L,32):L},b=function(B,_){return(0,a.assertIsBuffer)(B),m(B,_)};e.ripemd160=b;var E=function(B,_){return(0,a.assertIsString)(B),m(B,_)};e.ripemd160FromString=E;var x=function(B,_){return(0,a.assertIsArray)(B),m(B,_)};e.ripemd160FromArray=x;var A=function(B){return(0,e.keccak)(r.rlp.encode(B))};e.rlphash=A})(Fa);var $a={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toType=e.TypeOutput=e.bnToRlp=e.bnToUnpaddedBuffer=e.bnToHex=void 0;var t=vt,n=Ee,r=Fr;function i(c){return"0x".concat(c.toString(16))}e.bnToHex=i;function a(c){return(0,r.unpadBuffer)(c.toArrayLike(R.Buffer))}e.bnToUnpaddedBuffer=a;function s(c){return a(c)}e.bnToRlp=s;var o;(function(c){c[c.Number=0]="Number",c[c.BN=1]="BN",c[c.Buffer=2]="Buffer",c[c.PrefixedHexString=3]="PrefixedHexString"})(o=e.TypeOutput||(e.TypeOutput={}));function u(c,l){if(c===null)return null;if(c!==void 0){if(typeof c=="string"&&!(0,n.isHexString)(c))throw new Error("A string must be provided with a 0x-prefix, given: ".concat(c));if(typeof c=="number"&&!Number.isSafeInteger(c))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");var f=(0,r.toBuffer)(c);if(l===o.Buffer)return f;if(l===o.BN)return new t.BN(f);if(l===o.Number){var d=new t.BN(f),v=new t.BN(Number.MAX_SAFE_INTEGER.toString());if(d.gt(v))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return d.toNumber()}else return"0x".concat(f.toString("hex"))}}e.toType=u})($a);(function(e){var t=G&&G.__read||function(P,T){var D=typeof Symbol=="function"&&P[Symbol.iterator];if(!D)return P;var q=D.call(P),Y,z=[],ie;try{for(;(T===void 0||T-- >0)&&!(Y=q.next()).done;)z.push(Y.value)}catch(V){ie={error:V}}finally{try{Y&&!Y.done&&(D=q.return)&&D.call(q)}finally{if(ie)throw ie.error}}return z},n=G&&G.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(e,"__esModule",{value:!0}),e.isZeroAddress=e.zeroAddress=e.importPublic=e.privateToAddress=e.privateToPublic=e.publicToAddress=e.pubToAddress=e.isValidPublic=e.isValidPrivate=e.generateAddress2=e.generateAddress=e.isValidChecksumAddress=e.toChecksumAddress=e.isValidAddress=e.Account=void 0;var r=n(go()),i=vt,a=Zo,s=Ee,o=Yo,u=Fr,c=Fa,l=Et,f=$a,d=function(){function P(T,D,q,Y){T===void 0&&(T=new i.BN(0)),D===void 0&&(D=new i.BN(0)),q===void 0&&(q=o.KECCAK256_RLP),Y===void 0&&(Y=o.KECCAK256_NULL),this.nonce=T,this.balance=D,this.stateRoot=q,this.codeHash=Y,this._validate()}return P.fromAccountData=function(T){var D=T.nonce,q=T.balance,Y=T.stateRoot,z=T.codeHash;return new P(D?new i.BN((0,u.toBuffer)(D)):void 0,q?new i.BN((0,u.toBuffer)(q)):void 0,Y?(0,u.toBuffer)(Y):void 0,z?(0,u.toBuffer)(z):void 0)},P.fromRlpSerializedAccount=function(T){var D=i.rlp.decode(T);if(!Array.isArray(D))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(D)},P.fromValuesArray=function(T){var D=t(T,4),q=D[0],Y=D[1],z=D[2],ie=D[3];return new P(new i.BN(q),new i.BN(Y),z,ie)},P.prototype._validate=function(){if(this.nonce.lt(new i.BN(0)))throw new Error("nonce must be greater than zero");if(this.balance.lt(new i.BN(0)))throw new Error("balance must be greater than zero");if(this.stateRoot.length!==32)throw new Error("stateRoot must have a length of 32");if(this.codeHash.length!==32)throw new Error("codeHash must have a length of 32")},P.prototype.raw=function(){return[(0,f.bnToUnpaddedBuffer)(this.nonce),(0,f.bnToUnpaddedBuffer)(this.balance),this.stateRoot,this.codeHash]},P.prototype.serialize=function(){return i.rlp.encode(this.raw())},P.prototype.isContract=function(){return!this.codeHash.equals(o.KECCAK256_NULL)},P.prototype.isEmpty=function(){return this.balance.isZero()&&this.nonce.isZero()&&this.codeHash.equals(o.KECCAK256_NULL)},P}();e.Account=d;var v=function(P){try{(0,l.assertIsString)(P)}catch{return!1}return/^0x[0-9a-fA-F]{40}$/.test(P)};e.isValidAddress=v;var h=function(P,T){(0,l.assertIsHexString)(P);var D=(0,s.stripHexPrefix)(P).toLowerCase(),q="";if(T){var Y=(0,f.toType)(T,f.TypeOutput.BN);q=Y.toString()+"0x"}for(var z=(0,c.keccakFromString)(q+D).toString("hex"),ie="0x",V=0;V<D.length;V++)parseInt(z[V],16)>=8?ie+=D[V].toUpperCase():ie+=D[V];return ie};e.toChecksumAddress=h;var m=function(P,T){return(0,e.isValidAddress)(P)&&(0,e.toChecksumAddress)(P,T)===P};e.isValidChecksumAddress=m;var b=function(P,T){(0,l.assertIsBuffer)(P),(0,l.assertIsBuffer)(T);var D=new i.BN(T);return D.isZero()?(0,c.rlphash)([P,null]).slice(-20):(0,c.rlphash)([P,R.Buffer.from(D.toArray())]).slice(-20)};e.generateAddress=b;var E=function(P,T,D){(0,l.assertIsBuffer)(P),(0,l.assertIsBuffer)(T),(0,l.assertIsBuffer)(D),(0,r.default)(P.length===20),(0,r.default)(T.length===32);var q=(0,c.keccak256)(R.Buffer.concat([R.Buffer.from("ff","hex"),P,T,(0,c.keccak256)(D)]));return q.slice(-20)};e.generateAddress2=E;var x=function(P){return(0,a.privateKeyVerify)(P)};e.isValidPrivate=x;var A=function(P,T){return T===void 0&&(T=!1),(0,l.assertIsBuffer)(P),P.length===64?(0,a.publicKeyVerify)(R.Buffer.concat([R.Buffer.from([4]),P])):T?(0,a.publicKeyVerify)(P):!1};e.isValidPublic=A;var B=function(P,T){return T===void 0&&(T=!1),(0,l.assertIsBuffer)(P),T&&P.length!==64&&(P=R.Buffer.from((0,a.publicKeyConvert)(P,!1).slice(1))),(0,r.default)(P.length===64),(0,c.keccak)(P).slice(-20)};e.pubToAddress=B,e.publicToAddress=e.pubToAddress;var _=function(P){return(0,l.assertIsBuffer)(P),R.Buffer.from((0,a.publicKeyCreate)(P,!1)).slice(1)};e.privateToPublic=_;var L=function(P){return(0,e.publicToAddress)((0,e.privateToPublic)(P))};e.privateToAddress=L;var W=function(P){return(0,l.assertIsBuffer)(P),P.length!==64&&(P=R.Buffer.from((0,a.publicKeyConvert)(P,!1).slice(1))),P};e.importPublic=W;var te=function(){var P=20,T=(0,u.zeros)(P);return(0,u.bufferToHex)(T)};e.zeroAddress=te;var re=function(P){try{(0,l.assertIsString)(P)}catch{return!1}var T=(0,e.zeroAddress)();return T===P};e.isZeroAddress=re})(Jo);var Ha={},Um=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ha,"__esModule",{value:!0});Ha.Address=void 0;var Hr=Um(go()),Vi=vt,gc=Fr,Jn=Jo,Om=function(){function e(t){(0,Hr.default)(t.length===20,"Invalid address length"),this.buf=t}return e.zero=function(){return new e((0,gc.zeros)(20))},e.fromString=function(t){return(0,Hr.default)((0,Jn.isValidAddress)(t),"Invalid address"),new e((0,gc.toBuffer)(t))},e.fromPublicKey=function(t){(0,Hr.default)(R.Buffer.isBuffer(t),"Public key should be Buffer");var n=(0,Jn.pubToAddress)(t);return new e(n)},e.fromPrivateKey=function(t){(0,Hr.default)(R.Buffer.isBuffer(t),"Private key should be Buffer");var n=(0,Jn.privateToAddress)(t);return new e(n)},e.generate=function(t,n){return(0,Hr.default)(Vi.BN.isBN(n)),new e((0,Jn.generateAddress)(t.buf,n.toArrayLike(R.Buffer)))},e.generate2=function(t,n,r){return(0,Hr.default)(R.Buffer.isBuffer(n)),(0,Hr.default)(R.Buffer.isBuffer(r)),new e((0,Jn.generateAddress2)(t.buf,n,r))},e.prototype.equals=function(t){return this.buf.equals(t.buf)},e.prototype.isZero=function(){return this.equals(e.zero())},e.prototype.isPrecompileOrSystemAddress=function(){var t=new Vi.BN(this.buf),n=new Vi.BN(0),r=new Vi.BN("ffff","hex");return t.gte(n)&&t.lte(r)},e.prototype.toString=function(){return"0x"+this.buf.toString("hex")},e.prototype.toBuffer=function(){return R.Buffer.from(this.buf)},e}();Ha.Address=Om;var it={};Object.defineProperty(it,"__esModule",{value:!0});it.hashPersonalMessage=it.isValidSignature=it.fromRpcSig=it.toCompactSig=it.toRpcSig=it.ecrecover=it.ecsign=void 0;var so=Zo,ai=vt,kt=Fr,Dm=Fa,Km=Et,Wt=$a;function Fm(e,t,n){var r=(0,so.ecdsaSign)(e,t),i=r.signature,a=r.recid,s=R.Buffer.from(i.slice(0,32)),o=R.Buffer.from(i.slice(32,64));if(!n||typeof n=="number"){if(n&&!Number.isSafeInteger(n))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");var u=n?a+(n*2+35):a+27;return{r:s,s:o,v:u}}var c=(0,Wt.toType)(n,Wt.TypeOutput.BN),l=c.muln(2).addn(35).addn(a).toArrayLike(R.Buffer);return{r:s,s:o,v:l}}it.ecsign=Fm;function ja(e,t){var n=(0,Wt.toType)(e,Wt.TypeOutput.BN);if(n.eqn(0)||n.eqn(1))return(0,Wt.toType)(e,Wt.TypeOutput.BN);if(!t)return n.subn(27);var r=(0,Wt.toType)(t,Wt.TypeOutput.BN);return n.sub(r.muln(2).addn(35))}function qa(e){var t=new ai.BN(e);return t.eqn(0)||t.eqn(1)}var Mm=function(e,t,n,r,i){var a=R.Buffer.concat([(0,kt.setLengthLeft)(n,32),(0,kt.setLengthLeft)(r,32)],64),s=ja(t,i);if(!qa(s))throw new Error("Invalid signature v value");var o=(0,so.ecdsaRecover)(a,s.toNumber(),e);return R.Buffer.from((0,so.publicKeyConvert)(o,!1).slice(1))};it.ecrecover=Mm;var Vm=function(e,t,n,r){var i=ja(e,r);if(!qa(i))throw new Error("Invalid signature v value");return(0,kt.bufferToHex)(R.Buffer.concat([(0,kt.setLengthLeft)(t,32),(0,kt.setLengthLeft)(n,32),(0,kt.toBuffer)(e)]))};it.toRpcSig=Vm;var $m=function(e,t,n,r){var i=ja(e,r);if(!qa(i))throw new Error("Invalid signature v value");var a=(0,Wt.toType)(e,Wt.TypeOutput.Number),s=n;return(a>28&&a%2===1||a===1||a===28)&&(s=R.Buffer.from(n),s[0]|=128),(0,kt.bufferToHex)(R.Buffer.concat([(0,kt.setLengthLeft)(t,32),(0,kt.setLengthLeft)(s,32)]))};it.toCompactSig=$m;var Hm=function(e){var t=(0,kt.toBuffer)(e),n,r,i;if(t.length>=65)n=t.slice(0,32),r=t.slice(32,64),i=(0,kt.bufferToInt)(t.slice(64));else if(t.length===64)n=t.slice(0,32),r=t.slice(32,64),i=(0,kt.bufferToInt)(t.slice(32,33))>>7,r[0]&=127;else throw new Error("Invalid signature length");return i<27&&(i+=27),{v:i,r:n,s:r}};it.fromRpcSig=Hm;var jm=function(e,t,n,r,i){r===void 0&&(r=!0);var a=new ai.BN("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),s=new ai.BN("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(t.length!==32||n.length!==32||!qa(ja(e,i)))return!1;var o=new ai.BN(t),u=new ai.BN(n);return!(o.isZero()||o.gt(s)||u.isZero()||u.gt(s)||r&&u.cmp(a)===1)};it.isValidSignature=jm;var qm=function(e){(0,Km.assertIsBuffer)(e);var t=R.Buffer.from(`Ethereum Signed Message:
`.concat(e.length),"utf-8");return(0,Dm.keccak)(R.Buffer.concat([t,e]))};it.hashPersonalMessage=qm;var Ga={},Gm=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ga,"__esModule",{value:!0});Ga.defineProperties=void 0;var vc=Gm(go()),Wm=Ee,mc=vt,$i=Fr,zm=function(e,t,n){if(e.raw=[],e._fields=[],e.toJSON=function(i){if(i===void 0&&(i=!1),i){var a={};return e._fields.forEach(function(s){a[s]="0x".concat(e[s].toString("hex"))}),a}return(0,$i.baToJSON)(e.raw)},e.serialize=function(){return mc.rlp.encode(e.raw)},t.forEach(function(i,a){e._fields.push(i.name);function s(){return e.raw[a]}function o(u){u=(0,$i.toBuffer)(u),u.toString("hex")==="00"&&!i.allowZero&&(u=R.Buffer.allocUnsafe(0)),i.allowLess&&i.length?(u=(0,$i.unpadBuffer)(u),(0,vc.default)(i.length>=u.length,"The field ".concat(i.name," must not have more ").concat(i.length," bytes"))):!(i.allowZero&&u.length===0)&&i.length&&(0,vc.default)(i.length===u.length,"The field ".concat(i.name," must have byte length of ").concat(i.length)),e.raw[a]=u}Object.defineProperty(e,i.name,{enumerable:!0,configurable:!0,get:s,set:o}),i.default&&(e[i.name]=i.default),i.alias&&Object.defineProperty(e,i.alias,{enumerable:!1,configurable:!0,set:o,get:s})}),n)if(typeof n=="string"&&(n=R.Buffer.from((0,Wm.stripHexPrefix)(n),"hex")),R.Buffer.isBuffer(n)&&(n=mc.rlp.decode(n)),Array.isArray(n)){if(n.length>e._fields.length)throw new Error("wrong number of fields in data");n.forEach(function(i,a){e[e._fields[a]]=(0,$i.toBuffer)(i)})}else if(typeof n=="object"){var r=Object.keys(n);t.forEach(function(i){r.indexOf(i.name)!==-1&&(e[i.name]=n[i.name]),r.indexOf(i.alias)!==-1&&(e[i.alias]=n[i.alias])})}else throw new Error("invalid data")};Ga.defineProperties=zm;(function(e){var t=G&&G.__createBinding||(Object.create?function(i,a,s,o){o===void 0&&(o=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(i,o,u)}:function(i,a,s,o){o===void 0&&(o=s),i[o]=a[s]}),n=G&&G.__exportStar||function(i,a){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&t(a,i,s)};Object.defineProperty(e,"__esModule",{value:!0}),e.isHexString=e.getKeys=e.fromAscii=e.fromUtf8=e.toAscii=e.arrayContainsArray=e.getBinarySize=e.padToEven=e.stripHexPrefix=e.isHexPrefixed=void 0,n(Yo,e),n(Jo,e),n(Ha,e),n(Fa,e),n(it,e),n(Fr,e),n(Ga,e),n(vt,e),n($a,e);var r=Ee;Object.defineProperty(e,"isHexPrefixed",{enumerable:!0,get:function(){return r.isHexPrefixed}}),Object.defineProperty(e,"stripHexPrefix",{enumerable:!0,get:function(){return r.stripHexPrefix}}),Object.defineProperty(e,"padToEven",{enumerable:!0,get:function(){return r.padToEven}}),Object.defineProperty(e,"getBinarySize",{enumerable:!0,get:function(){return r.getBinarySize}}),Object.defineProperty(e,"arrayContainsArray",{enumerable:!0,get:function(){return r.arrayContainsArray}}),Object.defineProperty(e,"toAscii",{enumerable:!0,get:function(){return r.toAscii}}),Object.defineProperty(e,"fromUtf8",{enumerable:!0,get:function(){return r.fromUtf8}}),Object.defineProperty(e,"fromAscii",{enumerable:!0,get:function(){return r.fromAscii}}),Object.defineProperty(e,"getKeys",{enumerable:!0,get:function(){return r.getKeys}}),Object.defineProperty(e,"isHexString",{enumerable:!0,get:function(){return r.isHexString}})})(Qo);class ba{constructor(t,n,r){this.walletId=t,this.keyshare=n,this.address=r,this.backupDecryptionKey=R.Buffer.from(hi.random.getBytesSync(32),"binary").toString("hex")}static buildFrom(t){try{const n=JSON.parse(t);return Object.assign(new ba("","",""),n)}catch{const r=new ba("","","");return r.backupDecryptionKey=t.split("|")[0],r}}getPublicDecryptionKey(){return R.Buffer.from(Qo.privateToPublic(R.Buffer.from(this.backupDecryptionKey,"hex")))}encryptForSelf(t){try{const n=this.getPublicDecryptionKey();return ma.Encrypt(n,R.Buffer.from(t,"ucs2")).toString("base64")}catch{throw Error("Error encrypting backup")}}decrypt(t){try{const n=R.Buffer.from(t,"base64");return ma.Decrypt(R.Buffer.from(this.backupDecryptionKey,"hex"),n).toString("ucs2")}catch{throw Error("Error decrypting backup")}}}var Qm=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function pf(e,t,n,r,i,a=!1,s){return Qm(this,void 0,void 0,function*(){const o=new ba(n,"",""),c={encryptedShare:o.encryptForSelf(i),type:pl.USER,encryptor:oa.RECOVERY};return yield e.capsuleClient.uploadUserKeyShares(t,[...r.map(l=>Object.assign({walletId:n},l)),...a?[]:[Object.assign({walletId:n},c)]]),a||(yield e.capsuleClient.distributeCapsuleShare(Object.assign({userId:t,walletId:n,useDKLS:e.useDKLS},s))),JSON.stringify(o)})}var Ym=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function ea(e,t,n,r,i=!1,a){return Ym(this,void 0,void 0,function*(){const o=(yield e.capsuleClient.getSessionPublicKeys(t)).data.keys.map(u=>{if(!u.publicKey)return;const{encryptedMessageHex:c,encryptedKeyHex:l}=em(u.sigDerivedPublicKey,r);return{encryptedShare:c,encryptedKey:l,type:pl.USER,encryptor:oa.BIOMETRICS,biometricPublicKey:u.sigDerivedPublicKey}}).filter(Boolean);return yield pf(e,t,n,o,r,i,a)})}function yf(e){switch(e){case $e.DEV:return"http://localhost:8080/";case $e.SANDBOX:return"https://api.sandbox.usecapsule.com/";case $e.BETA:return"https://api.beta.usecapsule.com/";case $e.PROD:return"https://api.usecapsule.com/";default:throw new Error(`unsupported env: ${e}`)}}function Hn(e,t){const n=t?"ws":"http";switch(e){case $e.DEV:return`${n}://localhost:3000`;case $e.SANDBOX:return`${n}s://mpc-network.sandbox.usecapsule.com`;case $e.BETA:return`${n}s://mpc-network.beta.usecapsule.com`;case $e.PROD:return`${n}s://mpc-network.prod.usecapsule.com`;default:throw new Error(`unsupported env: ${e}`)}}function gf(e,t,n,r,i){return new np({userManagementHost:yf(e),apiKey:t,opts:{useFetchAdapter:n},retrieveSessionCookie:r,persistSessionCookie:i})}function vf(e,t){const n=or.create({baseURL:e});return t&&(n.defaults.adapter=function(r){return fetch(r.baseURL+r.url,{method:r.method,headers:r.headers,body:r.data,credentials:r.withCredentials?"include":void 0}).then(i=>i.text().then(a=>({data:a,status:i.status,statusText:i.statusText,headers:i.headers,config:r,request:fetch}))).catch(function(i){throw i})}),n}var Xm=tn(),Jm=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function Zm(e,t){return Jm(this,void 0,void 0,function*(){let n,r;for(;;)try{n=Xm.randomBytes(32).toString("hex"),r=Qo.privateToPublic(R.Buffer.from(n,"hex"));break}catch{continue}const i=R.Buffer.from(r),a=ma.Encrypt(i,R.Buffer.from(e,"ucs2")).toString("base64"),{data:{id:s}}=yield t.tempTrasmissionInit(a);return encodeURIComponent(s+"|"+n)})}var Z=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};const e1=30*60*1e3,t1=60*60*1e3;var hn;(function(e){e.CGGMP="CGGMP",e.DKLS="DKLS"})(hn||(hn={}));var bc;(function(e){e.INITIATED="INITIATED",e.READY="READY",e.EXPIRED="EXPIRED",e.FINISHED="FINISHED",e.CANCELLED="CANCELLED"})(bc||(bc={}));const kr="@CAPSULE/",Ss=`${kr}e-mail`,Es=`${kr}userId`,sn=`${kr}wallets`,Zn=`${kr}sessionCookie`,Hi=`${kr}loginEncryptionKeyPair`,Cs=2e3,Sc=1e3;function r1(e,t){return e.env!==$e.PROD?Date.now()-t<=t1:Date.now()-t<=e1}class n1{convertBigInt(t){const n=new hi.jsbn.BigInteger(null);return n.data=t.data,n.s=t.s,n.t=t.t,n}convertEncryptionKeyPair(t){return{privateKey:hi.pki.setRsaPrivateKey(this.convertBigInt(t.privateKey.n),this.convertBigInt(t.privateKey.e),this.convertBigInt(t.privateKey.d),this.convertBigInt(t.privateKey.p),this.convertBigInt(t.privateKey.q),this.convertBigInt(t.privateKey.dP),this.convertBigInt(t.privateKey.dQ),this.convertBigInt(t.privateKey.qInv)),publicKey:hi.pki.setRsaPublicKey(this.convertBigInt(t.publicKey.n),this.convertBigInt(t.publicKey.e))}}requireApiKey(){if(!this.ctx.apiKey)throw new Error(`in order to create a wallet or user with Capsule, you
        must provide an API key to the capsule instance`)}constructor(t,n,r){if(this.localStorageGetItem=s=>this.platformUtils.localStorage.get(s),this.localStorageSetItem=(s,o)=>this.platformUtils.localStorage.set(s,o),this.sessionStorageGetItem=s=>this.platformUtils.sessionStorage.get(s),this.sessionStorageSetItem=(s,o)=>this.platformUtils.sessionStorage.set(s,o),this.sessionStorageRemoveItem=s=>this.platformUtils.sessionStorage.removeItem(s),this.retrieveSessionCookie=()=>this.sessionCookie,this.persistSessionCookie=s=>{this.sessionCookie=s,this.localStorageSetItem(Zn,s)},this.clearStorage=()=>Z(this,void 0,void 0,function*(){this.platformUtils.localStorage.clear(kr),this.platformUtils.sessionStorage.clear(kr),this.platformUtils.secureStorage&&this.platformUtils.secureStorage.clear(kr)}),r||(r={}),this.emailPrimaryColor=r.emailPrimaryColor,this.emailTheme=r.emailTheme,this.homepageUrl=r.homepageUrl,this.supportUrl=r.supportUrl,this.xUrl=r.xUrl,this.githubUrl=r.githubUrl,this.linkedinUrl=r.linkedinUrl,this.portalBackgroundColor=r.portalBackgroundColor,this.portalPrimaryButtonColor=r.portalPrimaryButtonColor,this.portalTextColor=r.portalTextColor,this.portalPrimaryButtonTextColor=r.portalPrimaryButtonTextColor,this.portalTheme=r.portalTheme,this.platformUtils=this.getPlatformUtils(),this.disableProviderModal=this.platformUtils.disableProviderModal,r.useStorageOverrides&&(this.localStorageGetItem=r.localStorageGetItemOverride,this.localStorageSetItem=r.localStorageSetItemOverride,this.sessionStorageGetItem=r.sessionStorageGetItemOverride,this.sessionStorageSetItem=r.sessionStorageSetItemOverride,this.sessionStorageRemoveItem=r.sessionStorageRemoveItemOverride,this.clearStorage=r.clearStorageOverride),this.ctx={env:t,apiKey:n,capsuleClient:gf(t,n,r.disableWorkers,this.retrieveSessionCookie,this.persistSessionCookie),disableWorkers:r.disableWorkers,offloadMPCComputationURL:r.offloadMPCComputationURL,useLocalFiles:r.useLocalFiles,useDKLS:r.useDKLSForCreation||!r.offloadMPCComputationURL,disableWebSockets:!!r.disableWebSockets,wasmOverride:r.wasmOverride},r.offloadMPCComputationURL&&(this.ctx.mpcComputationClient=vf(r.offloadMPCComputationURL,r.disableWorkers)),!this.platformUtils.isSyncStorage||r.useStorageOverrides)return;this.email=this.localStorageGetItem(Ss)||void 0,this.userId=this.localStorageGetItem(Es)||void 0,this.sessionCookie=this.localStorageGetItem(Zn)||this.sessionStorageGetItem(Zn)||void 0;const i=this.platformUtils.secureStorage?this.platformUtils.secureStorage.get(sn):this.localStorageGetItem(sn);this.wallets=JSON.parse(i||"{}");const a=this.sessionStorageGetItem(Hi);a&&a!=="undefined"&&(this.loginEncryptionKeyPair=this.convertEncryptionKeyPair(JSON.parse(a)))}getVerificationEmailProps(){return{brandColor:this.emailPrimaryColor,theme:this.emailTheme,supportUrl:this.supportUrl,homepageUrl:this.homepageUrl,xUrl:this.xUrl,githubUrl:this.githubUrl,linkedinUrl:this.linkedinUrl}}getBackupKitEmailProps(){return{brandColor:this.emailPrimaryColor,theme:this.emailTheme,homepageUrl:this.homepageUrl,xUrl:this.xUrl,linkedinUrl:this.linkedinUrl,githubUrl:this.githubUrl,supportUrl:this.supportUrl}}init(){return Z(this,void 0,void 0,function*(){this.email=(yield this.localStorageGetItem(Ss))||void 0,this.userId=(yield this.localStorageGetItem(Es))||void 0,this.sessionCookie=(yield this.localStorageGetItem(Zn))||(yield this.sessionStorageGetItem(Zn))||void 0;const t=this.platformUtils.secureStorage?yield this.platformUtils.secureStorage.get(sn):yield this.localStorageGetItem(sn);this.wallets=JSON.parse(t||"{}");const n=yield this.sessionStorageGetItem(Hi);n&&n!=="undefined"&&(this.loginEncryptionKeyPair=this.convertEncryptionKeyPair(JSON.parse(n)))})}setEmail(t){return Z(this,void 0,void 0,function*(){this.email=t,yield this.localStorageSetItem(Ss,t)})}setUserId(t){return Z(this,void 0,void 0,function*(){this.userId=t,yield this.localStorageSetItem(Es,t)})}setWallets(t){return Z(this,void 0,void 0,function*(){if(this.wallets=t,this.platformUtils.secureStorage){yield this.platformUtils.secureStorage.set(sn,JSON.stringify(t));return}yield this.localStorageSetItem(sn,JSON.stringify(t))})}setLoginEncryptionKeyPair(t){return Z(this,void 0,void 0,function*(){this.loginEncryptionKeyPair=t,yield this.sessionStorageSetItem(Hi,JSON.stringify(t))})}deleteLoginEncryptionKeyPair(){return Z(this,void 0,void 0,function*(){this.loginEncryptionKeyPair=void 0,yield this.sessionStorageRemoveItem(Hi)})}getUserId(){return this.userId}getEmail(){return this.email}getWallets(){return this.wallets}getAddress(t){var n,r;return t?this.wallets[t].address:(r=(n=Object.values(this.wallets))===null||n===void 0?void 0:n[0])===null||r===void 0?void 0:r.address}getPartnerURL(t){return Z(this,void 0,void 0,function*(){return(yield this.ctx.capsuleClient.getPartner(t)).data.partner.portalUrl})}getPortalURL(t){return Z(this,void 0,void 0,function*(){return t&&(yield this.getPartnerURL(t))||Sr(this.ctx)})}getWebAuthURLForCreate(t,n,r){var i,a,s,o;return Z(this,void 0,void 0,function*(){const u=n?`&partnerId=${n}`:"",c=!((i=this.portalTheme)===null||i===void 0)&&i.borderRadius?`&portalBorderRadius=${encodeURIComponent(this.portalTheme.borderRadius)}`:"",l=!((a=this.portalTheme)===null||a===void 0)&&a.foregroundColor?`&portalForegroundColor=${encodeURIComponent(this.portalTheme.foregroundColor)}`:"",f=this.portalBackgroundColor||!((s=this.portalTheme)===null||s===void 0)&&s.backgroundColor?`&portalBackgroundColor=${encodeURIComponent((o=this.portalBackgroundColor)!==null&&o!==void 0?o:this.portalTheme.backgroundColor)}`:"",d=this.portalPrimaryButtonColor?`&portalPrimaryButtonColor=${encodeURIComponent(this.portalPrimaryButtonColor)}`:"",v=this.portalTextColor?`&portalTextColor=${encodeURIComponent(this.portalTextColor)}`:"",h=this.portalPrimaryButtonTextColor?`&portalPrimaryButtonTextColor=${encodeURIComponent(this.portalPrimaryButtonTextColor)}`:"",m=r?`&isForNewDevice=${r}`:"";return`${n&&(yield this.getPartnerURL(n))||Sr(this.ctx)}/web/users/${this.userId}/biometrics/${t}?email=${encodeURIComponent(this.email)}${u}${c}${l}${f}${d}${v}${m}${h}`})}getShortUrl(t){return`${Sr(this.ctx)}/short/${t}`}shortenLoginLink(t){return Z(this,void 0,void 0,function*(){const n=yield Zm(t,this.ctx.capsuleClient);return this.getShortUrl(n)})}getWebAuthURLForLogin(t,n,r,i,a){var s,o,u,c;return Z(this,void 0,void 0,function*(){const l=r?`&partnerId=${r}`:"",f=!((s=this.portalTheme)===null||s===void 0)&&s.borderRadius?`&portalBorderRadius=${encodeURIComponent(this.portalTheme.borderRadius)}`:"",d=!((o=this.portalTheme)===null||o===void 0)&&o.foregroundColor?`&portalForegroundColor=${encodeURIComponent(this.portalTheme.foregroundColor)}`:"",v=this.portalBackgroundColor||!((u=this.portalTheme)===null||u===void 0)&&u.backgroundColor?`&portalBackgroundColor=${encodeURIComponent((c=this.portalBackgroundColor)!==null&&c!==void 0?c:this.portalTheme.backgroundColor)}`:"",h=this.portalPrimaryButtonColor?`&portalPrimaryButtonColor=${encodeURIComponent(this.portalPrimaryButtonColor)}`:"",m=this.portalTextColor?`&portalTextColor=${encodeURIComponent(this.portalTextColor)}`:"",b=this.portalPrimaryButtonTextColor?`&portalPrimaryButtonTextColor=${encodeURIComponent(this.portalPrimaryButtonTextColor)}`:"",E=i?`&newDeviceSessionId=${i}`:"",x=a?`&newDeviceEncryptionKey=${a}`:"";return`${r&&(yield this.getPartnerURL(r))||Sr(this.ctx)}/web/biometrics/login?email=${encodeURIComponent(this.email)}&sessionId=${t}&encryptionKey=${n}${l}${v}${h}${m}${E}${f}${d}${x}${b}`})}getPrivateKey(t){return Z(this,void 0,void 0,function*(){const n=Object.values(this.wallets),r=t?this.wallets[t]:n==null?void 0:n[0];if(!r)throw new Error("wallet not found");if(r.scheme!==hn.DKLS)throw new Error("invalid wallet scheme");return yield this.platformUtils.getPrivateKey(this.ctx,this.userId,r.id,r.signer,this.retrieveSessionCookie())})}fetchWallets(){return Z(this,void 0,void 0,function*(){return(yield this.ctx.capsuleClient.getWallets(this.userId)).data.wallets})}populateWalletAddresses(){return Z(this,void 0,void 0,function*(){(yield this.ctx.capsuleClient.getWallets(this.userId)).data.wallets.forEach(r=>{this.wallets[r.id]&&(this.wallets[r.id].address=r.address,this.wallets[r.id].publicKey=r.publicKey,this.wallets[r.id].scheme=r.scheme,this.wallets[r.id].partnerId=r.partnerId,this.wallets[r.id].userId=r.userId)}),yield this.setWallets(this.wallets)})}populatePregenWalletAddresses(t){return Z(this,void 0,void 0,function*(){(yield this.ctx.capsuleClient.getPregenWallets(t)).wallets.forEach(i=>{this.wallets[i.id]&&(this.wallets[i.id].address=i.address,this.wallets[i.id].publicKey=i.publicKey,this.wallets[i.id].scheme=i.scheme,this.wallets[i.id].partnerId=i.partnerId,this.wallets[i.id].userId=i.userId)}),yield this.setWallets(this.wallets)})}checkIfUserExists(t){return Z(this,void 0,void 0,function*(){return(yield this.ctx.capsuleClient.checkUserExists(t)).data.exists})}createUser(t){return Z(this,void 0,void 0,function*(){this.requireApiKey(),yield this.setEmail(t),yield this.setWallets({});const{userId:n}=yield this.ctx.capsuleClient.createUser(Object.assign({email:this.email},this.getVerificationEmailProps()));yield this.setUserId(n)})}verifyEmail(t){return Z(this,void 0,void 0,function*(){return yield this.ctx.capsuleClient.verifyEmail(this.userId,{verificationCode:t}),this.getSetUpBiometricsURL(!1)})}verify2FA(t,n){return Z(this,void 0,void 0,function*(){const r=yield this.ctx.capsuleClient.verify2FA(t,n);return{address:r.data.address,initiatedAt:r.data.initiatedAt,status:r.data.status,userId:r.data.userId,walletId:r.data.walletId}})}setup2FA(){return Z(this,void 0,void 0,function*(){return{uri:(yield this.ctx.capsuleClient.setup2FA(this.userId)).data.uri}})}enable2FA(t){return Z(this,void 0,void 0,function*(){yield this.ctx.capsuleClient.enable2FA(this.userId,t)})}check2FAStatus(){return Z(this,void 0,void 0,function*(){return this.userId?{isSetup:(yield this.ctx.capsuleClient.check2FAStatus(this.userId)).data.isSetup}:{isSetup:!1}})}resendVerificationCode(){return Z(this,void 0,void 0,function*(){yield this.ctx.capsuleClient.resendVerificationCode(Object.assign({userId:this.userId},this.getVerificationEmailProps()))})}getSetUpBiometricsURL(t){return Z(this,void 0,void 0,function*(){const n=yield this.ctx.capsuleClient.addSessionPublicKey(this.userId,{status:Os.PENDING,type:Ds.WEB});return this.getWebAuthURLForCreate(n.data.id,n.data.partnerId,t)})}isSessionActive(){return Z(this,void 0,void 0,function*(){const t=yield this.ctx.capsuleClient.touchSession();return t.data.biometricVerifiedAt&&r1(this.ctx,t.data.biometricVerifiedAt)})}isFullyLoggedIn(){var t,n;return Z(this,void 0,void 0,function*(){const r=yield this.isSessionActive(),i=(n=(t=this.getWallets())===null||t===void 0?void 0:t[Object.keys(this.getWallets())[0]])===null||n===void 0?void 0:n.address;return r&&!!i})}initiateUserLogin(t,n){return Z(this,void 0,void 0,function*(){yield this.setEmail(t);const r=yield this.ctx.capsuleClient.touchSession(!0);if(!this.loginEncryptionKeyPair){const a=yield hc(this.ctx);yield this.setLoginEncryptionKeyPair(a)}const i=yield this.getWebAuthURLForLogin(r.data.sessionId,dc(this.loginEncryptionKeyPair),r.data.partnerId);return n?this.shortenLoginLink(i):i})}waitForAccountCreation(){return Z(this,void 0,void 0,function*(){for(;;)try{if(yield new Promise(t=>setTimeout(t,Cs)),yield this.isSessionActive())return}catch(t){console.error(t)}})}waitForPasskeyAndCreateWallet(){return Z(this,void 0,void 0,function*(){if(yield this.waitForAccountCreation(),(yield this.ctx.capsuleClient.getPregenWallets(this.email)).wallets[0]){const[,r]=yield this.claimPregenWallet(this.email);return r}else{const[,r]=yield this.createWallet();return r}})}getOAuthURL(t){return Z(this,void 0,void 0,function*(){yield this.logout();const n=yield this.ctx.capsuleClient.touchSession(!0);return`${yf(this.ctx.env)}auth/${t.toLowerCase()}?sessionLookupId=${encodeURIComponent(n.data.sessionLookupId)}`})}waitForOAuth(){return Z(this,void 0,void 0,function*(){for(;;)try{yield new Promise(n=>setTimeout(n,Cs));const t=yield this.ctx.capsuleClient.touchSession();if(t.data.userId){const{userId:n,email:r}=t.data;return yield this.setUserId(n),yield this.setEmail(r),{userExists:yield this.checkIfUserExists(r),email:r}}}catch(t){console.error(t)}})}waitForLoginAndSetup(t){return Z(this,void 0,void 0,function*(){for(;;)try{if(yield new Promise(i=>setTimeout(i,Cs)),!(yield this.isSessionActive()))continue;yield this.userSetupAfterLogin();const n=(yield this.fetchWallets()).filter(i=>!!i.address),r=yield this.getTransmissionKeyShares();if(r.data.temporaryShares.length===n.length)return yield this.setupAfterLogin(r.data.temporaryShares,t),{needsWallet:Object.values(this.getWallets()).length===0}}catch(n){console.error(n)}})}refreshSession(t){return Z(this,void 0,void 0,function*(){const n=yield this.ctx.capsuleClient.touchSession(!0);if(!this.loginEncryptionKeyPair){const i=yield hc(this.ctx);yield this.setLoginEncryptionKeyPair(i)}const r=yield this.getWebAuthURLForLogin(n.data.sessionId,dc(this.loginEncryptionKeyPair));return t&&this.platformUtils.openPopup(r),r})}userSetupAfterLogin(){return Z(this,void 0,void 0,function*(){const t=yield this.ctx.capsuleClient.touchSession();yield this.setUserId(t.data.userId)})}getTransmissionKeyShares(t){return Z(this,void 0,void 0,function*(){const n=yield this.ctx.capsuleClient.touchSession(),r=t?`${n.data.sessionLookupId}-new-device`:n.data.sessionLookupId;return this.ctx.capsuleClient.getTransmissionKeyshares(this.userId,r)})}setupAfterLogin(t,n){return Z(this,void 0,void 0,function*(){t||(t=(yield this.getTransmissionKeyShares()).data.temporaryShares),yield this.setWallets({}),t.forEach(r=>{this.wallets[r.walletId]={id:r.walletId,signer:Zv(this.loginEncryptionKeyPair,r.encryptedShare,r.encryptedKey)}}),yield this.deleteLoginEncryptionKeyPair(),yield this.populateWalletAddresses(),yield this.ctx.capsuleClient.touchSession(!n)})}distributeNewWalletShare(t,n,r){return Z(this,void 0,void 0,function*(){let i=n;return i||(i=this.wallets[t].signer),r?yield pf(this.ctx,this.userId,t,[],i,!1,this.getBackupKitEmailProps()):yield ea(this.ctx,this.userId,t,i,!1,this.getBackupKitEmailProps())})}waitForWalletAddress(t){return Z(this,void 0,void 0,function*(){let n=0;for(;;)try{if(n===10)break;++n;const i=(yield this.ctx.capsuleClient.getWallets(this.userId)).data.wallets.find(a=>a.id===t);if(i&&i.address)return;yield new Promise(a=>setTimeout(a,Sc))}catch(r){console.error(r)}throw new Error("timed out waiting for wallet address")})}waitForPregenWalletAddress(t,n){return Z(this,void 0,void 0,function*(){let r=0;for(;;)try{if(r===10)break;++r;const a=(yield this.ctx.capsuleClient.getPregenWallets(t)).wallets.find(s=>s.id===n);if(a&&a.address)return;yield new Promise(s=>setTimeout(s,Sc))}catch(i){console.error(i)}throw new Error("timed out waiting for wallet address")})}createWallet(t=!1,n){return Z(this,void 0,void 0,function*(){this.requireApiKey();const{signer:r,walletId:i}=yield this.platformUtils.keygen(this.ctx,this.userId,null,this.retrieveSessionCookie(),this.getBackupKitEmailProps());this.wallets[i]={id:i,signer:r},yield this.waitForWalletAddress(i),yield this.populateWalletAddresses();let a=null;return t||(a=yield ea(this.ctx,this.userId,i,r,!1,this.getBackupKitEmailProps())),yield this.setWallets(this.wallets),[this.wallets[i],a]})}createWalletPreGen(t){return Z(this,void 0,void 0,function*(){this.requireApiKey();const{signer:n,walletId:r}=yield this.platformUtils.preKeygen(this.ctx,void 0,t,null,this.retrieveSessionCookie());return this.wallets[r]={id:r,signer:n},yield this.waitForPregenWalletAddress(t,r),yield this.populatePregenWalletAddresses(t),this.wallets[r]})}claimPregenWallet(t){return Z(this,void 0,void 0,function*(){if(this.requireApiKey(),!(yield this.checkIfUserExists(t)))throw new Error("user does not exist");const i=(yield this.ctx.capsuleClient.getPregenWallets(t)).wallets[0];if(!i)throw new Error("wallet not found");yield this.ctx.capsuleClient.claimPregenWallet({userId:this.userId,walletId:i.id});const a=yield ea(this.ctx,this.userId,i.id,this.wallets[i.id].signer,!1,this.getBackupKitEmailProps());return[this.wallets[i.id],a]})}updateWalletEmailPreGen(t,n){return Z(this,void 0,void 0,function*(){this.requireApiKey();const r=n||Object.keys(this.wallets)[0];yield this.ctx.capsuleClient.updatePregenWallet(r,{email:t})})}hasPregenWallet(t){return Z(this,void 0,void 0,function*(){return this.requireApiKey(),!!(yield this.ctx.capsuleClient.getPregenWallets(t)).wallets[0]})}getUserShare(){const t=Object.values(this.wallets)[0];if(t){const n=JSON.stringify(t);return R.Buffer.from(n).toString("base64")}else return null}setUserShare(t){return Z(this,void 0,void 0,function*(){const n=R.Buffer.from(t,"base64").toString(),r=JSON.parse(n);this.wallets[r.id]=r,yield this.setWallets(this.wallets)})}getTransactionReviewUrl(t){return`${Sr(this.ctx)}/web/users/${this.userId}/transaction-review/${t}?email=${encodeURIComponent(this.email)}`}signMessage(t,n){return Z(this,void 0,void 0,function*(){const r=this.wallets[t];let i=this.userId;r.partnerId&&!r.userId&&(i=r.partnerId);const a=yield this.platformUtils.signMessage(this.ctx,i,t,this.wallets[t].signer,n,this.retrieveSessionCookie(),r.scheme===hn.DKLS);return a.pendingTransactionId?Object.assign(Object.assign({},a),{transactionReviewUrl:this.getTransactionReviewUrl(a.pendingTransactionId)}):a})}signTransaction(t,n,r){return Z(this,void 0,void 0,function*(){const i=this.wallets[t];let a=this.userId;i.partnerId&&!i.userId&&(a=i.partnerId);const s=yield this.platformUtils.signTransaction(this.ctx,a,t,this.wallets[t].signer,n,r,this.retrieveSessionCookie(),i.scheme===hn.DKLS);return s.pendingTransactionId?Object.assign(Object.assign({},s),{transactionReviewUrl:this.getTransactionReviewUrl(s.pendingTransactionId)}):s})}sendTransaction(t,n,r){return Z(this,void 0,void 0,function*(){const i=this.wallets[t],a=yield this.platformUtils.sendTransaction(this.ctx,this.userId,t,this.wallets[t].signer,n,r,this.retrieveSessionCookie(),i.scheme===hn.DKLS);return a.pendingTransactionId?Object.assign(Object.assign({},a),{transactionReviewUrl:this.getTransactionReviewUrl(a.pendingTransactionId)}):a})}isProviderModalDisabled(){return!!this.disableProviderModal}keepSessionAlive(){return Z(this,void 0,void 0,function*(){try{return yield this.ctx.capsuleClient.keepSessionAlive(this.userId),!0}catch{return!1}})}exportSession(){const t={email:this.email,userId:this.userId,wallets:this.wallets,sessionCookie:this.sessionCookie};return R.Buffer.from(JSON.stringify(t)).toString("base64")}importSession(t){return Z(this,void 0,void 0,function*(){const n=R.Buffer.from(t,"base64").toString("utf8"),r=JSON.parse(n);yield this.setEmail(r.email),yield this.setUserId(r.userId),yield this.setWallets(r.wallets),this.persistSessionCookie(r.sessionCookie)})}logout(){return Z(this,void 0,void 0,function*(){yield this.ctx.capsuleClient.logout(),yield this.clearStorage(),this.wallets={},this.loginEncryptionKeyPair=void 0,this.email=void 0,this.userId=void 0,this.sessionCookie=void 0})}toString(){const t=Object.keys(this.wallets).reduce((r,i)=>Object.assign(Object.assign({},r),{[i]:{id:i,address:this.wallets[i].address,signer:this.wallets[i].signer?"[REDACTED]":void 0}}),{}),n={email:this.email,userId:this.userId,wallets:t,loginEncryptionKeyPair:this.loginEncryptionKeyPair?"[REDACTED]":void 0};return`Capsule ${JSON.stringify(n)}`}}var i1=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function mf(e,t,n){return i1(this,void 0,void 0,function*(){const r=Date.now();for(;Date.now()-r<t;){if(yield e())return!0;yield new Promise(i=>setTimeout(i,n))}return!1})}function bf(e){return{r:`0x${e.slice(2,66)}`,s:`0x${e.slice(66,130)}`,v:BigInt(e.slice(130,132))}}function bi(e){return e.startsWith("0x")&&(e=e.slice(2)),new Uint8Array(R.Buffer.from(e,"hex"))}class a1{constructor(){this.get=t=>typeof window<"u"&&localStorage.getItem(t)||null,this.set=(t,n)=>{typeof window<"u"&&localStorage.setItem(t,n)},this.removeItem=t=>{typeof window<"u"&&localStorage.removeItem(t)},this.clear=t=>{if(typeof window<"u")for(let n=0;n<localStorage.length;n++){const r=localStorage.key(n);r&&r.startsWith(t)&&(localStorage.removeItem(r),n--)}}}}class s1{constructor(){this.get=t=>typeof window<"u"&&sessionStorage.getItem(t)||null,this.set=(t,n)=>{typeof window<"u"&&sessionStorage.setItem(t,n)},this.removeItem=t=>{typeof window<"u"&&sessionStorage.removeItem(t)},this.clear=t=>{if(typeof window<"u")for(let n=0;n<sessionStorage.length;n++){const r=sessionStorage.key(n);r&&r.startsWith(t)&&(sessionStorage.removeItem(r),n--)}}}}var o1=G&&G.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};(()=>{const e=()=>{const r=new Error("not implemented");return r.code="ENOSYS",r};if(!globalThis.fs){let r="";globalThis.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(i,a){r+=n.decode(a);const s=r.lastIndexOf(`
`);return s!=-1&&(console.log(r.substring(0,s)),r=r.substring(s+1)),a.length},write(i,a,s,o,u,c){if(s!==0||o!==a.length||u!==null){c(e());return}const l=this.writeSync(i,a);c(null,l)},chmod(i,a,s){s(e())},chown(i,a,s,o){o(e())},close(i,a){a(e())},fchmod(i,a,s){s(e())},fchown(i,a,s,o){o(e())},fstat(i,a){a(e())},fsync(i,a){a(null)},ftruncate(i,a,s){s(e())},lchown(i,a,s,o){o(e())},link(i,a,s){s(e())},lstat(i,a){a(e())},mkdir(i,a,s){s(e())},open(i,a,s,o){o(e())},read(i,a,s,o,u,c){c(e())},readdir(i,a){a(e())},readlink(i,a){a(e())},rename(i,a,s){s(e())},rmdir(i,a){a(e())},stat(i,a){a(e())},symlink(i,a,s){s(e())},truncate(i,a,s){s(e())},unlink(i,a){a(e())},utimes(i,a,s,o){o(e())}}}if(globalThis.process||(globalThis.process={getuid(){return-1},getgid(){return-1},geteuid(){return-1},getegid(){return-1},getgroups(){throw e()},pid:-1,ppid:-1,umask(){throw e()},cwd(){throw e()},chdir(){throw e()}}),!globalThis.crypto)throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");if(globalThis.performance||(globalThis.performance=Date),!globalThis.TextEncoder)throw new Error("globalThis.TextEncoder is not available, polyfill required");if(!globalThis.TextDecoder)throw new Error("globalThis.TextDecoder is not available, polyfill required");const t=new TextEncoder("utf-8"),n=new TextDecoder("utf-8");globalThis.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=f=>{f!==0&&console.warn("exit code:",f)},this._exitPromise=new Promise(f=>{this._resolveExitPromise=f}),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;const r=(f,d)=>{this.mem.setUint32(f+0,d,!0),this.mem.setUint32(f+4,Math.floor(d/4294967296),!0)},i=f=>{const d=this.mem.getUint32(f+0,!0),v=this.mem.getInt32(f+4,!0);return d+v*4294967296},a=f=>{const d=this.mem.getFloat64(f,!0);if(d===0)return;if(!isNaN(d))return d;const v=this.mem.getUint32(f,!0);return this._values[v]},s=(f,d)=>{if(typeof d=="number"&&d!==0){if(isNaN(d)){this.mem.setUint32(f+4,2146959360,!0),this.mem.setUint32(f,0,!0);return}this.mem.setFloat64(f,d,!0);return}if(d===void 0){this.mem.setFloat64(f,0,!0);return}let h=this._ids.get(d);h===void 0&&(h=this._idPool.pop(),h===void 0&&(h=this._values.length),this._values[h]=d,this._goRefCounts[h]=0,this._ids.set(d,h)),this._goRefCounts[h]++;let m=0;switch(typeof d){case"object":d!==null&&(m=1);break;case"string":m=2;break;case"symbol":m=3;break;case"function":m=4;break}this.mem.setUint32(f+4,2146959360|m,!0),this.mem.setUint32(f,h,!0)},o=f=>{const d=i(f+0),v=i(f+8);return new Uint8Array(this._inst.exports.mem.buffer,d,v)},u=f=>{const d=i(f+0),v=i(f+8),h=new Array(v);for(let m=0;m<v;m++)h[m]=a(d+m*8);return h},c=f=>{const d=i(f+0),v=i(f+8);return n.decode(new DataView(this._inst.exports.mem.buffer,d,v))},l=Date.now()-performance.now();this.importObject={_gotest:{add:(f,d)=>f+d},gojs:{"runtime.wasmExit":f=>{f>>>=0;const d=this.mem.getInt32(f+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(d)},"runtime.wasmWrite":f=>{f>>>=0;const d=i(f+8),v=i(f+16),h=this.mem.getInt32(f+24,!0);fs.writeSync(d,new Uint8Array(this._inst.exports.mem.buffer,v,h))},"runtime.resetMemoryDataView":f=>{this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":f=>{f>>>=0,r(f+8,(l+performance.now())*1e6)},"runtime.walltime":f=>{f>>>=0;const d=new Date().getTime();r(f+8,d/1e3),this.mem.setInt32(f+16,d%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":f=>{f>>>=0;const d=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(d,setTimeout(()=>{for(this._resume();this._scheduledTimeouts.has(d);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()},i(f+8))),this.mem.setInt32(f+16,d,!0)},"runtime.clearTimeoutEvent":f=>{f>>>=0;const d=this.mem.getInt32(f+8,!0);clearTimeout(this._scheduledTimeouts.get(d)),this._scheduledTimeouts.delete(d)},"runtime.getRandomData":f=>{f>>>=0,crypto.getRandomValues(o(f+8))},"syscall/js.finalizeRef":f=>{f>>>=0;const d=this.mem.getUint32(f+8,!0);if(this._goRefCounts[d]--,this._goRefCounts[d]===0){const v=this._values[d];this._values[d]=null,this._ids.delete(v),this._idPool.push(d)}},"syscall/js.stringVal":f=>{f>>>=0,s(f+24,c(f+8))},"syscall/js.valueGet":f=>{f>>>=0;const d=Reflect.get(a(f+8),c(f+16));f=this._inst.exports.getsp()>>>0,s(f+32,d)},"syscall/js.valueSet":f=>{f>>>=0,Reflect.set(a(f+8),c(f+16),a(f+32))},"syscall/js.valueDelete":f=>{f>>>=0,Reflect.deleteProperty(a(f+8),c(f+16))},"syscall/js.valueIndex":f=>{f>>>=0,s(f+24,Reflect.get(a(f+8),i(f+16)))},"syscall/js.valueSetIndex":f=>{f>>>=0,Reflect.set(a(f+8),i(f+16),a(f+24))},"syscall/js.valueCall":f=>{f>>>=0;try{const d=a(f+8),v=Reflect.get(d,c(f+16)),h=u(f+32),m=Reflect.apply(v,d,h);f=this._inst.exports.getsp()>>>0,s(f+56,m),this.mem.setUint8(f+64,1)}catch(d){f=this._inst.exports.getsp()>>>0,s(f+56,d),this.mem.setUint8(f+64,0)}},"syscall/js.valueInvoke":f=>{f>>>=0;try{const d=a(f+8),v=u(f+16),h=Reflect.apply(d,void 0,v);f=this._inst.exports.getsp()>>>0,s(f+40,h),this.mem.setUint8(f+48,1)}catch(d){f=this._inst.exports.getsp()>>>0,s(f+40,d),this.mem.setUint8(f+48,0)}},"syscall/js.valueNew":f=>{f>>>=0;try{const d=a(f+8),v=u(f+16),h=Reflect.construct(d,v);f=this._inst.exports.getsp()>>>0,s(f+40,h),this.mem.setUint8(f+48,1)}catch(d){f=this._inst.exports.getsp()>>>0,s(f+40,d),this.mem.setUint8(f+48,0)}},"syscall/js.valueLength":f=>{f>>>=0,r(f+16,parseInt(a(f+8).length))},"syscall/js.valuePrepareString":f=>{f>>>=0;const d=t.encode(String(a(f+8)));s(f+16,d),r(f+24,d.length)},"syscall/js.valueLoadString":f=>{f>>>=0;const d=a(f+8);o(f+16).set(d)},"syscall/js.valueInstanceOf":f=>{f>>>=0,this.mem.setUint8(f+24,a(f+8)instanceof a(f+16)?1:0)},"syscall/js.copyBytesToGo":f=>{f>>>=0;const d=o(f+8),v=a(f+32);if(!(v instanceof Uint8Array||v instanceof Uint8ClampedArray)){this.mem.setUint8(f+48,0);return}const h=v.subarray(0,d.length);d.set(h),r(f+40,h.length),this.mem.setUint8(f+48,1)},"syscall/js.copyBytesToJS":f=>{f>>>=0;const d=a(f+8),v=o(f+16);if(!(d instanceof Uint8Array||d instanceof Uint8ClampedArray)){this.mem.setUint8(f+48,0);return}const h=v.subarray(0,d.length);d.set(h),r(f+40,h.length),this.mem.setUint8(f+48,1)},debug:f=>{console.log(f)}}}}run(r){return o1(this,void 0,void 0,function*(){if(!(r instanceof WebAssembly.Instance))throw new Error("Go.run: WebAssembly.Instance expected");this._inst=r,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,globalThis,this],this._goRefCounts=new Array(this._values.length).fill(1/0),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[globalThis,5],[this,6]]),this._idPool=[],this.exited=!1;let i=4096;const a=f=>{const d=i,v=t.encode(f+"\0");return new Uint8Array(this.mem.buffer,i,v.length).set(v),i+=v.length,i%8!==0&&(i+=8-i%8),d},s=this.argv.length,o=[];this.argv.forEach(f=>{o.push(a(f))}),o.push(0),Object.keys(this.env).sort().forEach(f=>{o.push(a(`${f}=${this.env[f]}`))}),o.push(0);const c=i;o.forEach(f=>{this.mem.setUint32(i,f,!0),this.mem.setUint32(i+4,0,!0),i+=8});const l=4096+8192;if(i>=l)throw new Error("total length of command line and environment variables exceeds limit");this._inst.exports.run(s,c),this.exited&&this._resolveExitPromise(),yield this._exitPromise})}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(r){const i=this;return function(){const a={id:r,this:this,args:arguments};return i._pendingEvent=a,i._resume(),a.result}}}})();var ar=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};const u1=(e,t,n)=>`{"ServerUrl":"${e}", "WalletId": "${t}", "Id":"${n}", "Ids":["USER","CAPSULE"], "Threshold":1}`,Sf=(e,t,n)=>`{"walletId": "${e}", "id":"${t}", "otherId":"CAPSULE", "isReceiver": false, "disableWebSockets": ${n}}`;function c1(e,t,n,r){return ar(this,void 0,void 0,function*(){const{data:i}=yield e.mpcComputationClient.post("/wallets",{userId:t,walletId:n,protocolId:r});return i})}function l1(e,t,n,r,i,a){return ar(this,void 0,void 0,function*(){const{data:s}=yield e.mpcComputationClient.post(`/wallets/${n}/messages/sign`,{userId:t,protocolId:r,message:i,signer:a});return s})}function Ef(e,t,n,r,i,a,s){return ar(this,void 0,void 0,function*(){const{data:o}=yield e.mpcComputationClient.post(`/wallets/${n}/transactions/send`,{userId:t,protocolId:r,transaction:i,signer:a,chainId:s});return o})}function f1(e,t,n){return ar(this,void 0,void 0,function*(){const{walletId:r,protocolId:i}=yield e.capsuleClient.createWallet(t,{useTwoSigners:!0,scheme:e.useDKLS?sa.DKLS:sa.CGGMP});if(e.offloadMPCComputationURL&&!e.useDKLS)return{signer:(yield c1(e,t,r,i)).signer,walletId:r};const a=Hn(e.env,!e.disableWebSockets),s=e.useDKLS?Sf(r,"USER",e.disableWebSockets):u1(a,r,"USER"),o=e.useDKLS?st.dklsCreateAccount:st.createAccountV2;return{signer:yield new Promise((c,l)=>o(s,a,i,n,()=>{},(f,d)=>{f&&l(f),c(d)})),walletId:r}})}function d1(e,t,n,r){return ar(this,void 0,void 0,function*(){const{walletId:i,protocolId:a}=yield e.capsuleClient.createPregenWallet({email:n}),s=Hn(e.env,!e.disableWebSockets),o=Sf(i,"USER",e.disableWebSockets);return{signer:yield new Promise((c,l)=>st.dklsCreateAccount(o,s,a,r,()=>{},(f,d)=>{f&&l(f),c(d)})),walletId:i}})}function h1(e,t,n,r,i){return ar(this,void 0,void 0,function*(){const{protocolId:a,pendingTransactionId:s}=yield e.capsuleClient.preSignMessage(r,n,i);if(s)return console.error("sign message denied"),{pendingTransactionId:s};if(e.offloadMPCComputationURL&&!e.useDKLS)return l1(e,r,n,a,i,t);const o=Hn(e.env,!e.disableWebSockets),u=e.useDKLS?st.dklsSignMessage:st.signMessage,c=JSON.parse(t);return!c.disableWebSockets!=!e.disableWebSockets&&(c.disableWebSockets=e.disableWebSockets),t=JSON.stringify(c),new Promise((l,f)=>u(t,o,i,a,(d,v)=>{d&&f(d),l({signature:v})}))})}function p1(e,t,n,r,i,a){return ar(this,void 0,void 0,function*(){const{data:{protocolId:s,pendingTransactionId:o}}=yield e.capsuleClient.signTransaction(r,n,{transaction:i,chainId:a});if(o)return console.error("send transaction denied"),{pendingTransactionId:o};if(e.offloadMPCComputationURL&&!e.useDKLS)return Ef(e,r,n,s,i,t,a);const u=Hn(e.env,!e.disableWebSockets),c=e.useDKLS?st.dklsSendTransaction:st.sendTransaction,l=JSON.parse(t);return!l.disableWebSockets!=!e.disableWebSockets&&(l.disableWebSockets=e.disableWebSockets),t=JSON.stringify(l),new Promise((f,d)=>c(t,u,i,a,s,(v,h)=>{v&&d(v),f({signature:h})}))})}function y1(e,t,n,r,i,a){return ar(this,void 0,void 0,function*(){const{data:{protocolId:s,pendingTransactionId:o}}=yield e.capsuleClient.sendTransaction(r,n,{transaction:i,chainId:a});if(o)return console.error("send transaction denied"),{pendingTransactionId:o};if(e.offloadMPCComputationURL&&!e.useDKLS)return Ef(e,r,n,s,i,t,a);const u=Hn(e.env,!e.disableWebSockets),c=e.useDKLS?st.dklsSendTransaction:st.sendTransaction,l=JSON.parse(t);return!l.disableWebSockets!=!e.disableWebSockets&&(l.disableWebSockets=e.disableWebSockets),t=JSON.stringify(l),new Promise((f,d)=>c(t,u,i,a,s,(v,h)=>{v&&d(v),f({signature:h})}))})}function g1(e,t,n,r){return ar(this,void 0,void 0,function*(){const{data:{protocolId:i}}=yield e.capsuleClient.refreshKeys(r,n),a=Hn(e.env,!e.disableWebSockets),s=e.useDKLS?st.dklsRefresh:st.refresh,o=JSON.parse(t);return!o.disableWebSockets!=!e.disableWebSockets&&(o.disableWebSockets=e.disableWebSockets),t=JSON.stringify(o),new Promise((u,c)=>s(t,a,i,(l,f)=>{l&&c(l),u(f)}))})}function v1(e,t,n,r){return ar(this,void 0,void 0,function*(){const i=yield e.capsuleClient.getCapsuleShare(r,n);return i?new Promise((a,s)=>st.getPrivateKey(t,i,(o,u)=>{o&&s(o),a(u)})):""})}var tu=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function m1(e,t){return tu(this,void 0,void 0,function*(){const n=new self.Go;let r=t;if(!r){if({}.DISABLE_WASM_FETCH==="true")throw new Error("fetching wasm file is disabled");r=yield(yield fetch(`${Sr(e)}/static/js/main.wasm`,{mode:"cors"})).arrayBuffer()}const i=yield WebAssembly.instantiate(r,n.importObject);n.run(i.instance)})}function b1(e,t){return tu(this,void 0,void 0,function*(){const{functionType:n,params:r}=t;switch(n){case"KEYGEN":{const{userId:i,secretKey:a}=r;return yield f1(e,i,a)}case"SIGN_TRANSACTION":{const{share:i,walletId:a,userId:s,tx:o,chainId:u}=r;return p1(e,i,a,s,o,u)}case"SEND_TRANSACTION":{const{share:i,walletId:a,userId:s,tx:o,chainId:u}=r;return y1(e,i,a,s,o,u)}case"SIGN_MESSAGE":{const{share:i,walletId:a,userId:s,message:o}=r;return h1(e,i,a,s,o)}case"REFRESH":{const{share:i,walletId:a,userId:s}=r;return g1(e,i,a,s)}case"PREKEYGEN":{const{partnerId:i,secretKey:a,email:s}=r;return yield d1(e,i,s,a)}case"GET_PRIVATE_KEY":{const{share:i,walletId:a,userId:s}=r;return yield v1(e,i,a,s)}default:throw new Error(`functionType: ${n} not supported`)}})}function S1(e,t,n){return tu(this,void 0,void 0,function*(){const{env:r,apiKey:i,offloadMPCComputationURL:a,disableWorkers:s,sessionCookie:o,useDKLS:u,disableWebSockets:c,wasmOverride:l}=e.data;if(!r)return!0;const f={env:r,apiKey:i,capsuleClient:gf(r,i,n,()=>o),offloadMPCComputationURL:a,mpcComputationClient:a?vf(a,!!s):void 0,useDKLS:u,disableWebSockets:!!c,wasmOverride:l};(!f.offloadMPCComputationURL||f.useDKLS)&&(yield m1(f,l));const d=yield b1(f,e.data);return t(d),!1})}var Ec=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function jn(e,t){return Ec(this,void 0,void 0,function*(){const n=i=>{i.data.functionType!=="CUSTOM"&&t(i.data)};if(e.disableWorkers)return{postMessage:function(a){(function(){return Ec(this,void 0,void 0,function*(){yield S1({data:a},s=>n({data:s}),e.disableWorkers)})})()},terminate:()=>{}};let r;if(e.useLocalFiles)throw new Error("useLocalFiles only supported locally");{const i=yield fetch(`${Sr(e)}/static/js/mpcWorker-bundle.js`),a=new Blob([yield i.text()],{type:"application/javascript"}),s=URL.createObjectURL(a);r=new Worker(s)}return r.onmessage=n,r})}var Rr=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function E1(e,t,n){return Rr(this,void 0,void 0,function*(){return!!(yield e.capsuleClient.getWallets(t)).data.wallets.find(a=>a.id===n).address})}function C1(e,t,n){return Rr(this,void 0,void 0,function*(){return!!(yield e.capsuleClient.getPregenWallets(t)).wallets.find(a=>a.id===n).address})}function w1(e,t,n,r=!1,i,a={}){return new Promise(s=>Rr(this,void 0,void 0,function*(){const o=yield jn(e,u=>Rr(this,void 0,void 0,function*(){if(yield mf(()=>Rr(this,void 0,void 0,function*(){return E1(e,t,u.walletId)}),15e3,1e3),r){s({signer:u.signer,walletId:u.walletId,recoveryShare:null}),o.terminate();return}const c=yield ea(e,t,u.walletId,u.signer,!1,a);s({signer:u.signer,walletId:u.walletId,recoveryShare:c}),o.terminate()}));o.postMessage({env:e.env,apiKey:e.apiKey,params:{userId:t,secretKey:n},functionType:"KEYGEN",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:i,useDKLS:e.useDKLS,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))}function T1(e,t,n,r=!1,i,a){return new Promise(s=>Rr(this,void 0,void 0,function*(){const o=yield jn(e,u=>Rr(this,void 0,void 0,function*(){yield mf(()=>Rr(this,void 0,void 0,function*(){return C1(e,t,u.walletId)}),15e3,1e3),s({signer:u.signer,walletId:u.walletId,recoveryShare:null}),o.terminate()}));o.postMessage({env:e.env,apiKey:e.apiKey,params:{email:t,secretKey:n,partnerId:i},functionType:"PREKEYGEN",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:a,useDKLS:e.useDKLS,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))}var hr=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function x1(e,t,n,r,i,a,s,o){return hr(this,void 0,void 0,function*(){return yield new Promise(u=>hr(this,void 0,void 0,function*(){const c=yield jn(e,l=>hr(this,void 0,void 0,function*(){u(l),c.terminate()}));c.postMessage({env:e.env,apiKey:e.apiKey,params:{share:r,walletId:n,userId:t,tx:i,chainId:a},functionType:"SIGN_TRANSACTION",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:s,useDKLS:o,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}function A1(e,t,n,r,i,a,s,o){return hr(this,void 0,void 0,function*(){return yield new Promise(u=>hr(this,void 0,void 0,function*(){const c=yield jn(e,l=>hr(this,void 0,void 0,function*(){u(l),c.terminate()}));c.postMessage({env:e.env,apiKey:e.apiKey,params:{share:r,walletId:n,userId:t,tx:i,chainId:a},functionType:"SEND_TRANSACTION",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:s,useDKLS:o,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}function I1(e,t,n,r,i,a,s){return hr(this,void 0,void 0,function*(){return yield new Promise(o=>hr(this,void 0,void 0,function*(){const u=yield jn(e,c=>hr(this,void 0,void 0,function*(){o(c),u.terminate()}));u.postMessage({env:e.env,apiKey:e.apiKey,params:{share:r,walletId:n,userId:t,message:i},functionType:"SIGN_MESSAGE",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:a,useDKLS:s,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}var ws=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};function B1(e,t,n,r,i){return ws(this,void 0,void 0,function*(){return yield new Promise(a=>ws(this,void 0,void 0,function*(){const s=yield jn(e,o=>ws(this,void 0,void 0,function*(){a(o),s.terminate()}));s.postMessage({env:e.env,apiKey:e.apiKey,params:{share:r,walletId:n,userId:t},functionType:"GET_PRIVATE_KEY",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:i,useDKLS:e.useDKLS,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}class _1{constructor(){this.localStorage=new a1,this.sessionStorage=new s1,this.secureStorage=null,this.isSyncStorage=!0,this.disableProviderModal=!1}getPrivateKey(t,n,r,i,a){return B1(t,n,r,i,a)}keygen(t,n,r,i,a={}){return w1(t,n,r,!0,i,a)}preKeygen(t,n,r,i,a){return T1(t,r,i,!1,n,a)}signMessage(t,n,r,i,a,s,o){return I1(t,n,r,i,a,s,o)}signTransaction(t,n,r,i,a,s,o,u){return x1(t,n,r,i,a,s,o,u)}sendTransaction(t,n,r,i,a,s,o,u){return A1(t,n,r,i,a,s,o,u)}signHash(t,n){throw new Error("not implemented")}openPopup(t){window.open(t,"popup","popup=true,width=400,height=500")||setTimeout(()=>{window.open(t,"_blank")},0)}}class k1 extends n1{getPlatformUtils(){return new _1}}var Si={},Ct={},qn={},Zt={},Lt={},wn={};Object.defineProperty(wn,"__esModule",{value:!0});wn.fromAscii=wn.toAscii=void 0;function R1(e){const t=n=>n.split("").map(r=>{const i=r.charCodeAt(0);if(i<32||i>126)throw new Error("Cannot encode character that is out of printable ASCII range: "+i);return i});return Uint8Array.from(t(e))}wn.toAscii=R1;function N1(e){return(n=>n.map(r=>{if(r<32||r>126)throw new Error("Cannot decode character that is out of printable ASCII range: "+r);return String.fromCharCode(r)}))(Array.from(e)).join("")}wn.fromAscii=N1;var Tn={},P1=G&&G.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),L1=G&&G.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),U1=G&&G.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&P1(t,e,n);return L1(t,e),t};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.fromBase64=Tn.toBase64=void 0;const Cf=U1(od);function O1(e){return Cf.fromByteArray(e)}Tn.toBase64=O1;function D1(e){if(!e.match(/^[a-zA-Z0-9+/]*={0,2}$/))throw new Error("Invalid base64 string format");return Cf.toByteArray(e)}Tn.fromBase64=D1;var Nr={},K1=G&&G.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),F1=G&&G.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),M1=G&&G.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&K1(t,e,n);return F1(t,e),t};Object.defineProperty(Nr,"__esModule",{value:!0});Nr.normalizeBech32=Nr.fromBech32=Nr.toBech32=void 0;const Sa=M1(ud);function wf(e,t,n){return Sa.encode(e,Sa.toWords(t),n)}Nr.toBech32=wf;function Tf(e,t=1/0){const n=Sa.decode(e,t);return{prefix:n.prefix,data:new Uint8Array(Sa.fromWords(n.words))}}Nr.fromBech32=Tf;function V1(e){const{prefix:t,data:n}=Tf(e);return wf(t,n)}Nr.normalizeBech32=V1;var xn={};Object.defineProperty(xn,"__esModule",{value:!0});xn.fromHex=xn.toHex=void 0;function $1(e){let t="";for(const n of e)t+=("0"+n.toString(16)).slice(-2);return t}xn.toHex=$1;function H1(e){if(e.length%2!==0)throw new Error("hex string length must be a multiple of 2");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n,i=e.slice(r,r+2);if(!i.match(/[0-9a-f]{2}/i))throw new Error("hex string contains invalid characters");t[n]=parseInt(i,16)}return t}xn.fromHex=H1;var An={};Object.defineProperty(An,"__esModule",{value:!0});An.toRfc3339=An.fromRfc3339=void 0;const j1=/^(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(\.\d{1,9})?((?:[+-]\d{2}:\d{2})|Z)$/;function on(e,t=2){return e.toString().padStart(t,"0")}function q1(e){const t=j1.exec(e);if(!t)throw new Error("Date string is not in RFC3339 format");const n=+t[1],r=+t[2],i=+t[3],a=+t[4],s=+t[5],o=+t[6],u=t[7]?Math.floor(+t[7]*1e3):0;let c,l,f;t[8]==="Z"?(c=1,l=0,f=0):(c=t[8].substring(0,1)==="-"?-1:1,l=+t[8].substring(1,3),f=+t[8].substring(4,6));const d=c*(l*60+f)*60,v=Date.UTC(n,r-1,i,a,s,o,u)-d*1e3;return new Date(v)}An.fromRfc3339=q1;function G1(e){const t=e.getUTCFullYear(),n=on(e.getUTCMonth()+1),r=on(e.getUTCDate()),i=on(e.getUTCHours()),a=on(e.getUTCMinutes()),s=on(e.getUTCSeconds()),o=on(e.getUTCMilliseconds(),3);return`${t}-${n}-${r}T${i}:${a}:${s}.${o}Z`}An.toRfc3339=G1;var In={};Object.defineProperty(In,"__esModule",{value:!0});In.fromUtf8=In.toUtf8=void 0;function W1(e){return new TextEncoder().encode(e)}In.toUtf8=W1;function z1(e,t=!1){const n=!t;return new TextDecoder("utf-8",{fatal:n}).decode(e)}In.fromUtf8=z1;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toUtf8=e.fromUtf8=e.toRfc3339=e.fromRfc3339=e.toHex=e.fromHex=e.toBech32=e.normalizeBech32=e.fromBech32=e.toBase64=e.fromBase64=e.toAscii=e.fromAscii=void 0;var t=wn;Object.defineProperty(e,"fromAscii",{enumerable:!0,get:function(){return t.fromAscii}}),Object.defineProperty(e,"toAscii",{enumerable:!0,get:function(){return t.toAscii}});var n=Tn;Object.defineProperty(e,"fromBase64",{enumerable:!0,get:function(){return n.fromBase64}}),Object.defineProperty(e,"toBase64",{enumerable:!0,get:function(){return n.toBase64}});var r=Nr;Object.defineProperty(e,"fromBech32",{enumerable:!0,get:function(){return r.fromBech32}}),Object.defineProperty(e,"normalizeBech32",{enumerable:!0,get:function(){return r.normalizeBech32}}),Object.defineProperty(e,"toBech32",{enumerable:!0,get:function(){return r.toBech32}});var i=xn;Object.defineProperty(e,"fromHex",{enumerable:!0,get:function(){return i.fromHex}}),Object.defineProperty(e,"toHex",{enumerable:!0,get:function(){return i.toHex}});var a=An;Object.defineProperty(e,"fromRfc3339",{enumerable:!0,get:function(){return a.fromRfc3339}}),Object.defineProperty(e,"toRfc3339",{enumerable:!0,get:function(){return a.toRfc3339}});var s=In;Object.defineProperty(e,"fromUtf8",{enumerable:!0,get:function(){return s.fromUtf8}}),Object.defineProperty(e,"toUtf8",{enumerable:!0,get:function(){return s.toUtf8}})})(Lt);var dt={},ki={},Bn={};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.arrayContentStartsWith=Bn.arrayContentEquals=void 0;function Q1(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}Bn.arrayContentEquals=Q1;function Y1(e,t){if(e.length<t.length)return!1;for(let n=0;n<t.length;++n)if(e[n]!==t[n])return!1;return!0}Bn.arrayContentStartsWith=Y1;var Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});Pr.assertDefinedAndNotNull=Pr.assertDefined=Pr.assert=void 0;function X1(e,t){if(!e)throw new Error(t||"condition is not truthy")}Pr.assert=X1;function J1(e,t){if(e===void 0)throw new Error(t??"value is undefined")}Pr.assertDefined=J1;function Z1(e,t){if(e==null)throw new Error(t??"value is undefined or null")}Pr.assertDefinedAndNotNull=Z1;var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0});Wa.sleep=void 0;async function eb(e){return new Promise(t=>setTimeout(t,e))}Wa.sleep=eb;var Lr={};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.isDefined=Lr.isUint8Array=Lr.isNonNullObject=void 0;function xf(e){return typeof e=="object"&&e!==null}Lr.isNonNullObject=xf;function tb(e){return!(!xf(e)||Object.prototype.toString.call(e)!=="[object Uint8Array]"||typeof R.Buffer<"u"&&typeof R.Buffer.isBuffer<"u"&&R.Buffer.isBuffer(e))}Lr.isUint8Array=tb;function rb(e){return e!==void 0}Lr.isDefined=rb;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isUint8Array=e.isNonNullObject=e.isDefined=e.sleep=e.assertDefinedAndNotNull=e.assertDefined=e.assert=e.arrayContentStartsWith=e.arrayContentEquals=void 0;var t=Bn;Object.defineProperty(e,"arrayContentEquals",{enumerable:!0,get:function(){return t.arrayContentEquals}}),Object.defineProperty(e,"arrayContentStartsWith",{enumerable:!0,get:function(){return t.arrayContentStartsWith}});var n=Pr;Object.defineProperty(e,"assert",{enumerable:!0,get:function(){return n.assert}}),Object.defineProperty(e,"assertDefined",{enumerable:!0,get:function(){return n.assertDefined}}),Object.defineProperty(e,"assertDefinedAndNotNull",{enumerable:!0,get:function(){return n.assertDefinedAndNotNull}});var r=Wa;Object.defineProperty(e,"sleep",{enumerable:!0,get:function(){return r.sleep}});var i=Lr;Object.defineProperty(e,"isDefined",{enumerable:!0,get:function(){return i.isDefined}}),Object.defineProperty(e,"isNonNullObject",{enumerable:!0,get:function(){return i.isNonNullObject}}),Object.defineProperty(e,"isUint8Array",{enumerable:!0,get:function(){return i.isUint8Array}})})(ki);var nb=G&&G.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),ib=G&&G.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ab=G&&G.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&nb(t,e,n);return ib(t,e),t};Object.defineProperty(dt,"__esModule",{value:!0});dt.pbkdf2Sha512=dt.pbkdf2Sha512Noble=dt.pbkdf2Sha512NodeCrypto=dt.pbkdf2Sha512Subtle=dt.getSubtle=dt.getNodeCrypto=void 0;const Xr=ki,sb=cd,ob=Pc;async function Af(){try{const e=await Promise.resolve().then(()=>ab(tn()));return typeof e=="object"&&Object.keys(e).length<=1?void 0:e}catch{return}}dt.getNodeCrypto=Af;async function If(){var t,n,r;let e=(t=globalThis==null?void 0:globalThis.crypto)==null?void 0:t.subtle;return e||(e=(r=(n=globalThis==null?void 0:globalThis.crypto)==null?void 0:n.webcrypto)==null?void 0:r.subtle),e}dt.getSubtle=If;async function Bf(e,t,n,r,i){return(0,Xr.assert)(e,"Argument subtle is falsy"),(0,Xr.assert)(typeof e=="object","Argument subtle is not of type object"),(0,Xr.assert)(typeof e.importKey=="function","subtle.importKey is not a function"),(0,Xr.assert)(typeof e.deriveBits=="function","subtle.deriveBits is not a function"),e.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]).then(a=>e.deriveBits({name:"PBKDF2",salt:n,iterations:r,hash:{name:"SHA-512"}},a,i*8).then(s=>new Uint8Array(s)))}dt.pbkdf2Sha512Subtle=Bf;async function _f(e,t,n,r,i){return(0,Xr.assert)(e,"Argument nodeCrypto is falsy"),(0,Xr.assert)(typeof e=="object","Argument nodeCrypto is not of type object"),(0,Xr.assert)(typeof e.pbkdf2=="function","nodeCrypto.pbkdf2 is not a function"),new Promise((a,s)=>{e.pbkdf2(t,n,r,i,"sha512",(o,u)=>{o?s(o):a(Uint8Array.from(u))})})}dt.pbkdf2Sha512NodeCrypto=_f;async function kf(e,t,n,r){return(0,sb.pbkdf2Async)(ob.sha512,e,t,{c:n,dkLen:r})}dt.pbkdf2Sha512Noble=kf;async function ub(e,t,n,r){const i=await If();if(i)return Bf(i,e,t,n,r);{const a=await Af();return a?_f(a,e,t,n,r):kf(e,t,n,r)}}dt.pbkdf2Sha512=ub;var Rt={},Gn={};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.toRealUint8Array=void 0;function cb(e){return e instanceof Uint8Array?e:Uint8Array.from(e)}Gn.toRealUint8Array=cb;Object.defineProperty(Rt,"__esModule",{value:!0});Rt.sha512=Rt.Sha512=Rt.sha256=Rt.Sha256=void 0;const lb=ld,fb=Pc,Rf=Gn;class Nf{constructor(t){this.blockSize=512/8,this.impl=lb.sha256.create(),t&&this.update(t)}update(t){return this.impl.update((0,Rf.toRealUint8Array)(t)),this}digest(){return this.impl.digest()}}Rt.Sha256=Nf;function db(e){return new Nf(e).digest()}Rt.sha256=db;class Pf{constructor(t){this.blockSize=1024/8,this.impl=fb.sha512.create(),t&&this.update(t)}update(t){return this.impl.update((0,Rf.toRealUint8Array)(t)),this}digest(){return this.impl.digest()}}Rt.Sha512=Pf;function hb(e){return new Pf(e).digest()}Rt.sha512=hb;Object.defineProperty(Zt,"__esModule",{value:!0});Zt.Bip39=Zt.EnglishMnemonic=Zt.mnemonicToEntropy=Zt.entropyToMnemonic=void 0;const Cc=Lt,pb=dt,yb=Rt,ru=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"];function Lf(e){return Array.from(e).map(t=>t.toString(2).padStart(8,"0")).join("")}function Uf(e){const n=e.length*8/32,r=(0,yb.sha256)(e);return Lf(r).slice(0,n)}function Of(e){return parseInt(e,2)}const gb=[16,20,24,28,32],vb=[12,15,18,21,24];function Df(e){if(gb.indexOf(e.length)===-1)throw new Error("invalid input length");const t=Lf(e),n=Uf(e);return(t+n).match(/(.{11})/g).map(s=>{const o=Of(s);return ru[o]}).join(" ")}Zt.entropyToMnemonic=Df;const mb="Invalid number of words",bb="Found word that is not in the wordlist",Sb="Invalid entropy",Eb="Invalid mnemonic checksum";function oo(e){return e.normalize("NFKD")}function nu(e){const t=oo(e).split(" ");if(!vb.includes(t.length))throw new Error(mb);const n=t.map(c=>{const l=ru.indexOf(c);if(l===-1)throw new Error(bb);return l.toString(2).padStart(11,"0")}).join(""),r=Math.floor(n.length/33)*32,i=n.slice(0,r),a=n.slice(r),s=i.match(/(.{1,8})/g).map(Of);if(s.length<16||s.length>32||s.length%4!==0)throw new Error(Sb);const o=Uint8Array.from(s);if(Uf(o)!==a)throw new Error(Eb);return o}Zt.mnemonicToEntropy=nu;class Zr{constructor(t){if(!Zr.mnemonicMatcher.test(t))throw new Error("Invalid mnemonic format");const n=t.split(" "),r=[12,15,18,21,24];if(r.indexOf(n.length)===-1)throw new Error(`Invalid word count in mnemonic (allowed: ${r} got: ${n.length})`);for(const i of n)if(Zr.wordlist.indexOf(i)===-1)throw new Error("Mnemonic contains invalid word");nu(t),this.data=t}toString(){return this.data}}Zt.EnglishMnemonic=Zr;Zr.wordlist=ru;Zr.mnemonicMatcher=/^[a-z]+( [a-z]+)*$/;class Cb{static encode(t){return new Zr(Df(t))}static decode(t){return nu(t.toString())}static async mnemonicToSeed(t,n){const r=(0,Cc.toUtf8)(oo(t.toString())),i="mnemonic"+(n?oo(n):""),a=(0,Cc.toUtf8)(i);return(0,pb.pbkdf2Sha512)(r,a,2048,64)}}Zt.Bip39=Cb;var Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});Ri.Hmac=void 0;class wb{constructor(t,n){const r=new t().blockSize;this.hash=a=>new t().update(a).digest();let i=n;if(i.length>r&&(i=this.hash(i)),i.length<r){const a=new Uint8Array(r-i.length);i=new Uint8Array([...i,...a])}this.oKeyPad=i.map(a=>a^92),this.iKeyPad=i.map(a=>a^54),this.messageHasher=new t,this.blockSize=r,this.update(this.iKeyPad)}update(t){return this.messageHasher.update(t),this}digest(){const t=this.messageHasher.digest();return this.hash(new Uint8Array([...this.oKeyPad,...t]))}}Ri.Hmac=wb;var _n={};Object.defineProperty(_n,"__esModule",{value:!0});_n.keccak256=_n.Keccak256=void 0;const Tb=fd,xb=Gn;class Kf{constructor(t){this.blockSize=512/8,this.impl=Tb.keccak_256.create(),t&&this.update(t)}update(t){return this.impl.update((0,xb.toRealUint8Array)(t)),this}digest(){return this.impl.digest()}}_n.Keccak256=Kf;function Ab(e){return new Kf(e).digest()}_n.keccak256=Ab;var ht={},Ib=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ht,"__esModule",{value:!0});ht.Xchacha20poly1305Ietf=ht.xchacha20NonceLength=ht.Ed25519=ht.Ed25519Keypair=ht.Argon2id=ht.isArgon2idOptions=void 0;const Bb=ki,bt=Ib(dd);function _b(e){return!(!(0,Bb.isNonNullObject)(e)||typeof e.outputLength!="number"||typeof e.opsLimit!="number"||typeof e.memLimitKib!="number")}ht.isArgon2idOptions=_b;class kb{static async execute(t,n,r){return await bt.default.ready,bt.default.crypto_pwhash(r.outputLength,t,n,r.opsLimit,r.memLimitKib*1024,bt.default.crypto_pwhash_ALG_ARGON2ID13)}}ht.Argon2id=kb;class za{static fromLibsodiumPrivkey(t){if(t.length!==64)throw new Error(`Unexpected key length ${t.length}. Must be 64.`);return new za(t.slice(0,32),t.slice(32,64))}constructor(t,n){this.privkey=t,this.pubkey=n}toLibsodiumPrivkey(){return new Uint8Array([...this.privkey,...this.pubkey])}}ht.Ed25519Keypair=za;class Rb{static async makeKeypair(t){await bt.default.ready;const n=bt.default.crypto_sign_seed_keypair(t);return za.fromLibsodiumPrivkey(n.privateKey)}static async createSignature(t,n){return await bt.default.ready,bt.default.crypto_sign_detached(t,n.toLibsodiumPrivkey())}static async verifySignature(t,n,r){return await bt.default.ready,bt.default.crypto_sign_verify_detached(t,n,r)}}ht.Ed25519=Rb;ht.xchacha20NonceLength=24;class Nb{static async encrypt(t,n,r){await bt.default.ready;const i=null;return bt.default.crypto_aead_xchacha20poly1305_ietf_encrypt(t,i,null,r,n)}static async decrypt(t,n,r){await bt.default.ready;const i=null;return bt.default.crypto_aead_xchacha20poly1305_ietf_decrypt(null,t,i,r,n)}}ht.Xchacha20poly1305Ietf=Nb;var Qa={};Object.defineProperty(Qa,"__esModule",{value:!0});Qa.Random=void 0;class Pb{static getBytes(t){try{const n=typeof window=="object"?window:self,r=typeof n.crypto<"u"?n.crypto:n.msCrypto,i=new Uint8Array(t);return r.getRandomValues(i),i}catch{try{const n=tn();return new Uint8Array([...n.randomBytes(t)])}catch{throw new Error("No secure random number generator found")}}}}Qa.Random=Pb;var kn={};Object.defineProperty(kn,"__esModule",{value:!0});kn.ripemd160=kn.Ripemd160=void 0;const Lb=hd,Ub=Gn;class Ff{constructor(t){this.blockSize=512/8,this.impl=Lb.ripemd160.create(),t&&this.update(t)}update(t){return this.impl.update((0,Ub.toRealUint8Array)(t)),this}digest(){return this.impl.digest()}}kn.Ripemd160=Ff;function Ob(e){return new Ff(e).digest()}kn.ripemd160=Ob;var Ya={},en={};Object.defineProperty(en,"__esModule",{value:!0});en.ExtendedSecp256k1Signature=en.Secp256k1Signature=void 0;function pn(e){let t=0;for(const n of e)if(n===0)t++;else break;return e.slice(t)}const ji=2;class Ei{static fromFixedLength(t){if(t.length!==64)throw new Error(`Got invalid data length: ${t.length}. Expected 2x 32 bytes for the pair (r, s)`);return new Ei(pn(t.slice(0,32)),pn(t.slice(32,64)))}static fromDer(t){let n=0;if(t[n++]!==48)throw new Error("Prefix 0x30 expected");const r=t[n++];if(t.length-n!==r)throw new Error("Data length mismatch detected");if(t[n++]!==ji)throw new Error("INTEGER tag expected");const a=t[n++];if(a>=128)throw new Error("Decoding length values above 127 not supported");const s=t.slice(n,n+a);if(n+=a,t[n++]!==ji)throw new Error("INTEGER tag expected");const u=t[n++];if(u>=128)throw new Error("Decoding length values above 127 not supported");const c=t.slice(n,n+u);return n+=u,new Ei(pn(s),pn(c))}constructor(t,n){if(t.length>32||t.length===0||t[0]===0)throw new Error("Unsigned integer r must be encoded as unpadded big endian.");if(n.length>32||n.length===0||n[0]===0)throw new Error("Unsigned integer s must be encoded as unpadded big endian.");this.data={r:t,s:n}}r(t){if(t===void 0)return this.data.r;{const n=t-this.data.r.length;if(n<0)throw new Error("Length too small to hold parameter r");const r=new Uint8Array(n);return new Uint8Array([...r,...this.data.r])}}s(t){if(t===void 0)return this.data.s;{const n=t-this.data.s.length;if(n<0)throw new Error("Length too small to hold parameter s");const r=new Uint8Array(n);return new Uint8Array([...r,...this.data.s])}}toFixedLength(){return new Uint8Array([...this.r(32),...this.s(32)])}toDer(){const t=this.data.r[0]>=128?new Uint8Array([0,...this.data.r]):this.data.r,n=this.data.s[0]>=128?new Uint8Array([0,...this.data.s]):this.data.s,r=t.length,i=n.length,a=new Uint8Array([ji,r,...t,ji,i,...n]);return new Uint8Array([48,a.length,...a])}}en.Secp256k1Signature=Ei;class iu extends Ei{static fromFixedLength(t){if(t.length!==65)throw new Error(`Got invalid data length ${t.length}. Expected 32 + 32 + 1`);return new iu(pn(t.slice(0,32)),pn(t.slice(32,64)),t[64])}constructor(t,n,r){if(super(t,n),!Number.isInteger(r))throw new Error("The recovery parameter must be an integer.");if(r<0||r>4)throw new Error("The recovery parameter must be one of 0, 1, 2, 3.");this.recovery=r}toFixedLength(){return new Uint8Array([...this.r(32),...this.s(32),this.recovery])}}en.ExtendedSecp256k1Signature=iu;var Mf=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ya,"__esModule",{value:!0});Ya.Secp256k1=void 0;const qi=Lt,Vf=Mf(Ln),Db=Mf(yi()),Kb=en,jr=new Db.default.ec("secp256k1"),Fb=new Vf.default("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","hex");class Mb{static async makeKeypair(t){if(t.length!==32)throw new Error("input data is not a valid secp256k1 private key");const n=jr.keyFromPrivate(t);if(n.validate().result!==!0)throw new Error("input data is not a valid secp256k1 private key");if(new Vf.default(t).gte(Fb))throw new Error("input data is not a valid secp256k1 private key");return{privkey:(0,qi.fromHex)(n.getPrivate("hex")),pubkey:Uint8Array.from(n.getPublic("array"))}}static async createSignature(t,n){if(t.length===0)throw new Error("Message hash must not be empty");if(t.length>32)throw new Error("Message hash length must not exceed 32 bytes");const r=jr.keyFromPrivate(n),{r:i,s:a,recoveryParam:s}=r.sign(t,{canonical:!0});if(typeof s!="number")throw new Error("Recovery param missing");return new Kb.ExtendedSecp256k1Signature(Uint8Array.from(i.toArray()),Uint8Array.from(a.toArray()),s)}static async verifySignature(t,n,r){if(n.length===0)throw new Error("Message hash must not be empty");if(n.length>32)throw new Error("Message hash length must not exceed 32 bytes");const i=jr.keyFromPublic(r);try{return i.verify(n,t.toDer())}catch{return!1}}static recoverPubkey(t,n){const r={r:(0,qi.toHex)(t.r()),s:(0,qi.toHex)(t.s())},i=jr.recoverPubKey(n,r,t.recovery),a=jr.keyFromPublic(i);return(0,qi.fromHex)(a.getPublic(!1,"hex"))}static compressPubkey(t){switch(t.length){case 33:return t;case 65:return Uint8Array.from(jr.keyFromPublic(t).getPublic(!0,"array"));default:throw new Error("Invalid pubkey length")}}static uncompressPubkey(t){switch(t.length){case 33:return Uint8Array.from(jr.keyFromPublic(t).getPublic(!1,"array"));case 65:return t;default:throw new Error("Invalid pubkey length")}}static trimRecoveryByte(t){switch(t.length){case 64:return t;case 65:return t.slice(0,64);default:throw new Error("Invalid signature length")}}}Ya.Secp256k1=Mb;var $f={},Wn={},Xa={},Vb=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xa,"__esModule",{value:!0});Xa.Decimal=void 0;const Dt=Vb(Ln),wc=100;class _e{static fromUserInput(t,n){_e.verifyFractionalDigits(n);const r=t.match(/[^0-9.]/);if(r)throw new Error(`Invalid character at position ${r.index+1}`);let i,a;if(t==="")i="0",a="";else if(t.search(/\./)===-1)i=t,a="";else{const o=t.split(".");switch(o.length){case 0:case 1:throw new Error("Fewer than two elements in split result. This must not happen here.");case 2:if(!o[1])throw new Error("Fractional part missing");i=o[0],a=o[1].replace(/0+$/,"");break;default:throw new Error("More than one separator found")}}if(a.length>n)throw new Error("Got more fractional digits than supported");const s=`${i}${a.padEnd(n,"0")}`;return new _e(s,n)}static fromAtomics(t,n){return _e.verifyFractionalDigits(n),new _e(t,n)}static zero(t){return _e.verifyFractionalDigits(t),new _e("0",t)}static one(t){return _e.verifyFractionalDigits(t),new _e("1"+"0".repeat(t),t)}static verifyFractionalDigits(t){if(!Number.isInteger(t))throw new Error("Fractional digits is not an integer");if(t<0)throw new Error("Fractional digits must not be negative");if(t>wc)throw new Error(`Fractional digits must not exceed ${wc}`)}static compare(t,n){if(t.fractionalDigits!==n.fractionalDigits)throw new Error("Fractional digits do not match");return t.data.atomics.cmp(new Dt.default(n.atomics))}get atomics(){return this.data.atomics.toString()}get fractionalDigits(){return this.data.fractionalDigits}constructor(t,n){if(!t.match(/^[0-9]+$/))throw new Error("Invalid string format. Only non-negative integers in decimal representation supported.");this.data={atomics:new Dt.default(t),fractionalDigits:n}}clone(){return new _e(this.atomics,this.fractionalDigits)}floor(){const t=new Dt.default(10).pow(new Dt.default(this.data.fractionalDigits)),n=this.data.atomics.div(t);return this.data.atomics.mod(t).isZero()?this.clone():_e.fromAtomics(n.mul(t).toString(),this.fractionalDigits)}ceil(){const t=new Dt.default(10).pow(new Dt.default(this.data.fractionalDigits)),n=this.data.atomics.div(t);return this.data.atomics.mod(t).isZero()?this.clone():_e.fromAtomics(n.addn(1).mul(t).toString(),this.fractionalDigits)}toString(){const t=new Dt.default(10).pow(new Dt.default(this.data.fractionalDigits)),n=this.data.atomics.div(t),r=this.data.atomics.mod(t);if(r.isZero())return n.toString();{const a=r.toString().padStart(this.data.fractionalDigits,"0").replace(/0+$/,"");return`${n.toString()}.${a}`}}toFloatApproximation(){const t=Number(this.toString());if(Number.isNaN(t))throw new Error("Conversion to number failed");return t}plus(t){if(this.fractionalDigits!==t.fractionalDigits)throw new Error("Fractional digits do not match");const n=this.data.atomics.add(new Dt.default(t.atomics));return new _e(n.toString(),this.fractionalDigits)}minus(t){if(this.fractionalDigits!==t.fractionalDigits)throw new Error("Fractional digits do not match");const n=this.data.atomics.sub(new Dt.default(t.atomics));if(n.ltn(0))throw new Error("Difference must not be negative");return new _e(n.toString(),this.fractionalDigits)}multiply(t){const n=this.data.atomics.mul(new Dt.default(t.toString()));return new _e(n.toString(),this.fractionalDigits)}equals(t){return _e.compare(this,t)===0}isLessThan(t){return _e.compare(this,t)<0}isLessThanOrEqual(t){return _e.compare(this,t)<=0}isGreaterThan(t){return _e.compare(this,t)>0}isGreaterThanOrEqual(t){return _e.compare(this,t)>=0}}Xa.Decimal=_e;var er={},$b=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(er,"__esModule",{value:!0});er.Uint64=er.Uint53=er.Int53=er.Uint32=void 0;const ta=$b(Ln),Hb=new ta.default("18446744073709551615",10,"be");class pi{static fromBigEndianBytes(t){return pi.fromBytes(t)}static fromBytes(t,n="be"){if(t.length!==4)throw new Error("Invalid input length. Expected 4 bytes.");for(let i=0;i<t.length;++i)if(!Number.isInteger(t[i])||t[i]>255||t[i]<0)throw new Error("Invalid value in byte. Found: "+t[i]);const r=n==="be"?t:Array.from(t).reverse();return new pi(r[0]*2**24+r[1]*2**16+r[2]*2**8+r[3])}static fromString(t){if(!t.match(/^[0-9]+$/))throw new Error("Invalid string format");return new pi(Number.parseInt(t,10))}constructor(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");if(t<0||t>4294967295)throw new Error("Input not in uint32 range: "+t.toString());this.data=t}toBytesBigEndian(){return new Uint8Array([Math.floor(this.data/2**24)&255,Math.floor(this.data/2**16)&255,Math.floor(this.data/2**8)&255,Math.floor(this.data/2**0)&255])}toBytesLittleEndian(){return new Uint8Array([Math.floor(this.data/2**0)&255,Math.floor(this.data/2**8)&255,Math.floor(this.data/2**16)&255,Math.floor(this.data/2**24)&255])}toNumber(){return this.data}toBigInt(){return BigInt(this.toNumber())}toString(){return this.data.toString()}}er.Uint32=pi;class Ci{static fromString(t){if(!t.match(/^-?[0-9]+$/))throw new Error("Invalid string format");return new Ci(Number.parseInt(t,10))}constructor(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");if(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER)throw new Error("Input not in int53 range: "+t.toString());this.data=t}toNumber(){return this.data}toBigInt(){return BigInt(this.toNumber())}toString(){return this.data.toString()}}er.Int53=Ci;class au{static fromString(t){const n=Ci.fromString(t);return new au(n.toNumber())}constructor(t){const n=new Ci(t);if(n.toNumber()<0)throw new Error("Input is negative");this.data=n}toNumber(){return this.data.toNumber()}toBigInt(){return BigInt(this.toNumber())}toString(){return this.data.toString()}}er.Uint53=au;class yn{static fromBytesBigEndian(t){return yn.fromBytes(t)}static fromBytes(t,n="be"){if(t.length!==8)throw new Error("Invalid input length. Expected 8 bytes.");for(let i=0;i<t.length;++i)if(!Number.isInteger(t[i])||t[i]>255||t[i]<0)throw new Error("Invalid value in byte. Found: "+t[i]);const r=n==="be"?Array.from(t):Array.from(t).reverse();return new yn(new ta.default(r))}static fromString(t){if(!t.match(/^[0-9]+$/))throw new Error("Invalid string format");return new yn(new ta.default(t,10,"be"))}static fromNumber(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");let n;try{n=new ta.default(t)}catch{throw new Error("Input is not a safe integer")}return new yn(n)}constructor(t){if(t.isNeg())throw new Error("Input is negative");if(t.gt(Hb))throw new Error("Input exceeds uint64 range");this.data=t}toBytesBigEndian(){return Uint8Array.from(this.data.toArray("be",8))}toBytesLittleEndian(){return Uint8Array.from(this.data.toArray("le",8))}toString(){return this.data.toString(10)}toBigInt(){return BigInt(this.toString())}toNumber(){return this.data.toNumber()}}er.Uint64=yn;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Uint64=e.Uint53=e.Uint32=e.Int53=e.Decimal=void 0;var t=Xa;Object.defineProperty(e,"Decimal",{enumerable:!0,get:function(){return t.Decimal}});var n=er;Object.defineProperty(e,"Int53",{enumerable:!0,get:function(){return n.Int53}}),Object.defineProperty(e,"Uint32",{enumerable:!0,get:function(){return n.Uint32}}),Object.defineProperty(e,"Uint53",{enumerable:!0,get:function(){return n.Uint53}}),Object.defineProperty(e,"Uint64",{enumerable:!0,get:function(){return n.Uint64}})})(Wn);(function(e){var t=G&&G.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(e,"__esModule",{value:!0}),e.stringToPath=e.pathToString=e.Slip10=e.Slip10RawIndex=e.slip10CurveFromString=e.Slip10Curve=void 0;const n=Lt,r=Wn,i=t(Ln),a=t(yi()),s=Ri,o=Rt;var u;(function(m){m.Secp256k1="Bitcoin seed",m.Ed25519="ed25519 seed"})(u=e.Slip10Curve||(e.Slip10Curve={}));function c(m){switch(m){case u.Ed25519:return u.Ed25519;case u.Secp256k1:return u.Secp256k1;default:throw new Error(`Unknown curve string: '${m}'`)}}e.slip10CurveFromString=c;class l extends r.Uint32{static hardened(b){return new l(b+2**31)}static normal(b){return new l(b)}isHardened(){return this.data>=2**31}}e.Slip10RawIndex=l;const f=new a.default.ec("secp256k1");class d{static derivePath(b,E,x){let A=this.master(b,E);for(const B of x)A=this.child(b,A.privkey,A.chainCode,B);return A}static master(b,E){const x=new s.Hmac(o.Sha512,(0,n.toAscii)(b)).update(E).digest(),A=x.slice(0,32),B=x.slice(32,64);return b!==u.Ed25519&&(this.isZero(A)||this.isGteN(b,A))?this.master(b,x):{chainCode:B,privkey:A}}static child(b,E,x,A){let B;if(A.isHardened()){const _=new Uint8Array([0,...E,...A.toBytesBigEndian()]);B=new s.Hmac(o.Sha512,x).update(_).digest()}else{if(b===u.Ed25519)throw new Error("Normal keys are not allowed with ed25519");{const _=new Uint8Array([...d.serializedPoint(b,new i.default(E)),...A.toBytesBigEndian()]);B=new s.Hmac(o.Sha512,x).update(_).digest()}}return this.childImpl(b,E,x,A,B)}static serializedPoint(b,E){switch(b){case u.Secp256k1:return(0,n.fromHex)(f.g.mul(E).encodeCompressed("hex"));default:throw new Error("curve not supported")}}static childImpl(b,E,x,A,B){const _=B.slice(0,32),L=B.slice(32,64),W=L;if(b===u.Ed25519)return{chainCode:W,privkey:_};const te=this.n(b),re=new i.default(_).add(new i.default(E)).mod(te),P=Uint8Array.from(re.toArray("be",32));if(this.isGteN(b,_)||this.isZero(P)){const T=new s.Hmac(o.Sha512,x).update(new Uint8Array([1,...L,...A.toBytesBigEndian()])).digest();return this.childImpl(b,E,x,A,T)}return{chainCode:W,privkey:P}}static isZero(b){return b.every(E=>E===0)}static isGteN(b,E){return new i.default(E).gte(this.n(b))}static n(b){switch(b){case u.Secp256k1:return new i.default("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141",16);default:throw new Error("curve not supported")}}}e.Slip10=d;function v(m){return m.reduce((b,E)=>{const x=E.isHardened()?`${E.toNumber()-2147483648}'`:E.toString();return b+"/"+x},"m")}e.pathToString=v;function h(m){if(!m.startsWith("m"))throw new Error("Path string must start with 'm'");let b=m.slice(1);const E=new Array;for(;b;){const x=b.match(/^\/([0-9]+)('?)/);if(!x)throw new Error("Syntax error while reading path component");const[A,B,_]=x,L=r.Uint53.fromString(B).toNumber();if(L>=2**31)throw new Error("Component value too high. Must not exceed 2**31-1.");_?E.push(l.hardened(L)):E.push(l.normal(L)),b=b.slice(A.length)}return E}e.stringToPath=h})($f);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.stringToPath=e.Slip10RawIndex=e.slip10CurveFromString=e.Slip10Curve=e.Slip10=e.pathToString=e.sha512=e.Sha512=e.sha256=e.Sha256=e.Secp256k1Signature=e.ExtendedSecp256k1Signature=e.Secp256k1=e.ripemd160=e.Ripemd160=e.Random=e.Xchacha20poly1305Ietf=e.xchacha20NonceLength=e.isArgon2idOptions=e.Ed25519Keypair=e.Ed25519=e.Argon2id=e.keccak256=e.Keccak256=e.Hmac=e.EnglishMnemonic=e.Bip39=void 0;var t=Zt;Object.defineProperty(e,"Bip39",{enumerable:!0,get:function(){return t.Bip39}}),Object.defineProperty(e,"EnglishMnemonic",{enumerable:!0,get:function(){return t.EnglishMnemonic}});var n=Ri;Object.defineProperty(e,"Hmac",{enumerable:!0,get:function(){return n.Hmac}});var r=_n;Object.defineProperty(e,"Keccak256",{enumerable:!0,get:function(){return r.Keccak256}}),Object.defineProperty(e,"keccak256",{enumerable:!0,get:function(){return r.keccak256}});var i=ht;Object.defineProperty(e,"Argon2id",{enumerable:!0,get:function(){return i.Argon2id}}),Object.defineProperty(e,"Ed25519",{enumerable:!0,get:function(){return i.Ed25519}}),Object.defineProperty(e,"Ed25519Keypair",{enumerable:!0,get:function(){return i.Ed25519Keypair}}),Object.defineProperty(e,"isArgon2idOptions",{enumerable:!0,get:function(){return i.isArgon2idOptions}}),Object.defineProperty(e,"xchacha20NonceLength",{enumerable:!0,get:function(){return i.xchacha20NonceLength}}),Object.defineProperty(e,"Xchacha20poly1305Ietf",{enumerable:!0,get:function(){return i.Xchacha20poly1305Ietf}});var a=Qa;Object.defineProperty(e,"Random",{enumerable:!0,get:function(){return a.Random}});var s=kn;Object.defineProperty(e,"Ripemd160",{enumerable:!0,get:function(){return s.Ripemd160}}),Object.defineProperty(e,"ripemd160",{enumerable:!0,get:function(){return s.ripemd160}});var o=Ya;Object.defineProperty(e,"Secp256k1",{enumerable:!0,get:function(){return o.Secp256k1}});var u=en;Object.defineProperty(e,"ExtendedSecp256k1Signature",{enumerable:!0,get:function(){return u.ExtendedSecp256k1Signature}}),Object.defineProperty(e,"Secp256k1Signature",{enumerable:!0,get:function(){return u.Secp256k1Signature}});var c=Rt;Object.defineProperty(e,"Sha256",{enumerable:!0,get:function(){return c.Sha256}}),Object.defineProperty(e,"sha256",{enumerable:!0,get:function(){return c.sha256}}),Object.defineProperty(e,"Sha512",{enumerable:!0,get:function(){return c.Sha512}}),Object.defineProperty(e,"sha512",{enumerable:!0,get:function(){return c.sha512}});var l=$f;Object.defineProperty(e,"pathToString",{enumerable:!0,get:function(){return l.pathToString}}),Object.defineProperty(e,"Slip10",{enumerable:!0,get:function(){return l.Slip10}}),Object.defineProperty(e,"Slip10Curve",{enumerable:!0,get:function(){return l.Slip10Curve}}),Object.defineProperty(e,"slip10CurveFromString",{enumerable:!0,get:function(){return l.slip10CurveFromString}}),Object.defineProperty(e,"Slip10RawIndex",{enumerable:!0,get:function(){return l.Slip10RawIndex}}),Object.defineProperty(e,"stringToPath",{enumerable:!0,get:function(){return l.stringToPath}})})(qn);var at={},Ni={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isMultisigThresholdPubkey=e.isSinglePubkey=e.pubkeyType=e.isSecp256k1Pubkey=e.isEd25519Pubkey=void 0;function t(a){return a.type==="tendermint/PubKeyEd25519"}e.isEd25519Pubkey=t;function n(a){return a.type==="tendermint/PubKeySecp256k1"}e.isSecp256k1Pubkey=n,e.pubkeyType={secp256k1:"tendermint/PubKeySecp256k1",ed25519:"tendermint/PubKeyEd25519",sr25519:"tendermint/PubKeySr25519",multisigThreshold:"tendermint/PubKeyMultisigThreshold"};function r(a){return[e.pubkeyType.ed25519,e.pubkeyType.secp256k1,e.pubkeyType.sr25519].includes(a.type)}e.isSinglePubkey=r;function i(a){return a.type==="tendermint/PubKeyMultisigThreshold"}e.isMultisigThresholdPubkey=i})(Ni);Object.defineProperty(at,"__esModule",{value:!0});at.encodeBech32Pubkey=at.encodeAminoPubkey=at.decodeBech32Pubkey=at.decodeAminoPubkey=at.encodeEd25519Pubkey=at.encodeSecp256k1Pubkey=void 0;const yt=Lt,jb=Wn,si=ki,pr=Ni;function qb(e){if(e.length!==33||e[0]!==2&&e[0]!==3)throw new Error("Public key must be compressed secp256k1, i.e. 33 bytes starting with 0x02 or 0x03");return{type:pr.pubkeyType.secp256k1,value:(0,yt.toBase64)(e)}}at.encodeSecp256k1Pubkey=qb;function Gb(e){if(e.length!==32)throw new Error("Ed25519 public key must be 32 bytes long");return{type:pr.pubkeyType.ed25519,value:(0,yt.toBase64)(e)}}at.encodeEd25519Pubkey=Gb;const uo=(0,yt.fromHex)("eb5ae98721"),co=(0,yt.fromHex)("1624de6420"),Tc=(0,yt.fromHex)("0dfb100520"),Ea=(0,yt.fromHex)("22c1f7e2");function su(e){if((0,si.arrayContentStartsWith)(e,uo)){const t=e.slice(uo.length);if(t.length!==33)throw new Error("Invalid rest data length. Expected 33 bytes (compressed secp256k1 pubkey).");return{type:pr.pubkeyType.secp256k1,value:(0,yt.toBase64)(t)}}else if((0,si.arrayContentStartsWith)(e,co)){const t=e.slice(co.length);if(t.length!==32)throw new Error("Invalid rest data length. Expected 32 bytes (Ed25519 pubkey).");return{type:pr.pubkeyType.ed25519,value:(0,yt.toBase64)(t)}}else if((0,si.arrayContentStartsWith)(e,Tc)){const t=e.slice(Tc.length);if(t.length!==32)throw new Error("Invalid rest data length. Expected 32 bytes (Sr25519 pubkey).");return{type:pr.pubkeyType.sr25519,value:(0,yt.toBase64)(t)}}else{if((0,si.arrayContentStartsWith)(e,Ea))return zb(e);throw new Error("Unsupported public key type. Amino data starts with: "+(0,yt.toHex)(e.slice(0,5)))}}at.decodeAminoPubkey=su;function Wb(e){const{data:t}=(0,yt.fromBech32)(e);return su(t)}at.decodeBech32Pubkey=Wb;function xc(e){if(e.length<1)throw new Error("Can't decode varint. EOF");if(e[0]>127)throw new Error("Decoding numbers > 127 is not supported here. Please tell those lazy CosmJS maintainers to port the binary.Varint implementation from the Go standard library and write some tests.");return[e[0],1]}function zb(e){const t=Array.from(e),n=t.splice(0,Ea.length);if(!(0,si.arrayContentStartsWith)(n,Ea))throw new Error("Invalid multisig prefix.");if(t.shift()!=8)throw new Error("Invalid multisig data. Expecting 0x08 prefix before threshold.");const[r,i]=xc(t);t.splice(0,i);const a=[];for(;t.length>0;){if(t.shift()!=18)throw new Error("Invalid multisig data. Expecting 0x12 prefix before participant pubkey length.");const[s,o]=xc(t);if(t.splice(0,o),t.length<s)throw new Error("Invalid multisig data length.");const u=t.splice(0,s),c=su(Uint8Array.from(u));a.push(c)}return{type:pr.pubkeyType.multisigThreshold,value:{threshold:r.toString(),pubkeys:a}}}function Ac(e){const t=jb.Uint53.fromString(e.toString()).toNumber();if(t>127)throw new Error("Encoding numbers > 127 is not supported here. Please tell those lazy CosmJS maintainers to port the binary.PutUvarint implementation from the Go standard library and write some tests.");return[t]}function ou(e){if((0,pr.isMultisigThresholdPubkey)(e)){const t=Array.from(Ea);t.push(8),t.push(...Ac(e.value.threshold));for(const n of e.value.pubkeys.map(r=>ou(r)))t.push(18),t.push(...Ac(n.length)),t.push(...n);return new Uint8Array(t)}else{if((0,pr.isEd25519Pubkey)(e))return new Uint8Array([...co,...(0,yt.fromBase64)(e.value)]);if((0,pr.isSecp256k1Pubkey)(e))return new Uint8Array([...uo,...(0,yt.fromBase64)(e.value)]);throw new Error("Unsupported pubkey type")}}at.encodeAminoPubkey=ou;function Qb(e,t){return(0,yt.toBech32)(t,ou(e))}at.encodeBech32Pubkey=Qb;Object.defineProperty(Ct,"__esModule",{value:!0});Ct.pubkeyToAddress=Ct.pubkeyToRawAddress=Ct.rawSecp256k1PubkeyToRawAddress=Ct.rawEd25519PubkeyToRawAddress=void 0;const Ca=qn,lo=Lt,Yb=at,Ts=Ni;function Hf(e){if(e.length!==32)throw new Error(`Invalid Ed25519 pubkey length: ${e.length}`);return(0,Ca.sha256)(e).slice(0,20)}Ct.rawEd25519PubkeyToRawAddress=Hf;function jf(e){if(e.length!==33)throw new Error(`Invalid Secp256k1 pubkey length (compressed): ${e.length}`);return(0,Ca.ripemd160)((0,Ca.sha256)(e))}Ct.rawSecp256k1PubkeyToRawAddress=jf;function qf(e){if((0,Ts.isSecp256k1Pubkey)(e)){const t=(0,lo.fromBase64)(e.value);return jf(t)}else if((0,Ts.isEd25519Pubkey)(e)){const t=(0,lo.fromBase64)(e.value);return Hf(t)}else if((0,Ts.isMultisigThresholdPubkey)(e)){const t=(0,Yb.encodeAminoPubkey)(e);return(0,Ca.sha256)(t).slice(0,20)}else throw new Error("Unsupported public key type")}Ct.pubkeyToRawAddress=qf;function Xb(e,t){return(0,lo.toBech32)(t,qf(e))}Ct.pubkeyToAddress=Xb;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.addCoins=tr.parseCoins=tr.coins=tr.coin=void 0;const fo=Wn;function Gf(e,t){let n;if(typeof e=="number")try{n=new fo.Uint53(e).toString()}catch{throw new Error("Given amount is not a safe integer. Consider using a string instead to overcome the limitations of JS numbers.")}else{if(!e.match(/^[0-9]+$/))throw new Error("Invalid unsigned integer string format");n=e.replace(/^0*/,"")||"0"}return{amount:n,denom:t}}tr.coin=Gf;function Jb(e,t){return[Gf(e,t)]}tr.coins=Jb;function Zb(e){return e.replace(/\s/g,"").split(",").filter(Boolean).map(t=>{const n=t.match(/^([0-9]+)([a-zA-Z]+)/);if(!n)throw new Error("Got an invalid coin string");return{amount:n[1].replace(/^0+/,"")||"0",denom:n[2]}})}tr.parseCoins=Zb;function eS(e,t){if(e.denom!==t.denom)throw new Error("Trying to add two coins with different denoms");return{amount:fo.Decimal.fromAtomics(e.amount,0).plus(fo.Decimal.fromAtomics(t.amount,0)).atomics,denom:e.denom}}tr.addCoins=eS;var Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.createMultisigThresholdPubkey=Rn.compareArrays=void 0;const Ic=Lt,tS=Wn,Bc=Ct;function Wf(e,t){const n=(0,Ic.toHex)(e),r=(0,Ic.toHex)(t);return n===r?0:n<r?-1:1}Rn.compareArrays=Wf;function rS(e,t,n=!1){const r=new tS.Uint53(t);if(r.toNumber()>e.length)throw new Error(`Threshold k = ${r.toNumber()} exceeds number of keys n = ${e.length}`);const i=n?e:Array.from(e).sort((a,s)=>{const o=(0,Bc.pubkeyToRawAddress)(a),u=(0,Bc.pubkeyToRawAddress)(s);return Wf(o,u)});return{type:"tendermint/PubKeyMultisigThreshold",value:{threshold:r.toString(),pubkeys:i}}}Rn.createMultisigThresholdPubkey=rS;var Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});Pi.makeCosmoshubPath=void 0;const ei=qn;function nS(e){return[ei.Slip10RawIndex.hardened(44),ei.Slip10RawIndex.hardened(118),ei.Slip10RawIndex.hardened(0),ei.Slip10RawIndex.normal(0),ei.Slip10RawIndex.normal(e)]}Pi.makeCosmoshubPath=nS;var Nn={},Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.decodeSignature=Dr.encodeSecp256k1Signature=void 0;const ho=Lt,iS=at,aS=Ni;function sS(e,t){if(t.length!==64)throw new Error("Signature must be 64 bytes long. Cosmos SDK uses a 2x32 byte fixed length encoding for the secp256k1 signature integers r and s.");return{pub_key:(0,iS.encodeSecp256k1Pubkey)(e),signature:(0,ho.toBase64)(t)}}Dr.encodeSecp256k1Signature=sS;function oS(e){switch(e.pub_key.type){case aS.pubkeyType.secp256k1:return{pubkey:(0,ho.fromBase64)(e.pub_key.value),signature:(0,ho.fromBase64)(e.signature)};default:throw new Error("Unsupported pubkey type")}}Dr.decodeSignature=oS;var Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.serializeSignDoc=Nt.escapeCharacters=Nt.makeSignDoc=Nt.sortedJsonStringify=void 0;const uS=Lt,_c=Wn;function po(e){if(typeof e!="object"||e===null)return e;if(Array.isArray(e))return e.map(po);const t=Object.keys(e).sort(),n={};return t.forEach(r=>{n[r]=po(e[r])}),n}function zf(e){return JSON.stringify(po(e))}Nt.sortedJsonStringify=zf;function cS(e,t,n,r,i,a){return{chain_id:n,account_number:_c.Uint53.fromString(i.toString()).toString(),sequence:_c.Uint53.fromString(a.toString()).toString(),fee:t,msgs:e,memo:r||""}}Nt.makeSignDoc=cS;function Qf(e){const t=/&/g,n=/</g,r=/>/g;return e.replace(t,"\\u0026").replace(n,"\\u003c").replace(r,"\\u003e")}Nt.escapeCharacters=Qf;function lS(e){const t=Qf(zf(e));return(0,uS.toUtf8)(t)}Nt.serializeSignDoc=lS;var uu={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.decrypt=e.encrypt=e.supportedAlgorithms=e.executeKdf=e.cosmjsSalt=void 0;const t=qn,n=Lt;e.cosmjsSalt=(0,n.toAscii)("The CosmJS salt.");async function r(s,o){switch(o.algorithm){case"argon2id":{const u=o.params;if(!(0,t.isArgon2idOptions)(u))throw new Error("Invalid format of argon2id params");return t.Argon2id.execute(s,e.cosmjsSalt,u)}default:throw new Error("Unsupported KDF algorithm")}}e.executeKdf=r,e.supportedAlgorithms={xchacha20poly1305Ietf:"xchacha20poly1305-ietf"};async function i(s,o,u){switch(u.algorithm){case e.supportedAlgorithms.xchacha20poly1305Ietf:{const c=t.Random.getBytes(t.xchacha20NonceLength);return new Uint8Array([...c,...await t.Xchacha20poly1305Ietf.encrypt(s,o,c)])}default:throw new Error(`Unsupported encryption algorithm: '${u.algorithm}'`)}}e.encrypt=i;async function a(s,o,u){switch(u.algorithm){case e.supportedAlgorithms.xchacha20poly1305Ietf:{const c=s.slice(0,t.xchacha20NonceLength);return t.Xchacha20poly1305Ietf.decrypt(s.slice(t.xchacha20NonceLength),o,c)}default:throw new Error(`Unsupported encryption algorithm: '${u.algorithm}'`)}}e.decrypt=a})(uu);Object.defineProperty(Nn,"__esModule",{value:!0});Nn.Secp256k1HdWallet=Nn.extractKdfConfiguration=void 0;const wt=qn,ti=Lt,gn=ki,fS=Ct,dS=Pi,hS=Dr,pS=Nt,ri=uu,ra="secp256k1wallet-v1",yS={algorithm:"argon2id",params:{outputLength:32,opsLimit:24,memLimitKib:12*1024}};function gS(e){return!(!(0,gn.isNonNullObject)(e)||typeof e.hdPath!="string"||typeof e.prefix!="string")}function vS(e){return e.kdf}function mS(e){const t=JSON.parse(e);if(!(0,gn.isNonNullObject)(t))throw new Error("Root document is not an object.");switch(t.type){case ra:return vS(t);default:throw new Error("Unsupported serialization type")}}Nn.extractKdfConfiguration=mS;const kc={bip39Password:"",hdPaths:[(0,dS.makeCosmoshubPath)(0)],prefix:"cosmos"};class Qr{static async fromMnemonic(t,n={}){const r=new wt.EnglishMnemonic(t),i=await wt.Bip39.mnemonicToSeed(r,n.bip39Password);return new Qr(r,{...n,seed:i})}static async generate(t=12,n={}){const r=4*Math.floor(11*t/33),i=wt.Random.getBytes(r),a=wt.Bip39.encode(i);return Qr.fromMnemonic(a.toString(),n)}static async deserialize(t,n){const r=JSON.parse(t);if(!(0,gn.isNonNullObject)(r))throw new Error("Root document is not an object.");switch(r.type){case ra:return Qr.deserializeTypeV1(t,n);default:throw new Error("Unsupported serialization type")}}static async deserializeWithEncryptionKey(t,n){const r=JSON.parse(t);if(!(0,gn.isNonNullObject)(r))throw new Error("Root document is not an object.");const i=r;switch(i.type){case ra:{const a=await(0,ri.decrypt)((0,ti.fromBase64)(i.data),n,i.encryption),s=JSON.parse((0,ti.fromUtf8)(a)),{mnemonic:o,accounts:u}=s;if((0,gn.assert)(typeof o=="string"),!Array.isArray(u))throw new Error("Property 'accounts' is not an array");if(!u.every(f=>gS(f)))throw new Error("Account is not in the correct format.");const c=u[0].prefix;if(!u.every(({prefix:f})=>f===c))throw new Error("Accounts do not all have the same prefix");const l=u.map(({hdPath:f})=>(0,wt.stringToPath)(f));return Qr.fromMnemonic(o,{hdPaths:l,prefix:c})}default:throw new Error("Unsupported serialization type")}}static async deserializeTypeV1(t,n){const r=JSON.parse(t);if(!(0,gn.isNonNullObject)(r))throw new Error("Root document is not an object.");const i=await(0,ri.executeKdf)(n,r.kdf);return Qr.deserializeWithEncryptionKey(t,i)}constructor(t,n){const r=n.hdPaths??kc.hdPaths,i=n.prefix??kc.prefix;this.secret=t,this.seed=n.seed,this.accounts=r.map(a=>({hdPath:a,prefix:i}))}get mnemonic(){return this.secret.toString()}async getAccounts(){return(await this.getAccountsWithPrivkeys()).map(({algo:n,pubkey:r,address:i})=>({algo:n,pubkey:r,address:i}))}async signAmino(t,n){const i=(await this.getAccountsWithPrivkeys()).find(({address:l})=>l===t);if(i===void 0)throw new Error(`Address ${t} not found in wallet`);const{privkey:a,pubkey:s}=i,o=(0,wt.sha256)((0,pS.serializeSignDoc)(n)),u=await wt.Secp256k1.createSignature(o,a),c=new Uint8Array([...u.r(32),...u.s(32)]);return{signed:n,signature:(0,hS.encodeSecp256k1Signature)(s,c)}}async serialize(t){const n=yS,r=await(0,ri.executeKdf)(t,n);return this.serializeWithEncryptionKey(r,n)}async serializeWithEncryptionKey(t,n){const r={mnemonic:this.mnemonic,accounts:this.accounts.map(({hdPath:u,prefix:c})=>({hdPath:(0,wt.pathToString)(u),prefix:c}))},i=(0,ti.toUtf8)(JSON.stringify(r)),a={algorithm:ri.supportedAlgorithms.xchacha20poly1305Ietf},s=await(0,ri.encrypt)(i,t,a),o={type:ra,kdf:n,encryption:a,data:(0,ti.toBase64)(s)};return JSON.stringify(o)}async getKeyPair(t){const{privkey:n}=wt.Slip10.derivePath(wt.Slip10Curve.Secp256k1,this.seed,t),{pubkey:r}=await wt.Secp256k1.makeKeypair(n);return{privkey:n,pubkey:wt.Secp256k1.compressPubkey(r)}}async getAccountsWithPrivkeys(){return Promise.all(this.accounts.map(async({hdPath:t,prefix:n})=>{const{privkey:r,pubkey:i}=await this.getKeyPair(t),a=(0,ti.toBech32)(n,(0,fS.rawSecp256k1PubkeyToRawAddress)(i));return{algo:"secp256k1",privkey:r,pubkey:i,address:a}}))}}Nn.Secp256k1HdWallet=Qr;var Ja={};Object.defineProperty(Ja,"__esModule",{value:!0});Ja.Secp256k1Wallet=void 0;const Gi=qn,bS=Lt,SS=Ct,ES=Dr,CS=Nt;class cu{static async fromKey(t,n="cosmos"){const r=(await Gi.Secp256k1.makeKeypair(t)).pubkey;return new cu(t,Gi.Secp256k1.compressPubkey(r),n)}constructor(t,n,r){this.privkey=t,this.pubkey=n,this.prefix=r}get address(){return(0,bS.toBech32)(this.prefix,(0,SS.rawSecp256k1PubkeyToRawAddress)(this.pubkey))}async getAccounts(){return[{algo:"secp256k1",address:this.address,pubkey:this.pubkey}]}async signAmino(t,n){if(t!==this.address)throw new Error(`Address ${t} not found in wallet`);const r=new Gi.Sha256((0,CS.serializeSignDoc)(n)).digest(),i=await Gi.Secp256k1.createSignature(r,this.privkey),a=new Uint8Array([...i.r(32),...i.s(32)]);return{signed:n,signature:(0,ES.encodeSecp256k1Signature)(this.pubkey,a)}}}Ja.Secp256k1Wallet=cu;var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0});Pn.makeStdTx=Pn.isStdTx=void 0;function wS(e){const{memo:t,msg:n,fee:r,signatures:i}=e;return typeof t=="string"&&Array.isArray(n)&&typeof r=="object"&&Array.isArray(i)}Pn.isStdTx=wS;function TS(e,t){return{msg:e.msgs,fee:e.fee,memo:e.memo,signatures:Array.isArray(t)?t:[t]}}Pn.makeStdTx=TS;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.executeKdf=e.makeStdTx=e.isStdTx=e.serializeSignDoc=e.makeSignDoc=e.encodeSecp256k1Signature=e.decodeSignature=e.Secp256k1Wallet=e.Secp256k1HdWallet=e.extractKdfConfiguration=e.pubkeyType=e.isSinglePubkey=e.isSecp256k1Pubkey=e.isMultisigThresholdPubkey=e.isEd25519Pubkey=e.makeCosmoshubPath=e.createMultisigThresholdPubkey=e.encodeSecp256k1Pubkey=e.encodeEd25519Pubkey=e.encodeBech32Pubkey=e.encodeAminoPubkey=e.decodeBech32Pubkey=e.decodeAminoPubkey=e.parseCoins=e.coins=e.coin=e.addCoins=e.rawSecp256k1PubkeyToRawAddress=e.rawEd25519PubkeyToRawAddress=e.pubkeyToRawAddress=e.pubkeyToAddress=void 0;var t=Ct;Object.defineProperty(e,"pubkeyToAddress",{enumerable:!0,get:function(){return t.pubkeyToAddress}}),Object.defineProperty(e,"pubkeyToRawAddress",{enumerable:!0,get:function(){return t.pubkeyToRawAddress}}),Object.defineProperty(e,"rawEd25519PubkeyToRawAddress",{enumerable:!0,get:function(){return t.rawEd25519PubkeyToRawAddress}}),Object.defineProperty(e,"rawSecp256k1PubkeyToRawAddress",{enumerable:!0,get:function(){return t.rawSecp256k1PubkeyToRawAddress}});var n=tr;Object.defineProperty(e,"addCoins",{enumerable:!0,get:function(){return n.addCoins}}),Object.defineProperty(e,"coin",{enumerable:!0,get:function(){return n.coin}}),Object.defineProperty(e,"coins",{enumerable:!0,get:function(){return n.coins}}),Object.defineProperty(e,"parseCoins",{enumerable:!0,get:function(){return n.parseCoins}});var r=at;Object.defineProperty(e,"decodeAminoPubkey",{enumerable:!0,get:function(){return r.decodeAminoPubkey}}),Object.defineProperty(e,"decodeBech32Pubkey",{enumerable:!0,get:function(){return r.decodeBech32Pubkey}}),Object.defineProperty(e,"encodeAminoPubkey",{enumerable:!0,get:function(){return r.encodeAminoPubkey}}),Object.defineProperty(e,"encodeBech32Pubkey",{enumerable:!0,get:function(){return r.encodeBech32Pubkey}}),Object.defineProperty(e,"encodeEd25519Pubkey",{enumerable:!0,get:function(){return r.encodeEd25519Pubkey}}),Object.defineProperty(e,"encodeSecp256k1Pubkey",{enumerable:!0,get:function(){return r.encodeSecp256k1Pubkey}});var i=Rn;Object.defineProperty(e,"createMultisigThresholdPubkey",{enumerable:!0,get:function(){return i.createMultisigThresholdPubkey}});var a=Pi;Object.defineProperty(e,"makeCosmoshubPath",{enumerable:!0,get:function(){return a.makeCosmoshubPath}});var s=Ni;Object.defineProperty(e,"isEd25519Pubkey",{enumerable:!0,get:function(){return s.isEd25519Pubkey}}),Object.defineProperty(e,"isMultisigThresholdPubkey",{enumerable:!0,get:function(){return s.isMultisigThresholdPubkey}}),Object.defineProperty(e,"isSecp256k1Pubkey",{enumerable:!0,get:function(){return s.isSecp256k1Pubkey}}),Object.defineProperty(e,"isSinglePubkey",{enumerable:!0,get:function(){return s.isSinglePubkey}}),Object.defineProperty(e,"pubkeyType",{enumerable:!0,get:function(){return s.pubkeyType}});var o=Nn;Object.defineProperty(e,"extractKdfConfiguration",{enumerable:!0,get:function(){return o.extractKdfConfiguration}}),Object.defineProperty(e,"Secp256k1HdWallet",{enumerable:!0,get:function(){return o.Secp256k1HdWallet}});var u=Ja;Object.defineProperty(e,"Secp256k1Wallet",{enumerable:!0,get:function(){return u.Secp256k1Wallet}});var c=Dr;Object.defineProperty(e,"decodeSignature",{enumerable:!0,get:function(){return c.decodeSignature}}),Object.defineProperty(e,"encodeSecp256k1Signature",{enumerable:!0,get:function(){return c.encodeSecp256k1Signature}});var l=Nt;Object.defineProperty(e,"makeSignDoc",{enumerable:!0,get:function(){return l.makeSignDoc}}),Object.defineProperty(e,"serializeSignDoc",{enumerable:!0,get:function(){return l.serializeSignDoc}});var f=Pn;Object.defineProperty(e,"isStdTx",{enumerable:!0,get:function(){return f.isStdTx}}),Object.defineProperty(e,"makeStdTx",{enumerable:!0,get:function(){return f.makeStdTx}});var d=uu;Object.defineProperty(e,"executeKdf",{enumerable:!0,get:function(){return d.executeKdf}})})(Si);var lu=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};class Yf{constructor(t,n="cosmos",r){this.capsule=t,this.prefix=n,this._currentWalletId=r}get publicKey(){const t=this.capsule.getWallets()[this.currentWalletId],n=bi(t.publicKey);return gi.Secp256k1.compressPubkey(n)}set currentWalletId(t){this._currentWalletId=t}get currentWalletId(){var t;return this._currentWalletId||((t=Object.values(this.capsule.getWallets())[0])===null||t===void 0?void 0:t.id)}get address(){return pd.toBech32(this.prefix,Si.rawSecp256k1PubkeyToRawAddress(this.publicKey))}getAccounts(){return lu(this,void 0,void 0,function*(){return[{algo:"secp256k1",address:this.address,pubkey:this.publicKey}]})}}class Xf extends Yf{signDirect(t,n){return lu(this,void 0,void 0,function*(){const r=yd.makeSignBytes(n);if(t!==this.address)throw new Error(`Address ${t} not found in wallet`);const i=gi.sha256(r),a=yield this.capsule.signMessage(this.currentWalletId,R.Buffer.from(i.buffer).toString("base64")),s=bf(`0x${a.signature}`),o=new gi.ExtendedSecp256k1Signature(bi(s.r),bi(s.s),Number(s.v)),u=new Uint8Array([...o.r(32),...o.s(32)]);return{signed:n,signature:Si.encodeSecp256k1Signature(this.publicKey,u)}})}}class Jf extends Yf{signAmino(t,n){return lu(this,void 0,void 0,function*(){if(t!==this.address)throw new Error(`Address ${t} not found in wallet`);const r=new gi.Sha256(Si.serializeSignDoc(n)).digest(),i=yield this.capsule.signMessage(this.currentWalletId,R.Buffer.from(r.buffer).toString("base64")),a=bf(`0x${i.signature}`),s=new gi.ExtendedSecp256k1Signature(bi(a.r),bi(a.s),Number(a.v)),o=new Uint8Array([...s.r(32),...s.s(32)]);return{signed:n,signature:Si.encodeSecp256k1Signature(this.publicKey,o)}})}}var wi=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};const Za={"phoenix-1":"terra","loyal-main-02":"loyal","empowerchain-1":"empower","kichain-2":"ki","neutron-1":"neutron","akashnet-2":"akash","pacific-1":"sei","quicksilver-2":"quick","injective-1":"inj","umee-1":"umee",darchub:"darc","secret-4":"secret","chihuahua-1":"chihuahua","osmosis-1":"osmo","passage-2":"pasg","agoric-3":"agoric","passage-1":"pasg","xstaxy-1":"aura","nois-1":"nois","crescent-1":"cre",nyx:"n","fetchhub-4":"fetch","noble-1":"noble","gravity-bridge-3":"gravity","bitsong-2b":"bitsong","dydx-mainnet-1":"dydx","cronosmainnet_25-1":"crc",celestia:"celestia","jackal-1":"jkl","pirin-1":"nolus","meme-1":"meme","dimension_37-1":"xpla","centauri-1":"centauri","mantle-1":"mantle","quasar-1":"quasar","evmos_9001-2":"evmos","planq_7070-2":"plq","sifchain-1":"sif","bitcanna-1":"bcna","eightball-1":"8ball",gitopia:"gitopia","lum-network-1":"lum","ununifi-beta-v1":"ununifi","canto_7700-1":"canto","archway-1":"archway","mars-1":"mars","teritori-1":"tori","migaloo-1":"migaloo","comdex-1":"comdex","omniflixhub-1":"omniflix","core-1":"persistence","shentu-2.2":"shentu","columbus-5":"terra","axelar-dojo-1":"axelar","stride-1":"stride","kaiyo-1":"kujira","cosmoshub-4":"cosmos","kava_2222-10":"kava","sommelier-3":"somm","crypto-org-chain-mainnet-1":"cro","stargaze-1":"stars","juno-1":"juno","theta-testnet-001":"cosmos","uni-5":"juno","osmo-test-5":"osmo","pulsar-2":"secret","constantine-3":"archway","axelar-testnet-lisbon-3":"axelar","carbon-1":"swth","perun-1":"c4e","babajaga-1":"c4e","cheqd-mainnet-1":"cheqd","coreum-mainnet-1":"core","coreum-testnet-1":"testcore","cudos-1":"cudos","mainnet-3":"decentr","desmos-mainnet":"desmos","dydx-testnet-1":"dydx","emoney-3":"emoney","circulus-1":"empower","injective-888":"inj","irishub-1":"iaa","ixo-5":"ixo","pandora-8":"ixo","kyve-1":"kyve","kaon-1":"kyve","likecoin-mainnet-2":"like","ares-1":"mars","mayachain-mainnet-v1":"maya","pion-1":"neutron","nibiru-itn-1":"nibi","grand-1":"noble","nolus-rila":"nolus","nomic-stakenet-3":"nomic","nomic-testnet-4d":"nomic","onomy-mainnet-1":"onomy","test-core-1":"persistence","planq_7000-4":"plq","qsr-questnet-04":"quasar","atlantic-1":"sei","atlantic-2":"sei","elgafar-1":"stars","iov-mainnet-ibc":"star"},Ti=e=>wi(void 0,void 0,void 0,function*(){return new Promise((t,n)=>{var r,i;const a=(i=(r=Object.values(e.getWallets()))===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.address;e.isSessionActive().then(s=>{if(s&&a)return t(!0);if(window.successFromCapsuleModal=()=>{t(!0)},window.failureFromCapsuleModal=()=>{n()},!window.openCapsuleModal){console.log("Social login UI package missing."),console.log("Consider adding @leapwallet/cosmos-social-login-capsule-provider-ui");return}window.openCapsuleModal(e)})})}),xS=(e,t,n,r)=>wi(void 0,void 0,void 0,function*(){var i,a;if(!(yield e.isSessionActive()))throw yield Ti(e),new Error("Wallet is not connected, please connect again");const o=(a=Object.values((i=e.getWallets())!==null&&i!==void 0?i:{}))===null||a===void 0?void 0:a[0];return yield new Jf(e,Za[t],o==null?void 0:o.id).signAmino(n,r)}),Zf=(e,t,n,r)=>wi(void 0,void 0,void 0,function*(){if(!(yield e.isSessionActive()))throw yield Ti(e),new Error("Wallet is not connected, please connect again");return yield new Promise((s,o)=>{window.successFromTransactionSigningModal=u=>wi(void 0,void 0,void 0,function*(){var c,l;console.log("params passed: ",u);const f=(l=Object.values((c=e.getWallets())!==null&&c!==void 0?c:{}))===null||l===void 0?void 0:l[0],v=yield new Xf(e,Za[t],f==null?void 0:f.id).signDirect(n,r),h={signature:v.signature,signed:v.signed};s(h)}),window.failureFromTransactionSigningModal=u=>{o(u)},window.openTransactionSigningModal?window.openTransactionSigningModal(e,t,n,r):window.successFromTransactionSigningModal({capsule:e,chainId:t,signerAddress:n,signDoc:r})})}),yo=(e,t)=>wi(void 0,void 0,void 0,function*(){var n,r;const i=Object.values((n=e==null?void 0:e.getWallets())!==null&&n!==void 0?n:{});if(i.length<1)throw yield Ti(e),Error("Not possible");const s=(yield new Xf(e,Za[t],(r=i==null?void 0:i[0])===null||r===void 0?void 0:r.id).getAccounts())[0];if(!s)throw new Error("No account data found");return s});var Rc=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};class AS{constructor(t,n){this.chainId=t,this.capsule=n,this.chainId=t,this.capsule=n}getAccounts(){return Rc(this,void 0,void 0,function*(){const t=yield yo(this.capsule,this.chainId);return[{address:t.address,algo:"secp256k1",pubkey:t.pubkey}]})}signDirect(t,n){return Rc(this,void 0,void 0,function*(){if(this.chainId!==n.chainId)throw new Error("Chain ID does not match signer chain ID");const r=yield this.getAccounts();if(console.log("logging accounts",r),r.find(i=>i.address!==t))throw new Error("Signer address does not match wallet address");return Zf(this.capsule,this.chainId,t,n)})}}const BS={name:"leap-capsule-social-login",prettyName:"Sign In with Email",logo:"https://leap-wallet-assets.s3.amazonaws.com/social-login/mail.svg",mode:"extension",mobileDisabled:!1,rejectMessage:{source:"Request rejected"},downloads:[{device:"desktop",browser:"chrome",link:"https://chrome.google.com/webstore/detail/metamask-flask-developmen/ljfoeinjpaedjfecbmggjgodbgkmjkjk"}],connectEventNamesOnWindow:["leap_keystorechange"]};var sr=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(l){try{c(r.next(l))}catch(f){s(f)}}function u(l){try{c(r.throw(l))}catch(f){s(f)}}function c(l){l.done?a(l.value):i(l.value).then(o,u)}c((r=r.apply(e,t||[])).next())})};class _S{constructor(t={}){var n;const r=t.env||$e.BETA,i={emailPrimaryColor:"#29a873",homepageUrl:"https://leapwallet.io",portalTheme:{backgroundColor:"#141414",foregroundColor:"#29a873",borderRadius:"sm"}};window.capsule=new k1(r,t.apiKey,(n=t.opts)!==null&&n!==void 0?n:i)}getClient(){return window.capsule}getKey(t){return sr(this,void 0,void 0,function*(){return yo(window.capsule,t)})}enable(){return sr(this,void 0,void 0,function*(){return this.handleConnect()})}disconnect(){return sr(this,void 0,void 0,function*(){yield window.capsule.logout()})}getSimpleAccount(t){return sr(this,void 0,void 0,function*(){const{address:n,username:r}=yield this.getAccount(t);return{namespace:"cosmos",chainId:t,address:n,username:r}})}handleConnect(){return sr(this,void 0,void 0,function*(){yield Ti(window.capsule)})}connect(){return sr(this,void 0,void 0,function*(){yield Ti(window.capsule)})}getAccount(t){return sr(this,void 0,void 0,function*(){var n;yield this.handleConnect();const r=yield yo(window.capsule,t);return{username:(n=window==null?void 0:window.capsule)===null||n===void 0?void 0:n.getEmail(),address:r.address,algo:r.algo,pubkey:r.pubkey}})}getOfflineSigner(t,n){switch(n){case"amino":return this.getOfflineSignerAmino(t);case"direct":return this.getOfflineSignerDirect(t);default:return this.getOfflineSignerAmino(t)}}getOfflineSignerAmino(t){var n,r;const i=(r=Object.values((n=window.capsule)===null||n===void 0?void 0:n.getWallets()))===null||r===void 0?void 0:r[0];return new Jf(window.capsule,Za[t],i==null?void 0:i.id)}getOfflineSignerDirect(t){return new AS(t,window.capsule)}signAmino(t,n,r,i){return sr(this,void 0,void 0,function*(){return xS(window.capsule,t,n,r)})}signDirect(t,n,r){return sr(this,void 0,void 0,function*(){return Zf(window.capsule,t,n,r)})}}export{_S as CapsuleProvider,BS as LeapCapsuleInfo,fu as OAuthMethod};
