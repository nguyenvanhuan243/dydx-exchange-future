import{k as _,hj as jt,an as Ge,ay as Ye,g as x,c as W,eo as Pt,r as c,a6 as Y,a7 as X,j as o,v as K,q as ee,S as m,B as q,J as ue,b as Xe,br as Rt,bj as Lt,bL as Ce,f as M,a0 as ce,bp as je,I as Se,A as qe,c8 as Nt,bo as Ft,bq as Bt,hk as Ze,hl as Pe,hm as Je,y as R,O as A,p as E,ci as H,bO as Qe,f7 as pe,hn as Mt,ho as Ht,hp as Wt,hq as Ut,hr as Vt,hs as Kt,ht as Gt,hu as Yt,hv as Xt,hw as Ee,hx as Re,bS as te,hy as fe,hz as qt,hA as Zt,hB as Jt,bT as j,hC as Qt,bY as ze,bR as le,bV as zt,ab as Le,ef as eo,aP as G,hD as et,i as ge,db as ve,hE as me,hF as Ne,bH as be,cq as to,o as Fe,m as oo,s as B,eU as tt,hG as ot,eG as no,hH as ro,eV as so,cf as ao,dR as nt,hI as P,fv as Q,M as io,z as co,w as rt,l as Oe,L as st,eA as lo,hJ as at}from"./index-12ab17f1.js";import{t as uo}from"./tradeViewMixins-e79b6162.js";import{T as ie,M as po}from"./FillsTable-6f5a0dea.js";import{A as fo,m as go}from"./ActionsTableCell-517ee0d5.js";const Pn=()=>{const t=_(jt),{complianceState:r}=Ge();return t&&r===Ye.FULL_ACCESS},ho=()=>{const t=W(),r=Pt(),a=c.useCallback(()=>{r(Y(X.CloseAllPositionsConfirmation()))},[r]);return o.jsx(vo,{action:K.Primary,size:ee.XSmall,onClick:a,children:t({key:m.CLOSE_ALL})})},vo=x(q).withConfig({componentId:"sc-yg3jfw-0"})(["--button-textColor:var(--color-red);--button-height:var(--item-height);--button-padding:0 0.25rem;--button-backgroundColor:transparent;--button-border:none;pointer-events:auto;"]),mo=({marketId:t,assetId:r,leverage:a,oraclePrice:s,entryPrice:i,unrealizedPnl:l,side:g,sideLabel:e,stopLossOrders:n,takeProfitOrders:d,isDisabled:u,showClosePositionAction:p,navigateToMarketOrders:$})=>{const b=ue(),f=Xe(),h=_(Rt),w=_(Lt),S=W(),{complianceState:y}=Ge(),O=T=>{f(`${qe.Trade}/${t}`),b(T?Nt(je.ClosePosition()):Ft()),T||Bt.clearClosePositionInputValues({shouldFocusOnTradeInput:!0})},k=()=>{u||b(Y(X.Triggers({marketId:t,assetId:r,stopLossOrders:n,takeProfitOrders:d,navigateToMarketOrders:$})))},I=()=>{b(Y(X.SharePNLAnalytics({marketId:t,assetId:r,leverage:a,oraclePrice:s,entryPrice:i,unrealizedPnl:l,side:g,sideLabel:e})))};return o.jsxs(fo,{children:[!u&&y===Ye.FULL_ACCESS&&o.jsx(Ce,{tooltipString:S({key:m.EDIT_TAKE_PROFIT_STOP_LOSS_TRIGGERS}),children:o.jsx(Be,{onClick:k,iconName:M.Pencil,shape:ce.Square,disabled:u},"edittriggers")}),o.jsx(Be,{onClick:I,iconName:M.Share,shape:ce.Square,disabled:u},"share"),p&&o.jsx(Ce,{tooltipString:S({key:m.CLOSE_POSITION}),children:o.jsx(bo,{isToggle:!0,isPressed:w!=null&&je.is.ClosePosition(w)&&h===t,onPressedChange:O,iconName:M.Close,shape:ce.Square,disabled:u},"closepositions")})]})},Be=x(Se).withConfig({componentId:"sc-17ff0o-0"})(["--button-icon-size:1.5em;--button-textColor:var(--color-text-0);--button-hover-textColor:var(--color-text-1);"]),bo=x(Se).withConfig({componentId:"sc-17ff0o-1"})(["--button-icon-size:1em;--button-hover-textColor:var(--color-red);--button-toggle-on-textColor:var(--color-red);"]),xo=({position:t})=>{const r=W(),a=ue(),{marginMode:s,marginModeLabel:i,margin:l}=c.useMemo(()=>{const{childSubaccountNumber:g}=t,e=Ze(g);return{marginMode:e,marginModeLabel:e===Pe.Cross?r({key:m.CROSS}):r({key:m.ISOLATED}),margin:Je({position:t})}},[t,r]);return o.jsxs(R,{stacked:!0,slotRight:s===Pe.Isolated&&o.jsx(Ce,{tooltipString:r({key:m.ADJUST_ISOLATED_MARGIN}),children:o.jsx($o,{iconName:M.Pencil,shape:ce.Square,onClick:()=>a(Y(X.AdjustIsolatedMargin({positionId:t.id})))},"edit-margin")}),children:[o.jsx(A,{type:E.Fiat,value:l,showSign:H.None}),o.jsx("span",{children:i})]})},$o=x(Se).withConfig({componentId:"sc-txx0kz-0"})(["--button-icon-size:1.5em;--button-padding:0;--button-textColor:var(--color-text-0);--button-hover-textColor:var(--color-text-1);margin-left:0.5rem;"]),it="Popper",[ct,lt]=Qe(it),[Co,dt]=ct(it),wo=t=>{const{__scopePopper:r,children:a}=t,[s,i]=c.useState(null);return c.createElement(Co,{scope:r,anchor:s,onAnchorChange:i},a)},yo="PopperAnchor",So=c.forwardRef((t,r)=>{const{__scopePopper:a,virtualRef:s,...i}=t,l=dt(yo,a),g=c.useRef(null),e=pe(r,g);return c.useEffect(()=>{l.onAnchorChange((s==null?void 0:s.current)||g.current)}),s?null:c.createElement(te.div,fe({},i,{ref:e}))}),ut="PopperContent",[Eo,Rn]=ct(ut),Oo=c.forwardRef((t,r)=>{var a,s,i,l,g,e,n,d;const{__scopePopper:u,side:p="bottom",sideOffset:$=0,align:b="center",alignOffset:f=0,arrowPadding:h=0,avoidCollisions:w=!0,collisionBoundary:S=[],collisionPadding:y=0,sticky:O="partial",hideWhenDetached:k=!1,updatePositionStrategy:I="optimized",onPlaced:T,...v}=t,C=dt(ut,u),[D,N]=c.useState(null),L=pe(r,J=>N(J)),[U,oe]=c.useState(null),F=Mt(U),Z=(a=F==null?void 0:F.width)!==null&&a!==void 0?a:0,Ie=(s=F==null?void 0:F.height)!==null&&s!==void 0?s:0,bt=p+(b!=="center"?"-"+b:""),xt=typeof y=="number"?y:{top:0,right:0,bottom:0,left:0,...y},Te=Array.isArray(S)?S:[S],$t=Te.length>0,ne={padding:xt,boundary:Te.filter(ko),altBoundary:$t},{refs:Ct,floatingStyles:De,placement:wt,isPositioned:re,middlewareData:V}=Ht({strategy:"fixed",placement:bt,whileElementsMounted:(...J)=>Wt(...J,{animationFrame:I==="always"}),elements:{reference:C.anchor},middleware:[Ut({mainAxis:$+Ie,alignmentAxis:f}),w&&Vt({mainAxis:!0,crossAxis:!1,limiter:O==="partial"?qt():void 0,...ne}),w&&Kt({...ne}),Gt({...ne,apply:({elements:J,rects:_e,availableWidth:Tt,availableHeight:Dt})=>{const{width:At,height:_t}=_e.reference,ae=J.floating.style;ae.setProperty("--radix-popper-available-width",`${Tt}px`),ae.setProperty("--radix-popper-available-height",`${Dt}px`),ae.setProperty("--radix-popper-anchor-width",`${At}px`),ae.setProperty("--radix-popper-anchor-height",`${_t}px`)}}),U&&Yt({element:U,padding:h}),Io({arrowWidth:Z,arrowHeight:Ie}),k&&Xt({strategy:"referenceHidden",...ne})]}),[Ae,yt]=pt(wt),se=Ee(T);Re(()=>{re&&(se==null||se())},[re,se]);const St=(i=V.arrow)===null||i===void 0?void 0:i.x,Et=(l=V.arrow)===null||l===void 0?void 0:l.y,Ot=((g=V.arrow)===null||g===void 0?void 0:g.centerOffset)!==0,[kt,It]=c.useState();return Re(()=>{D&&It(window.getComputedStyle(D).zIndex)},[D]),c.createElement("div",{ref:Ct.setFloating,"data-radix-popper-content-wrapper":"",style:{...De,transform:re?De.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:kt,["--radix-popper-transform-origin"]:[(e=V.transformOrigin)===null||e===void 0?void 0:e.x,(n=V.transformOrigin)===null||n===void 0?void 0:n.y].join(" ")},dir:t.dir},c.createElement(Eo,{scope:u,placedSide:Ae,onArrowChange:oe,arrowX:St,arrowY:Et,shouldHideArrow:Ot},c.createElement(te.div,fe({"data-side":Ae,"data-align":yt},v,{ref:L,style:{...v.style,animation:re?void 0:"none",opacity:(d=V.hide)!==null&&d!==void 0&&d.referenceHidden?0:void 0}}))))});function ko(t){return t!==null}const Io=t=>({name:"transformOrigin",options:t,fn(r){var a,s,i,l,g;const{placement:e,rects:n,middlewareData:d}=r,p=((a=d.arrow)===null||a===void 0?void 0:a.centerOffset)!==0,$=p?0:t.arrowWidth,b=p?0:t.arrowHeight,[f,h]=pt(e),w={start:"0%",center:"50%",end:"100%"}[h],S=((s=(i=d.arrow)===null||i===void 0?void 0:i.x)!==null&&s!==void 0?s:0)+$/2,y=((l=(g=d.arrow)===null||g===void 0?void 0:g.y)!==null&&l!==void 0?l:0)+b/2;let O="",k="";return f==="bottom"?(O=p?w:`${S}px`,k=`${-b}px`):f==="top"?(O=p?w:`${S}px`,k=`${n.floating.height+b}px`):f==="right"?(O=`${-b}px`,k=p?w:`${y}px`):f==="left"&&(O=`${n.floating.width+b}px`,k=p?w:`${y}px`),{data:{x:O,y:k}}}});function pt(t){const[r,a="center"]=t.split("-");return[r,a]}const To=wo,Do=So,Ao=Oo,_o=c.forwardRef((t,r)=>{var a;const{container:s=globalThis==null||(a=globalThis.document)===null||a===void 0?void 0:a.body,...i}=t;return s?Zt.createPortal(c.createElement(te.div,fe({},i,{ref:r})),s):null}),we="dismissableLayer.update",jo="dismissableLayer.pointerDownOutside",Po="dismissableLayer.focusOutside";let Me;const Ro=c.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Lo=c.forwardRef((t,r)=>{var a;const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:g,onInteractOutside:e,onDismiss:n,...d}=t,u=c.useContext(Ro),[p,$]=c.useState(null),b=(a=p==null?void 0:p.ownerDocument)!==null&&a!==void 0?a:globalThis==null?void 0:globalThis.document,[,f]=c.useState({}),h=pe(r,C=>$(C)),w=Array.from(u.layers),[S]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=w.indexOf(S),O=p?w.indexOf(p):-1,k=u.layersWithOutsidePointerEventsDisabled.size>0,I=O>=y,T=No(C=>{const D=C.target,N=[...u.branches].some(L=>L.contains(D));!I||N||(l==null||l(C),e==null||e(C),C.defaultPrevented||n==null||n())},b),v=Fo(C=>{const D=C.target;[...u.branches].some(L=>L.contains(D))||(g==null||g(C),e==null||e(C),C.defaultPrevented||n==null||n())},b);return Jt(C=>{O===u.layers.size-1&&(i==null||i(C),!C.defaultPrevented&&n&&(C.preventDefault(),n()))},b),c.useEffect(()=>{if(p)return s&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Me=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(p)),u.layers.add(p),He(),()=>{s&&u.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=Me)}},[p,b,s,u]),c.useEffect(()=>()=>{p&&(u.layers.delete(p),u.layersWithOutsidePointerEventsDisabled.delete(p),He())},[p,u]),c.useEffect(()=>{const C=()=>f({});return document.addEventListener(we,C),()=>document.removeEventListener(we,C)},[]),c.createElement(te.div,fe({},d,{ref:h,style:{pointerEvents:k?I?"auto":"none":void 0,...t.style},onFocusCapture:j(t.onFocusCapture,v.onFocusCapture),onBlurCapture:j(t.onBlurCapture,v.onBlurCapture),onPointerDownCapture:j(t.onPointerDownCapture,T.onPointerDownCapture)}))});function No(t,r=globalThis==null?void 0:globalThis.document){const a=Ee(t),s=c.useRef(!1),i=c.useRef(()=>{});return c.useEffect(()=>{const l=e=>{if(e.target&&!s.current){let d=function(){ft(jo,a,n,{discrete:!0})};const n={originalEvent:e};e.pointerType==="touch"?(r.removeEventListener("click",i.current),i.current=d,r.addEventListener("click",i.current,{once:!0})):d()}else r.removeEventListener("click",i.current);s.current=!1},g=window.setTimeout(()=>{r.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(g),r.removeEventListener("pointerdown",l),r.removeEventListener("click",i.current)}},[r,a]),{onPointerDownCapture:()=>s.current=!0}}function Fo(t,r=globalThis==null?void 0:globalThis.document){const a=Ee(t),s=c.useRef(!1);return c.useEffect(()=>{const i=l=>{l.target&&!s.current&&ft(Po,a,{originalEvent:l},{discrete:!1})};return r.addEventListener("focusin",i),()=>r.removeEventListener("focusin",i)},[r,a]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function He(){const t=new CustomEvent(we);document.dispatchEvent(t)}function ft(t,r,a,{discrete:s}){const i=a.originalEvent.target,l=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:a});r&&i.addEventListener(t,r,{once:!0}),s?Qt(i,l):i.dispatchEvent(l)}let xe;const gt="HoverCard",[ht,Ln]=Qe(gt,[lt]),ke=lt(),[Bo,he]=ht(gt),Mo=t=>{const{__scopeHoverCard:r,children:a,open:s,defaultOpen:i,onOpenChange:l,openDelay:g=700,closeDelay:e=300}=t,n=ke(r),d=c.useRef(0),u=c.useRef(0),p=c.useRef(!1),$=c.useRef(!1),[b=!1,f]=zt({prop:s,defaultProp:i,onChange:l}),h=c.useCallback(()=>{clearTimeout(u.current),d.current=window.setTimeout(()=>f(!0),g)},[g,f]),w=c.useCallback(()=>{clearTimeout(d.current),!p.current&&!$.current&&(u.current=window.setTimeout(()=>f(!1),e))},[e,f]),S=c.useCallback(()=>f(!1),[f]);return c.useEffect(()=>()=>{clearTimeout(d.current),clearTimeout(u.current)},[]),c.createElement(Bo,{scope:r,open:b,onOpenChange:f,onOpen:h,onClose:w,onDismiss:S,hasSelectionRef:p,isPointerDownOnContentRef:$},c.createElement(To,n,a))},Ho="HoverCardTrigger",Wo=c.forwardRef((t,r)=>{const{__scopeHoverCard:a,...s}=t,i=he(Ho,a),l=ke(a);return c.createElement(Do,le({asChild:!0},l),c.createElement(te.a,le({"data-state":i.open?"open":"closed"},s,{ref:r,onPointerEnter:j(t.onPointerEnter,de(i.onOpen)),onPointerLeave:j(t.onPointerLeave,de(i.onClose)),onFocus:j(t.onFocus,i.onOpen),onBlur:j(t.onBlur,i.onClose),onTouchStart:j(t.onTouchStart,g=>g.preventDefault())})))}),vt="HoverCardPortal",[Uo,Vo]=ht(vt,{forceMount:void 0}),Ko=t=>{const{__scopeHoverCard:r,forceMount:a,children:s,container:i}=t,l=he(vt,r);return c.createElement(Uo,{scope:r,forceMount:a},c.createElement(ze,{present:a||l.open},c.createElement(_o,{asChild:!0,container:i},s)))},ye="HoverCardContent",Go=c.forwardRef((t,r)=>{const a=Vo(ye,t.__scopeHoverCard),{forceMount:s=a.forceMount,...i}=t,l=he(ye,t.__scopeHoverCard);return c.createElement(ze,{present:s||l.open},c.createElement(Yo,le({"data-state":l.open?"open":"closed"},i,{onPointerEnter:j(t.onPointerEnter,de(l.onOpen)),onPointerLeave:j(t.onPointerLeave,de(l.onClose)),ref:r})))}),Yo=c.forwardRef((t,r)=>{const{__scopeHoverCard:a,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:l,onInteractOutside:g,...e}=t,n=he(ye,a),d=ke(a),u=c.useRef(null),p=pe(r,u),[$,b]=c.useState(!1);return c.useEffect(()=>{if($){const f=document.body;return xe=f.style.userSelect||f.style.webkitUserSelect,f.style.userSelect="none",f.style.webkitUserSelect="none",()=>{f.style.userSelect=xe,f.style.webkitUserSelect=xe}}},[$]),c.useEffect(()=>{if(u.current){const f=()=>{b(!1),n.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var h;((h=document.getSelection())===null||h===void 0?void 0:h.toString())!==""&&(n.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",f),()=>{document.removeEventListener("pointerup",f),n.hasSelectionRef.current=!1,n.isPointerDownOnContentRef.current=!1}}},[n.isPointerDownOnContentRef,n.hasSelectionRef]),c.useEffect(()=>{u.current&&Xo(u.current).forEach(h=>h.setAttribute("tabindex","-1"))}),c.createElement(Lo,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:g,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:j(l,f=>{f.preventDefault()}),onDismiss:n.onDismiss},c.createElement(Ao,le({},d,e,{onPointerDown:j(e.onPointerDown,f=>{f.currentTarget.contains(f.target)&&b(!0),n.hasSelectionRef.current=!1,n.isPointerDownOnContentRef.current=!0}),ref:p,style:{...e.style,userSelect:$?"text":void 0,WebkitUserSelect:$?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})))});function de(t){return r=>r.pointerType==="touch"?void 0:t()}function Xo(t){const r=[],a=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;a.nextNode();)r.push(a.currentNode);return r}const qo=Mo,Zo=Wo,Jo=Ko,Qo=Go,We=({hovercard:t,stringParams:r,slotTrigger:a,slotButton:s,className:i,align:l,side:g})=>{const e=W(),n=t&&eo[t];let d,u;if(n){const{title:p,body:$}=n({stringGetter:e,stringParams:r});d=p,u=$}return o.jsxs(qo,{openDelay:300,children:[a&&o.jsx(Zo,{asChild:!0,children:a}),o.jsx(Jo,{children:o.jsxs(zo,{className:i,align:l,alignOffset:-16,side:g,sideOffset:8,children:[d&&o.jsx(en,{children:d}),u&&o.jsx("p",{children:u}),s]})})]})},zo=x(Qo).withConfig({componentId:"sc-8m41nf-0"})([""," --popover-backgroundColor:var(--color-layer-6);"," --popover-closed-height:auto;display:grid;max-width:30ch;gap:0.5rem;padding:0.75em;font-size:0.8125em;border-radius:0.33rem;"],Le.popover,Le.popoverAnimation);var en=x("h3").withConfig({componentId:"sc-8m41nf-1"})({color:"var(--color-text-2)",font:"var(--font-small-bold)"});const tn=({marketId:t,assetId:r,tickSizeDecimals:a,liquidationPrice:s,stopLossOrders:i,takeProfitOrders:l,onViewOrdersClick:g,positionSide:e,positionSize:n,isDisabled:d})=>{const u=W(),p=ue(),{isSlTpLimitOrdersEnabled:$}=et(),b=()=>g(t),f=y=>!ve(y,$)||!s?!1:e===me.SHORT&&(y.triggerPrice??y.price)>s||e===me.LONG&&(y.triggerPrice??y.price)<s,h=()=>{d||p(Y(X.Triggers({marketId:t,assetId:r,stopLossOrders:i,takeProfitOrders:l,navigateToMarketOrders:b})))},w=o.jsxs(Ke,{action:K.Navigation,size:ee.XSmall,onClick:b??void 0,disabled:d,children:[u({key:m.VIEW_ORDERS}),o.jsx(sn,{iconName:M.Arrow})]}),S=({label:y,orders:O})=>{const k=({liquidationWarningSide:I}={})=>{let T="Default";I!=null?T="Warning":O.length>0&&(T="HasOrders");const v=o.jsx(nn,{action:K.Primary,onClick:h,triggerButtonState:T,disabled:d,children:y});return I?o.jsx(We,{align:"start",side:"left",hovercard:I===me.LONG?"liquidation-warning-long":"liquidation-warning-short",slotButton:o.jsx(q,{action:K.Primary,size:ee.Small,disabled:d,onClick:h,children:u({key:m.EDIT_STOP_LOSS})}),slotTrigger:v}):v};if(O.length===0)return o.jsxs(o.Fragment,{children:[k(),d?o.jsx(Ve,{type:E.Fiat,value:null}):o.jsx(Ke,{action:K.Primary,size:ee.XSmall,onClick:h,children:u({key:m.ADD})})]});if(O.length===1){const I=O[0],{size:T,triggerPrice:v}=I,C=!!(n&&Math.abs(T)<Math.abs(n)),D=f(I)?e:void 0;return o.jsxs(o.Fragment,{children:[k({liquidationWarningSide:D}),o.jsx(Ve,{type:E.Fiat,value:v??null,fractionDigits:a}),C&&o.jsx(We,{align:"end",side:"top",hovercard:ve(I,$)?"partial-close-stop-loss":"partial-close-take-profit",slotButton:o.jsx(q,{action:K.Primary,size:ee.Small,onClick:h,disabled:d,children:u({key:ve(I,$)?m.EDIT_STOP_LOSS:m.EDIT_TAKE_PROFIT})}),slotTrigger:o.jsx(rn,{children:o.jsx(ge,{iconName:M.PositionPartial,size:"0.875em"})})})]})}return o.jsxs(o.Fragment,{children:[k(),w]})};return o.jsxs(R,{stacked:!0,stackedWithSecondaryStyling:!1,children:[o.jsx(Ue,{children:S({label:"TP",orders:l})}),o.jsx(Ue,{children:S({label:"SL",orders:i})})]})},Ue=x.span.withConfig({componentId:"sc-1sg5kda-0"})({display:"inline-flex",alignItems:"center",gap:"0.5ch",minWidth:"max-content","--item-height":"1.25rem"}),on=t=>{switch(t){case"HasOrders":return G(["--button-textColor:var(--color-text-1);--button-backgroundColor:var(--color-layer-4);"]);case"Warning":return G(["--button-textColor:var(--color-black);--button-backgroundColor:var(--color-warning);"]);case"Default":default:return G(["--button-hover-textColor:var(--color-text-1);"])}},nn=x(q).withConfig({componentId:"sc-1sg5kda-1"})(["--button-backgroundColor:transparent;--button-border:solid var(--border-width) var(--color-border);--button-font:var(--font-tiny-book);--button-height:var(--item-height);--button-padding:0 0.25rem;--button-textColor:var(--color-text-0);",""],({triggerButtonState:t})=>on(t)),Ve=x(A).withConfig({componentId:"sc-1sg5kda-2"})(["font:var(--font-mini-medium);",""],({value:t})=>t?G(["color:var(--color-text-1);"]):G(["color:var(--color-text-0);"])),Ke=x(q).withConfig({componentId:"sc-1sg5kda-3"})(["--button-height:var(--item-height);--button-padding:0;--button-textColor:var(--color-accent);--button-backgroundColor:transparent;--button-border:none;"]),rn=x.span.withConfig({componentId:"sc-1sg5kda-4"})(["svg{display:block;}"]);var sn=x(ge).withConfig({componentId:"sc-1sg5kda-5"})({strokeWidth:"2"}),an=(t=>(t.Details="Details",t.IndexEntry="IndexEntry",t.PnL="PnL",t.Market="Market",t.Size="Size",t.LiquidationAndOraclePrice="LiquidationAndOraclePrice",t.Margin="Margin",t.UnrealizedPnl="UnrealizedPnl",t.RealizedPnl="RealizedPnl",t.AverageOpenAndClose="AverageOpenAndClose",t.NetFunding="NetFunding",t.Triggers="Triggers",t.Actions="Actions",t))(an||{});const cn=({key:t,stringGetter:r,width:a,isAccountViewOnly:s,showClosePositionAction:i,navigateToOrders:l,isSinglePosition:g})=>({width:a,...{Details:{columnKey:"details",getCellValue:e=>e.id,label:r({key:m.DETAILS}),renderCell:({asset:e,leverage:n,resources:d,size:u})=>{var p,$;return o.jsxs(R,{stacked:!0,slotLeft:o.jsx(un,{symbol:e==null?void 0:e.id}),children:[o.jsx($e,{type:E.Asset,value:u==null?void 0:u.current,fractionDigits:nt,showSign:H.None,tag:e==null?void 0:e.id}),o.jsxs(pn,{children:[o.jsx(dn,{children:((p=d.sideStringKey)==null?void 0:p.current)&&r({key:($=d.sideStringKey)==null?void 0:$.current})}),o.jsx(fn,{children:"@"}),o.jsx($e,{type:E.Multiple,value:n==null?void 0:n.current,showSign:H.None})]})]})}},IndexEntry:{columnKey:"oracleEntry",getCellValue:e=>{var n;return(n=e.entryPrice)==null?void 0:n.current},label:o.jsxs(ie,{children:[o.jsx("span",{children:r({key:m.ORACLE_PRICE_ABBREVIATED})}),o.jsx("span",{children:r({key:m.ENTRY_PRICE_SHORT})})]}),hideOnBreakpoint:P.isNotTablet,renderCell:({entryPrice:e,oraclePrice:n,tickSizeDecimals:d})=>o.jsxs(R,{stacked:!0,children:[o.jsx(A,{type:E.Fiat,value:n,fractionDigits:d}),o.jsx(A,{type:E.Fiat,value:e==null?void 0:e.current,fractionDigits:d})]})},PnL:{columnKey:"combinedPnl",getCellValue:e=>{var n;return(n=e.unrealizedPnl)==null?void 0:n.current},label:r({key:m.PNL}),hideOnBreakpoint:P.isNotTablet,renderCell:({unrealizedPnl:e,unrealizedPnlPercent:n})=>o.jsxs(R,{stacked:!0,children:[o.jsx(z,{sign:Q(n==null?void 0:n.current),type:E.Percent,value:n==null?void 0:n.current,showSign:H.None}),o.jsx($e,{isNegative:io(e==null?void 0:e.current).isNegative(),type:E.Fiat,value:e==null?void 0:e.current,showSign:H.Both})]})},Market:{columnKey:"market",getCellValue:e=>e.displayId,label:r({key:m.MARKET}),hideOnBreakpoint:P.isMobile,renderCell:({displayId:e,asset:n,leverage:d})=>o.jsx(po,{asset:n,marketId:e,leverage:(d==null?void 0:d.current)??void 0,isHighlighted:!0})},Size:{columnKey:"size",getCellValue:e=>{var n;return(n=e.notionalTotal)==null?void 0:n.current},label:r({key:m.SIZE}),hideOnBreakpoint:P.isMobile,renderCell:({assetId:e,size:n,notionalTotal:d,stepSizeDecimals:u})=>o.jsxs(R,{stacked:!0,children:[o.jsx(z,{type:E.Asset,value:n==null?void 0:n.current,tag:e,showSign:H.Negative,sign:Q(n==null?void 0:n.current),fractionDigits:u}),o.jsx(A,{type:E.Fiat,value:d==null?void 0:d.current})]})},Margin:{columnKey:"margin",getCellValue:e=>Je({position:e}),label:r({key:m.MARGIN}),hideOnBreakpoint:P.isMobile,isActionable:!0,renderCell:e=>o.jsx(xo,{position:e})},NetFunding:{columnKey:"netFunding",getCellValue:e=>e.netFunding,label:o.jsxs(ie,{children:[o.jsx("span",{children:r({key:m.FUNDING_PAYMENTS_SHORT})}),o.jsx("span",{children:r({key:m.RATE})})]}),hideOnBreakpoint:P.isTablet,renderCell:({netFunding:e,fundingRate:n})=>o.jsxs(R,{stacked:!0,children:[o.jsx(z,{sign:Q(e),type:E.Fiat,value:e}),o.jsx(A,{showSign:H.Negative,type:E.Percent,value:n})]})},LiquidationAndOraclePrice:{columnKey:"price",getCellValue:e=>{var n;return(n=e.liquidationPrice)==null?void 0:n.current},label:o.jsxs(ie,{children:[o.jsx("span",{children:r({key:m.LIQUIDATION_PRICE_SHORT})}),o.jsx("span",{children:r({key:m.ORACLE_PRICE_ABBREVIATED})})]}),renderCell:({liquidationPrice:e,oraclePrice:n,tickSizeDecimals:d})=>o.jsxs(R,{stacked:!0,children:[o.jsx(A,{type:E.Fiat,value:e==null?void 0:e.current,fractionDigits:d}),o.jsx(A,{type:E.Fiat,value:n,fractionDigits:d})]})},UnrealizedPnl:{columnKey:"unrealizedPnl",getCellValue:e=>{var n;return(n=e.unrealizedPnl)==null?void 0:n.current},label:r({key:m.UNREALIZED_PNL}),hideOnBreakpoint:P.isTablet,renderCell:({unrealizedPnl:e,unrealizedPnlPercent:n})=>o.jsxs(R,{stacked:!0,children:[o.jsx(z,{sign:Q(e==null?void 0:e.current),type:E.Fiat,value:e==null?void 0:e.current}),o.jsx(A,{type:E.Percent,value:n==null?void 0:n.current})]})},RealizedPnl:{columnKey:"realizedPnl",getCellValue:e=>{var n;return(n=e.realizedPnl)==null?void 0:n.current},label:r({key:m.REALIZED_PNL}),hideOnBreakpoint:P.isTablet,renderCell:({realizedPnl:e,realizedPnlPercent:n})=>o.jsxs(R,{stacked:!0,children:[o.jsx(z,{sign:Q(e==null?void 0:e.current),type:E.Fiat,value:e==null?void 0:e.current,showSign:H.Negative}),o.jsx(A,{type:E.Percent,value:n==null?void 0:n.current})]})},AverageOpenAndClose:{columnKey:"entryExitPrice",getCellValue:e=>{var n;return(n=e.entryPrice)==null?void 0:n.current},label:o.jsxs(ie,{children:[o.jsx("span",{children:r({key:m.AVERAGE_OPEN_SHORT})}),o.jsx("span",{children:r({key:m.AVERAGE_CLOSE_SHORT})})]}),hideOnBreakpoint:P.isTablet,renderCell:({entryPrice:e,exitPrice:n,tickSizeDecimals:d})=>o.jsxs(R,{stacked:!0,children:[o.jsx(A,{type:E.Fiat,value:e==null?void 0:e.current,fractionDigits:d}),o.jsx(A,{type:E.Fiat,value:n,fractionDigits:d})]})},Triggers:{columnKey:"triggers",label:r({key:m.TRIGGERS}),isActionable:!0,allowsSorting:!1,hideOnBreakpoint:P.isTablet,renderCell:({id:e,assetId:n,tickSizeDecimals:d,liquidationPrice:u,side:p,size:$,stopLossOrders:b,takeProfitOrders:f})=>o.jsx(tn,{marketId:e,assetId:n,tickSizeDecimals:d,liquidationPrice:u==null?void 0:u.current,stopLossOrders:b,takeProfitOrders:f,positionSide:p.current,positionSize:$==null?void 0:$.current,isDisabled:s,onViewOrdersClick:l})},Actions:{columnKey:"actions",label:i&&!g?o.jsx(ho,{}):"",isActionable:!0,allowsSorting:!1,hideOnBreakpoint:P.isTablet,renderCell:({id:e,assetId:n,stopLossOrders:d,leverage:u,side:p,oraclePrice:$,entryPrice:b,takeProfitOrders:f,unrealizedPnl:h,resources:w})=>{var S,y;return o.jsx(mo,{marketId:e,assetId:n,side:p.current,leverage:u.current,oraclePrice:$,entryPrice:b.current,unrealizedPnl:h==null?void 0:h.current,sideLabel:((S=w.sideStringKey)==null?void 0:S.current)&&r({key:(y=w.sideStringKey)==null?void 0:y.current}),isDisabled:s,showClosePositionAction:i,stopLossOrders:d,takeProfitOrders:f,navigateToMarketOrders:l})}}}[t]}),Nn=({columnKeys:t,columnWidths:r,currentRoute:a,currentMarket:s,marketTypeFilter:i,showClosePositionAction:l,initialPageSize:g,onNavigate:e,navigateToOrders:n,withGradientCardRows:d,withOuterBorder:u})=>{const p=W(),$=Xe(),{isSlTpLimitOrdersEnabled:b}=et(),f=_(to),h=Fe(_(oo,B)),w=Fe(_(tt,B)),S=_(ot,B)??no,y=c.useMemo(()=>S.filter(v=>{const C=s==null||v.id===s,D=v.childSubaccountNumber,N=Ze(D).name,L=go(N,i);return C&&L}),[s,i,S]),O=c.useMemo(ro,[]),{stopLossOrders:k,takeProfitOrders:I}=_(v=>O(v,b),{equalityFn:(v,C)=>B(v.stopLossOrders,C.stopLossOrders)&&B(v.takeProfitOrders,C.takeProfitOrders)}),T=c.useMemo(()=>y.map(v=>{var C,D,N,L,U,oe,F;return so({},{tickSizeDecimals:((D=(C=h==null?void 0:h[v.id])==null?void 0:C.configs)==null?void 0:D.tickSizeDecimals)??ao,asset:w==null?void 0:w[v.assetId],oraclePrice:(N=h==null?void 0:h[v.id])==null?void 0:N.oraclePrice,fundingRate:(U=(L=h==null?void 0:h[v.id])==null?void 0:L.perpetual)==null?void 0:U.nextFundingRate,stopLossOrders:k.filter(Z=>Z.marketId===v.id),takeProfitOrders:I.filter(Z=>Z.marketId===v.id),stepSizeDecimals:((F=(oe=h==null?void 0:h[v.id])==null?void 0:oe.configs)==null?void 0:F.stepSizeDecimals)??nt},v)}),[y,h,w,k,I]);return o.jsx(ln,{label:p({key:m.POSITIONS}),data:T,columns:t.map(v=>cn({key:v,stringGetter:p,width:r==null?void 0:r[v],isAccountViewOnly:f,showClosePositionAction:l,navigateToOrders:n,isSinglePosition:T.length===1})),getRowKey:v=>v.id,onRowAction:s?void 0:v=>{$(`${qe.Trade}/${v}`,{state:{from:a}}),e==null||e()},getRowAttributes:v=>({"data-side":v.side.current}),slotEmpty:o.jsxs(o.Fragment,{children:[o.jsx(gn,{iconName:M.Positions}),o.jsx("h4",{children:p({key:m.POSITIONS_EMPTY_STATE})})]}),initialPageSize:g,withGradientCardRows:d,withOuterBorder:u,withInnerBorders:!0,withScrollSnapColumns:!0,withScrollSnapRows:!0,withFocusStickyRows:!0},s??"positions")},ln=x(co).withConfig({componentId:"sc-koplg6-0"})([""," tr{&:after{content:'';}}tbody tr{overflow:hidden;position:relative;&[data-side='","']{--side-color:var(--color-positive);--table-row-gradient-to-color:var(--color-gradient-positive);}&[data-side='","']{--side-color:var(--color-negative);--table-row-gradient-to-color:var(--color-gradient-negative);}}"],uo.horizontalTable,Ne.Long,Ne.Short),z=x(A).withConfig({componentId:"sc-koplg6-1"})(["color:",";"],({sign:t})=>({[be.Positive]:"var(--color-positive)",[be.Negative]:"var(--color-negative)",[be.Neutral]:"var(--color-text-2)"})[t]),$e=x(A).withConfig({componentId:"sc-koplg6-2"})(["color:var(--color-text-1);--secondary-item-color:currentColor;--output-sign-color:",";"],({isNegative:t})=>t!==void 0?t?"var(--color-negative)":"var(--color-positive)":"currentColor"),dn=x.span.withConfig({componentId:"sc-koplg6-3"})(["&&{color:var(--side-color);}"]);var un=x(rt).withConfig({componentId:"sc-koplg6-4"})({display:"inline-flex",alignItems:"center",gap:"0.5ch",minWidth:"unset",fontSize:"2.25rem"}),pn=x("div").withConfig({componentId:"sc-koplg6-5"})({display:"inline-flex",alignItems:"center",gap:"0.5ch",minWidth:"max-content"}),fn=x("span").withConfig({componentId:"sc-koplg6-6"})({color:"var(--color-text-0)"}),gn=x(ge).withConfig({componentId:"sc-koplg6-7"})({fontSize:"3em"});const hn=({assetId:t,assetIcon:r,assetName:a,actionSlot:s,detailLabel:i,detailValue:l})=>o.jsxs(vn,{children:[o.jsxs(mn,{children:[r??o.jsx(rt,{symbol:t}),a]}),o.jsxs(bn,{children:[o.jsx(xn,{children:i}),o.jsx($n,{children:l})]}),o.jsx(Cn,{children:s})]}),vn=x.div.withConfig({componentId:"sc-gh7gpi-0"})([""," width:14rem;min-width:14rem;background-color:var(--color-layer-3);overflow:hidden;padding:0.625rem 0;padding-bottom:0.5rem;border-radius:0.625rem;"],Oe.flexColumn),mn=x.div.withConfig({componentId:"sc-gh7gpi-1"})([""," gap:0.5rem;padding:0 0.625rem;font:var(--font-small-book);img{font-size:1.25rem;}"],Oe.row);var bn=x("div").withConfig({componentId:"sc-gh7gpi-2"})({display:"grid",gridAutoFlow:"column",alignItems:"center",justifyContent:"space-between",marginTop:"0.5rem",paddingLeft:"0.625rem",paddingRight:"0.625rem",paddingTop:"0px",paddingBottom:"0px"}),xn=x("span").withConfig({componentId:"sc-gh7gpi-3"})({color:"var(--color-text-0)",font:"var(--font-mini-book)"}),$n=x("span").withConfig({componentId:"sc-gh7gpi-4"})({font:"var(--font-small-book)"}),Cn=x("div").withConfig({componentId:"sc-gh7gpi-5"})({display:"grid",gridAutoFlow:"column",alignItems:"center",justifyContent:"space-between",marginTop:"0.5rem",paddingLeft:"0.625rem",paddingRight:"0.625rem",paddingTop:"0.5rem",paddingBottom:"0px",borderTop:"var(--border)"});const wn=({marketName:t,onViewOrders:r,pendingPosition:a})=>{const s=ue(),i=c.useCallback(u=>{s(Y(X.CancelPendingOrders({marketId:u})))},[s]),l=W(),{assetId:g,freeCollateral:e,marketId:n,orderCount:d}=a;return o.jsx(hn,{assetName:t,assetId:g,detailLabel:l({key:m.MARGIN}),detailValue:o.jsx(A,{type:E.Fiat,value:e==null?void 0:e.current}),actionSlot:o.jsxs(o.Fragment,{children:[o.jsxs(yn,{onClick:()=>r(n),isAccent:!0,children:[l({key:d>1?m.VIEW_ORDERS:m.VIEW})," ",o.jsx(ge,{iconName:M.Arrow})]}),o.jsxs(Sn,{onClick:()=>i(n),children:[l({key:d>1?m.CANCEL_ORDERS:m.CANCEL})," "]})]})})};var yn=x(st).withConfig({componentId:"sc-a201a4-0"})({font:"var(--font-small-book)"}),Sn=x(st).withConfig({componentId:"sc-a201a4-1"})({font:"var(--font-small-book)","--link-color":"var(--color-risk-high)"});const Fn=({className:t,onViewOrders:r})=>{var e;const a=(e=_(ot,B))==null?void 0:e.length,[s,i]=c.useState(a===0);c.useEffect(()=>{a===0&&i(!0)},[a]);const l=_(at,B),g=W();return l!=null&&l.length?o.jsxs(En,{className:t,isOpen:s,children:[o.jsxs(On,{onClick:()=>i(!s),children:[g({key:m.UNOPENED_ISOLATED_POSITIONS}),o.jsx(In,{iconName:M.Caret,isOpen:s})]}),s&&o.jsx(Tn,{children:o.jsx(mt,{onViewOrders:r,pendingPositions:l})})]}):null},Bn=({onViewOrders:t,header:r,className:a})=>{const s=_(at,B);return s!=null&&s.length?o.jsxs("div",{className:a,children:[r,o.jsx(mt,{onViewOrders:t,pendingPositions:s})]}):null},mt=({onViewOrders:t,pendingPositions:r})=>{const a=_(tt,B);return o.jsx(kn,{children:r.map(s=>{var i;return o.jsx(wn,{marketName:((i=a==null?void 0:a[s.assetId])==null?void 0:i.name)??s.assetId??"",pendingPosition:s,onViewOrders:t},s.assetId)})})},En=x.div.withConfig({componentId:"sc-1orkec7-0"})(["overflow:auto;border-top:var(--border);",""],({isOpen:t})=>t&&G(["min-height:10rem;height:100%;"])),On=x(q).withConfig({componentId:"sc-1orkec7-1"})(["--backdrop-filter:blur(4px) contrast(1.01);position:sticky;top:0;gap:0.75rem;-webkit-backdrop-filter:var(--backdrop-filter);backdrop-filter:var(--backdrop-filter);background-color:transparent;border:none;margin:0 1rem;"]),kn=x.div.withConfig({componentId:"sc-1orkec7-2"})([""," gap:1rem;scroll-snap-align:none;"],Oe.flexWrap);var In=x(lo).withConfig({componentId:"sc-1orkec7-3"})({fontSize:"0.5em"}),Tn=x("div").withConfig({componentId:"sc-1orkec7-4"})({paddingLeft:"1rem",paddingRight:"1rem",paddingBottom:"1rem",paddingTop:"0px"});export{Fn as M,Nn as P,an as a,Bn as b,hn as c,Pn as u};
